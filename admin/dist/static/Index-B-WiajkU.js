import{d as ve,u as me,a as Je,r as w,o as fe,b as i,c as A,e as u,f as e,w as a,t as o,g as t,F as te,E as We,h as be,i as Ie,j as Ke,k as el,l as ll,m as Ce,n,p as C,q as ce,s as ge,v as N,x as ye,y as we,z as ze,A as je,B as Se,C as Ue,D as Be,G as qe,H as Ee,I as Ae,J as De,K as Le,_ as Ve,L as al,M as de,N as $e,O as tl,P as ol,Q as Ge,R as Pe,S as Te,T as Fe,U as Re,V as ul,W as nl,X as sl,Y as il,Z as dl,$ as He,a0 as pl,a1 as rl,a2 as cl,a3 as vl,a4 as ml,a5 as fl,a6 as bl,a7 as _l,a8 as yl,a9 as wl,aa as hl}from"./index-DHiZGyrJ.js";import{a as Y}from"./el-message-ZkJEpQUo.js";const gl="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='37.07'%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20198'%3e%3cpath%20fill='%2341B883'%20d='M204.8%200H256L128%20220.8L0%200h97.92L128%2051.2L157.44%200h47.36Z'%3e%3c/path%3e%3cpath%20fill='%2341B883'%20d='m0%200l128%20220.8L256%200h-51.2L128%20132.48L50.56%200H0Z'%3e%3c/path%3e%3cpath%20fill='%2335495E'%20d='M50.56%200L128%20133.12L204.8%200h-47.36L128%2051.2L97.92%200H50.56Z'%3e%3c/path%3e%3c/svg%3e",Vl={style:{display:"flex","justify-content":"center"}},xl={style:{display:"flex","justify-content":"center"}},kl={style:{display:"flex","justify-content":"center"}},$l={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Cl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},zl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Sl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Ul=ve({__name:"Dashboard",setup(ie){const{t:l}=me(),P=Je(),I=w({}),m=w({}),g=[{color:"#20a53a",percentage:30},{color:"orange",percentage:60},{color:"red",percentage:100}],h=[k,v];let c=setInterval(v,3e3);fe(()=>{h.forEach(U=>{U()})});async function v(){const U=sessionStorage.getItem("token");try{const x={headers:{Authorization:`Bearer ${U}`}},M=await Y.get("/api/v1/getsystemstatus",x);M.data.code!=1&&(clearInterval(c),sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),P.push("/login")),I.value=M.data.data}catch{}}async function k(){try{const U=await Y.get("/api/v1/getvulnabs");m.value=U.data}catch{}}return(U,x)=>{const M=We,Z=be,F=Ie,D=Ke,G=el,p=ll;return i(),A(te,null,[u("div",null,[e(Z,{style:{"margin-top":"1%"},header:t(l)("app.webui.systemstatus"),"body-style":"display: flex; justify-content: space-around;"},{default:a(()=>[u("div",null,[u("span",Vl,o(t(l)("app.webui.cpuuse")),1),e(M,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:I.value.cpu,color:g},null,8,["percentage"])]),u("div",null,[u("span",xl,o(t(l)("app.webui.ramuse")),1),e(M,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:I.value.mem,color:g},null,8,["percentage"])]),u("div",null,[u("span",kl,o(t(l)("app.webui.diskuse")),1),e(M,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:I.value.disk,color:g},null,8,["percentage"])])]),_:1},8,["header"]),e(Z,{header:t(l)("app.webui.vulnstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(D,{justify:"start"},{default:a(()=>[e(Z,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalvuln")),1),e(F,{size:"25"},{default:a(()=>x[0]||(x[0]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:m.value.total},null,8,["value"]),u("div",$l,[u("span",null,o(t(l)("app.webui.weeklyadditions")),1),u("span",null,o(m.value.weeklyAdditionsVuln),1)])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalpoc")),1),e(F,{size:"25"},{default:a(()=>x[1]||(x[1]=[u("svg",{t:"1727429978264",class:"icon",viewBox:"0 0 1161 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"20805",width:"200",height:"200"},[u("path",{d:"M258.205538 354.461538c10.436923 0 18.924308 8.467692 18.924308 18.944v624.836924c0 10.456615-8.467692 18.944-18.924308 18.944H177.289846a18.944 18.944 0 0 1-18.924308-18.944v-624.836924c0-10.476308 8.467692-18.944 18.924308-18.944h80.915692z m158.365539 120.497231c10.436923 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944h-80.915692a18.944 18.944 0 0 1-18.924308-18.944V493.883077c0-10.436923 8.467692-18.924308 18.924308-18.924308h80.915692z m-316.731077 0c10.456615 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944H18.944A18.944 18.944 0 0 1 0 998.242462V493.883077c0-10.436923 8.467692-18.924308 18.944-18.924308H99.84z m139.421538-82.628923H196.214154v586.988308h43.047384V392.329846z m158.365539 120.477539h-43.027692V979.298462h43.027692V512.787692z m-316.731077 0H37.868308V979.298462h43.027692V512.787692zM1063.384615 0a98.461538 98.461538 0 0 1 98.461539 98.461538v748.307693a98.461538 98.461538 0 0 1-98.461539 98.461538H492.307692V433.230769a39.384615 39.384615 0 0 0-36.430769-39.286154L452.923077 393.846154h-98.461539v-59.076923a39.384615 39.384615 0 0 0-36.430769-39.286154L315.076923 295.384615h-98.461538V98.461538a98.461538 98.461538 0 0 1 98.461538-98.461538h748.307692z m-142.867692 520.664615c-44.898462 0-78.769231 14.572308-102.4 44.504616-21.267692 26.387692-31.507692 60.258462-31.507692 102.006154 0 42.535385 9.846154 76.406154 30.326154 101.612307 23.236923 29.144615 57.895385 44.110769 103.975384 44.11077 30.326154 0 56.32-8.664615 77.981539-25.993847 23.236923-18.510769 37.809231-44.110769 44.110769-76.8h-41.747692l-1.476923 5.395693c-5.710769 19.377231-15.064615 34.126769-28.061539 44.228923-13.390769 10.24-30.72 15.36-51.2 15.36-31.507692 0-54.744615-9.846154-69.710769-29.538462-14.178462-18.510769-21.267692-44.504615-21.267692-78.375384 0-32.689231 7.089231-58.683077 21.661538-77.587693 15.36-20.873846 38.203077-31.113846 68.529231-31.113846 20.48 0 37.021538 4.332308 50.412307 13.390769 13.390769 9.058462 22.449231 23.236923 27.175385 42.141539h41.747692l-0.984615-5.592616c-5.060923-25.796923-17.329231-46.710154-36.430769-62.148923-21.267692-17.329231-48.443077-25.6-81.132308-25.6z m-30.956308-413.538461c-42.929231 0-76.8 13.784615-101.218461 42.141538-23.630769 26.781538-35.052308 61.44-35.052308 104.369231 0 42.535385 11.421538 77.193846 35.052308 103.975385 24.418462 27.569231 58.289231 41.747692 101.218461 41.747692 42.535385 0 76.406154-13.784615 101.218462-41.353846 23.630769-26.781538 35.446154-61.44 35.446154-104.369231 0-43.323077-11.815385-78.375385-35.446154-104.763077-24.812308-27.963077-58.683077-41.747692-101.218462-41.747692z m-292.489846 5.513846H480.492308V393.846154h42.92923v-109.489231h72.861539l5.395692-0.059077c63.763692-1.516308 95.822769-30.247385 95.822769-86.193231 0-57.107692-33.476923-85.464615-100.430769-85.464615z m292.470154 32.295385c29.932308 0 53.169231 9.452308 69.316923 29.144615 15.753846 19.298462 24.024615 45.686154 24.024616 79.556923 0 33.476923-8.270769 59.864615-24.024616 78.769231-16.147692 19.298462-39.384615 29.144615-69.316923 29.144615s-53.169231-10.24-69.710769-29.932307c-15.753846-19.298462-23.630769-45.292308-23.630769-77.981539 0-33.083077 7.876923-59.076923 23.630769-78.375385 16.541538-20.48 39.778462-30.326154 69.710769-30.326153z m-296.014769 4.332307c20.873846 0 36.233846 3.938462 46.08 11.815385 9.846154 7.089231 14.966154 19.692308 14.966154 37.021538 0 17.329231-5.12 29.932308-14.572308 37.809231-9.846154 7.876923-25.206154 11.815385-46.473846 11.815385h-70.104616v-98.461539z","p-id":"20806",fill:"#ed5565"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:m.value.hasPoc},null,8,["value"]),u("div",Cl,[u("span",null,o(t(l)("app.webui.weeklyadditionspoc")),1),u("span",null,o(m.value.weeklyAdditionsPoc),1)])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalexp")),1),e(F,{size:"25"},{default:a(()=>x[2]||(x[2]=[u("svg",{t:"1727429727880",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13778",width:"200",height:"200"},[u("path",{d:"M676.408889 303.407407l-101.262222-175.976296c-132.437333-40.201481-114.801778 130.085926-203.207111 168.846222L303.407407 246.708148C347.477333 160.274963 387.337481 83.057778 429.283556 0h206.582518L758.518519 235.747556 676.408889 303.407407zM127.393185 493.037037l80.327111 61.477926c-28.899556 61.060741-55.48563 117.380741-82.223407 173.018074 29.430519 138.657185 149.238519 47.824593 215.836444 103.917037V910.222222H94.966519L0 735.156148 127.393185 493.037037zM1024 735.004444L925.999407 910.222222H682.666667v-79.568592c68.342519-48.279704 171.956148 24.045037 212.574814-97.583408l-83.133629-184.395852L895.089778 493.037037 1024 735.004444zM0 387.640889L101.793185 189.62963 303.407407 422.874074l-12.818963 32.237037L0 387.640889zM1024 358.362074L739.745185 417.185185 720.592593 392.836741 919.210667 189.62963 1024 358.362074zM417.185185 1024l80.402963-263.661037 26.699852-1.820444L606.814815 1024h-189.62963z",fill:"#1296db","p-id":"13779"}),u("path",{d:"M606.814815 455.111111h-189.62963v-75.851852h189.62963v75.851852zM682.666667 568.888889H341.333333v-75.851852h341.333334v75.851852zM796.444444 682.666667H227.555556v-75.851852h568.888888v75.851852z",fill:"#1296db","p-id":"13780"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:m.value.hasExp},null,8,["value"]),u("div",zl,[u("span",null,o(t(l)("app.webui.weeklyadditionsexp")),1),u("span",null,o(m.value.weeklyAdditionsExp),1)])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalproduct")),1),e(F,{size:"25"},{default:a(()=>x[3]||(x[3]=[u("svg",{t:"1727429889519",class:"icon",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17925",width:"200",height:"200"},[u("path",{d:"M302.32811 504.78l-146.944-88.063c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048zM459.00011 1020.878c5.888 1.792 12.544 1.28 18.688-2.304-5.632 3.072-12.288 4.096-18.688 2.304zM302.32811 504.78l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z",fill:"#3CBF71","p-id":"17926"}),u("path",{d:"M477.68811 1018.547c-6.144 3.584-12.8 4.096-18.688 2.304 6.4 1.818 13.056 0.794 18.688-2.304z",fill:"#3CBF71","p-id":"17927"}),u("path",{d:"M490.64111 954.112V511.744L880.27311 290.56l39.885-24.166c7.987-5.197 9.498-11.802 10.547-16.538 1.024-9.728-3.584-19.968-13.568-25.088L476.81711 4.608c-7.168-3.584-15.36-3.584-22.528 0L13.97011 224.768C-2.41489 235.52 0.14511 259.328 0.14511 261.888v469.76c0 8.704 4.608 16.896 12.032 21.504 0 0 430.848 260.352 438.272 263.68 15.104 7.424 24.576 5.376 31.744 1.792l143.36-82.944a25.56 25.56 0 0 0 9.216-35.072c-6.912-12.288-22.784-16.384-34.816-9.472l-99.072 57.6v-0.256l-10.24 5.632m-50.176-442.368v441.088l-390.4-235.264v-427.52l390.4 221.696z m25.088-43.52L78.22511 248.576 465.55311 55.04l387.328 193.536-387.328 219.648z",fill:"#3CBF71","p-id":"17928"}),u("path",{d:"M812.94511 917.376l201.984-121.344c5.632-3.584 9.216-9.728 9.216-16.64V556.928c0-7.834-5.888-13.312-12.288-16.384l-5.12-2.56c-0.512-0.256-1.28-0.256-1.792-0.256h1.536L810.13011 439.68c-5.376-2.56-11.776-2.56-17.152 0l-196.096 98.048c-14.336 5.504-17.92 17.792-17.92 24.704v216.96c0 6.912 3.584 13.056 9.472 16.64 0 0 200.167 120.09 201.19 120.346 0 0.025 11.93 8.857 23.322 0.998z m-30.464-49.152l-165.12-99.584V589.696l165.12 93.44v185.088z m19.2-218.112L640.65711 558.72l161.024-80.384L962.45011 558.72l-160.768 91.392zM985.74511 768.64l-164.864 99.328V683.136l164.864-93.44V768.64z",fill:"#3CBF71","p-id":"17929"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:m.value.affectedProduct},null,8,["value"]),u("div",Sl,[u("span",null,o(t(l)("app.webui.weeklyadditionsproduct")),1),u("span",null,o(m.value.weeklyAdditionsProduct),1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])]),e(Z,{header:t(l)("app.webui.userstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(D,{justify:"start"},{default:a(()=>[e(Z,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totaladmin")),1)]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:I.value.admintotal},null,8,["value"])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totaluser")),1)]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:I.value.usertotal},null,8,["value"])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(D,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.onlineuser")),1)]),_:1})]),default:a(()=>[e(p,null,{default:a(()=>[e(G,{value:I.value.onlineuser},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])],64)}}});function se(ie){const l=new Date(ie),P=l.getFullYear(),I=(l.getMonth()+1).toString().padStart(2,"0"),m=l.getDate().toString().padStart(2,"0");return`${P}-${I}-${m}`}const ql={style:{"font-weight":"lighter","font-size":"17px"}},El={style:{display:"flex","justify-content":"space-around"}},Il={style:{display:"flex",width:"80%",gap:"1%"}},Bl={key:0},Ll={key:1},Ml={class:"status"},Hl={slot:"footer",class:"dialog-footer"},jl={slot:"footer",class:"dialog-footer"},Al=ve({__name:"Userlist",setup(ie){const{t:l}=me(),P=w({}),I=w([{id:1,label:l("app.webui.admin")},{id:0,label:l("app.webui.user")}]),m=w(""),g=sessionStorage.getItem("token"),h=w(!1),c=w(!1),v=w({}),k=[O],U=w(1),x=w(15),M=w(0),Z=w([]),F=w(!0),D=w(""),G=V=>{Z.value=V,V.length>0?F.value=!1:F.value=!0},p=Ce(()=>{const f=0+x.value;if(m.value.trim()!="")return P.value.data.filter(R=>R.username.toLowerCase().includes(m.value.toLowerCase())||R.email.toLowerCase().includes(m.value.toLowerCase())||R.phone.includes(m.value));try{return P.value.data.slice(0,f)}catch{return[]}});function z(V){x.value=V,U.value=1,O()}async function ae(V){U.value=V,await O()}fe(()=>{k.forEach(V=>{V()})});async function O(){try{const V={headers:{Authorization:`Bearer ${g}`}},f=await Y.get(`/api/v1/getusers?page=${U.value}&limit=${x.value}`,V);f.data.code!=1&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username")),P.value=f.data,M.value=f.data.total}catch{}}function K(){ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const V={ids:Z.value.map(f=>f.id)};try{const f={headers:{Authorization:`Bearer ${g}`}},R=await Y.post("/api/v1/multideleteusers",V,f);R.data.code==1?(O(),N.success(l("app.webui.deletecomplete"))):R.data.code==0?N.error(l("app.webui.needlogin")):N.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})}const oe=(V,f)=>{console.log("xxx",f),v.value.id=f.id,v.value.role=f.role,v.value.username=f.username,v.value.password=f.password,v.value.email=f.email,v.value.phone=f.phone,v.value.status=f.status==1,c.value=!0},ue=(V,f)=>f.role===V,W=(V,f)=>f.status===V,$=(V,f)=>{ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{console.log(JSON.stringify({id:f.id}));try{const R={headers:{Authorization:`Bearer ${g}`}},j=await Y.post("/api/v1/deluser",{userid:f.id},R);j.data.code==1?(O(),N.success(l("app.webui.deletecomplete"))):j.data.code==0?N.error(l("app.webui.needlogin")):N.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})},d=()=>{v.value.id=null,v.value.role=null,v.value.username="",v.value.password="",v.value.email="",v.value.phone="",v.value.status=null,D.value=""};async function b(){if(v.value.role==null){N.error(l("app.webui.roleisnull"));return}if(v.value.username==""){N.error(l("app.webui.usernameempty"));return}if(v.value.password==""){N.error(l("app.webui.passwordempty"));return}if(v.value.password!=D.value){N.error(l("app.webui.passwordnotmatch"));return}try{const V={headers:{Authorization:`Bearer ${g}`}},f=await Y.post("/api/v1/adduser",v.value,V);f.data.code==1?(O(),N.success(l("app.webui.addsuccess")),h.value=!1,console.log(v.value)):f.data.code==0?N.error(l("app.webui.needlogin")):N.error(l("app.webui.usernamealreadyexist"))}catch{}}async function q(){if(v.value.password==""&&v.value.password!=D.value){N.error(l("app.webui.passwordnotmatch"));return}v.value.status=v.value.status==!0?1:0;try{const V={headers:{Authorization:`Bearer ${g}`}},f=await Y.post("/api/v1/updateuser",v.value,V);f.data.code==1?(O(),N.success(l("app.webui.modifysucc"))):f.data.code==0?N.error(l("app.webui.needlogin")):N.error(l("app.webui.modifyfail"))}catch{}c.value=!1}return(V,f)=>{const R=ye,j=we,y=ze,X=je,H=Se,B=Ue,le=be,Q=Le,r=Be,s=qe,T=Ee,S=Ae,xe=De;return i(),A(te,null,[u("div",null,[e(le,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",ql,[u("div",El,[u("div",Il,[e(R,{modelValue:m.value,"onUpdate:modelValue":f[0]||(f[0]=L=>m.value=L),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(j,{type:"primary",onClick:f[1]||(f[1]=L=>h.value=!0)},{default:a(()=>[n(o(t(l)("app.webui.add")),1)]),_:1}),e(j,{disabled:F.value,type:"danger",onClick:K},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(H,{data:p.value,onSelectionChange:G},{default:a(()=>[e(y,{type:"selection",width:"55"}),e(y,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(y,{prop:"username",label:t(l)("app.webui.username")},null,8,["label"]),e(y,{filters:[{text:t(l)("app.webui.admin"),value:1},{text:t(l)("app.webui.user"),value:0}],"filter-method":ue,label:t(l)("app.webui.role")},{default:a(({row:L})=>[L.role!=0?(i(),A("span",Bl,o(t(l)("app.webui.admin")),1)):(i(),A("span",Ll,o(t(l)("app.webui.user")),1))]),_:1},8,["filters","label"]),e(y,{prop:"email",label:t(l)("app.webui.email")},null,8,["label"]),e(y,{prop:"phone",label:t(l)("app.webui.phone")},null,8,["label"]),e(y,{filters:[{text:t(l)("app.webui.enable"),value:1},{text:t(l)("app.webui.disable"),value:0}],"filter-method":W,label:t(l)("app.webui.status")},{default:a(({row:L})=>[u("div",Ml,[L.status!=0?(i(),C(X,{key:0,type:"success",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.enable")),1)]),_:1})):(i(),C(X,{key:1,type:"info",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.disable")),1)]),_:1}))])]),_:1},8,["filters","label"]),e(y,{label:t(l)("app.webui.createtime"),sortable:""},{default:a(({row:L})=>[u("span",null,o(t(se)(L.create_time)),1)]),_:1},8,["label"]),e(y,{label:t(l)("app.webui.operate")},{default:a(L=>[e(j,{size:"small",type:"primary",onClick:pe=>oe(L.$index,L.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(j,{size:"small",type:"danger",onClick:pe=>$(L.$index,L.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(B,{"page-sizes":[15,25,50,100,200,300],"page-size":x.value,"onUpdate:pageSize":f[2]||(f[2]=L=>x.value=L),layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:z,onCurrentChange:ae,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(S,{title:t(l)("app.webui.adduser"),modelValue:h.value,"onUpdate:modelValue":f[10]||(f[10]=L=>h.value=L),width:"30%",onClose:d},{default:a(()=>[e(T,{model:v.value,"label-width":"100px"},{default:a(()=>[e(s,{required:"",label:t(l)("app.webui.role")},{default:a(()=>[e(r,{modelValue:v.value.role,"onUpdate:modelValue":f[3]||(f[3]=L=>v.value.role=L),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(i(!0),A(te,null,ce(I.value,L=>(i(),C(Q,{key:L.id,label:L.label,value:L.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(s,{required:"",label:t(l)("app.webui.username")},{default:a(()=>[e(R,{modelValue:v.value.username,"onUpdate:modelValue":f[4]||(f[4]=L=>v.value.username=L),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{required:"",label:t(l)("app.webui.password")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:v.value.password,"onUpdate:modelValue":f[5]||(f[5]=L=>v.value.password=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{required:"",label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:D.value,"onUpdate:modelValue":f[6]||(f[6]=L=>D.value=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.email")},{default:a(()=>[e(R,{modelValue:v.value.email,"onUpdate:modelValue":f[7]||(f[7]=L=>v.value.email=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.phone")},{default:a(()=>[e(R,{modelValue:v.value.phone,"onUpdate:modelValue":f[8]||(f[8]=L=>v.value.phone=L)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",Hl,[e(j,{onClick:f[9]||(f[9]=L=>h.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(j,{type:"primary",onClick:b},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(S,{title:t(l)("app.webui.edituser"),modelValue:c.value,"onUpdate:modelValue":f[19]||(f[19]=L=>c.value=L),width:"30%",onClose:d},{default:a(()=>[e(T,{model:v.value,"label-width":"100px"},{default:a(()=>[e(s,{label:t(l)("app.webui.role")},{default:a(()=>[e(r,{modelValue:v.value.role,"onUpdate:modelValue":f[11]||(f[11]=L=>v.value.role=L)},{default:a(()=>[(i(!0),A(te,null,ce(I.value,L=>(i(),C(Q,{key:L.id,label:L.label,value:L.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.username")},{default:a(()=>[e(R,{modelValue:v.value.username,"onUpdate:modelValue":f[12]||(f[12]=L=>v.value.username=L),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.password")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:v.value.password,"onUpdate:modelValue":f[13]||(f[13]=L=>v.value.password=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:D.value,"onUpdate:modelValue":f[14]||(f[14]=L=>D.value=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.email")},{default:a(()=>[e(R,{modelValue:v.value.email,"onUpdate:modelValue":f[15]||(f[15]=L=>v.value.email=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.phone")},{default:a(()=>[e(R,{modelValue:v.value.phone,"onUpdate:modelValue":f[16]||(f[16]=L=>v.value.phone=L)},null,8,["modelValue"])]),_:1},8,["label"]),e(s,{label:t(l)("app.webui.status")},{default:a(()=>[e(xe,{modelValue:v.value.status,"onUpdate:modelValue":f[17]||(f[17]=L=>v.value.status=L),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",jl,[e(j,{onClick:f[18]||(f[18]=L=>c.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(j,{type:"primary",onClick:q},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),Dl=Ve(Al,[["__scopeId","data-v-b319eaf0"]]),Pl={key:0},Tl={class:"el-upload__text"},Fl={class:"el-upload__tip"},Nl={key:1},Zl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Gl={style:{display:"flex","align-items":"center"}},Rl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Xl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Ql={style:{"margin-top":"10px","padding-inline":"25px"}},Ol=["href"],Yl={key:0,style:{position:"relative"}},Jl={key:0,style:{position:"relative"}},Wl={key:2},Kl={style:{"font-weight":"lighter","font-size":"17px"}},ea={style:{display:"flex","justify-content":"space-around"}},la={style:{display:"flex",width:"80%",gap:"1%"}},aa={class:"status"},ta={key:0},oa={key:1},ua=ve({__name:"Vulnlist",setup(ie){const{t:l}=me(),P=w("xray"),I=w("xray"),m=w([]),g=w("--"),h=w({}),c=w({}),v=w([]),k=w(""),U=[ae,R],x=w(1),M=w(15),Z=w(0),F=w(!0),D=w(!1),G=w(!1),p=w({vuln_name:"",vuln_type_id:1,cvss:.1,vuln_level:"",cve:"",nvd:"",edb:"",cnnvd:"",cnvd:"",affected_product:"",repair_suggestion:"",poc:"",exp:"",poc_type:P.value,exp_type:I.value,is_public:!1,description:"",fofa_query:"",zoom_eye_query:"",quake_query:"",hunter_query:"",google_query:"",shodan_query:"",censys_query:"",greynoise_query:"",attachment_id:"",affected_product_version:""}),z=()=>{if(p.value.cvss=Number(p.value.cvss),p.value.cvss>0&&p.value.cvss<4){p.value.vuln_level="Low",g.value=l("app.webui.low");return}else if(p.value.cvss>=4&&p.value.cvss<7){p.value.vuln_level="Medium",g.value=l("app.webui.medium");return}else if(p.value.cvss>=7&&p.value.cvss<9){p.value.vuln_level="High",g.value=l("app.webui.high");return}else if(p.value.cvss>=9&&p.value.cvss<=10){p.value.vuln_level="Critical",g.value=l("app.webui.critical");return}else N.error(l("app.webui.cvsserror"))};async function ae(){try{const r=await Y.get("/api/v1/getvulntypes");m.value=r.data.data}catch{}}const O=r=>{F.value=r.id,r.length>0?F.value=!1:F.value=!0};function K(r,s){return r.is_public&&!s.is_public?-1:!r.is_public&&s.is_public?1:0}function oe(r,s){const T=new Date(r.create_time),S=new Date(s.create_time);return T<S?-1:T>S?1:0}const ue=Ce(()=>{const s=0+M.value;if(k.value.trim()!="")return h.value.data.filter(T=>T.id.toLowerCase().includes(k.value.toLowerCase())||T.vuln_name.toLowerCase().includes(k.value.toLowerCase()));try{return h.value.data.slice(0,s)}catch{return[]}});function W(r){M.value=r,x.value=1,R()}async function $(r){x.value=r,await R()}fe(()=>{U.forEach(r=>{r()})});const d=(r,s,T,S)=>{(s.property==="id"||s.property==="vuln_name")&&(S.target.style.cursor="pointer",S.target.style.color="#409EFF")},b=(r,s,T,S)=>{(s.property==="id"||s.property==="vuln_name")&&(S.target.style.cursor="",S.target.style.color="")},q=()=>{D.value=!1,c.value={}};async function V(r){const s=sessionStorage.getItem("token");try{const T={headers:{Authorization:`Bearer ${s}`}},S=await Y.get("/api/v1/getvulndtl?id="+r,T);s&&S.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),c.value=S.data}catch{}}const f=(r,s)=>{(s.no==1||s.no==2)&&(V(r.id),D.value=!0)};async function R(){try{const r=await Y.get(`/api/v1/getvulnlist?page=${x.value}&limit=${M.value}`);h.value=r.data,Z.value=r.data.total,v.value=r.data.data.reduce((s,T)=>(s.some(S=>S.value===T.vuln_type)||s.push({text:T.vuln_type,value:T.vuln_type}),s),[])}catch{}}function j(){ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{N({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const y=async(r,s)=>{console.log(s.id),await V(s.id),console.log(c.value),p.value=c.value.data,G.value=!0,console.log(p.value)},X=(r,s)=>{ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{N({type:"success",message:l("app.webui.deletecomplete")}),console.log(r,s)}).catch(()=>{})};function H(){console.log(p.value)}const B=(r,s)=>s.vuln_type===r,le=(r,s)=>s.level===r,Q=(r,s)=>r==="Poc"?s.poc!="":s.exp!="";return(r,s)=>{const T=ye,S=qe,xe=Le,L=Be,pe=De,ne=tl,he=ol,Me=Ie,E=Ge,_e=we,Xe=Ee,ke=be,ee=je,J=Pe,Ne=Te,Ze=Fe,re=ze,Qe=Se,Oe=Ue;return G.value?(i(),A("div",Pl,[e(ke,{shadow:"always",header:t(l)("app.webui.editvuln")},{default:a(()=>[u("div",null,[e(Xe,{inline:"true",model:p.value,"label-width":"auto",size:"large"},{default:a(()=>[e(S,{label:t(l)("app.webui.vulnname"),prop:"vuln_name",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(T,{modelValue:p.value.vuln_name,"onUpdate:modelValue":s[0]||(s[0]=_=>p.value.vuln_name=_)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(S,{label:t(l)("app.webui.vulntype"),style:{width:"45%"},required:""},{default:a(()=>[e(L,{modelValue:p.value.vuln_type_id,"onUpdate:modelValue":s[1]||(s[1]=_=>p.value.vuln_type_id=_),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(i(!0),A(te,null,ce(m.value,_=>(i(),C(xe,{key:_.id,label:_.name,value:_.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.affectedproduct"),prop:"affected_product",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(T,{modelValue:p.value.affected_product,"onUpdate:modelValue":s[2]||(s[2]=_=>p.value.affected_product=_)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(S,{label:t(l)("app.webui.productversion"),style:{width:"45%"},prop:"affected_product_version",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(T,{modelValue:p.value.affected_product_version,"onUpdate:modelValue":s[3]||(s[3]=_=>p.value.affected_product_version=_)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(S,{label:"CVSS",style:{width:"29%"},required:""},{default:a(()=>[e(T,{modelValue:p.value.cvss,"onUpdate:modelValue":s[4]||(s[4]=_=>p.value.cvss=_),type:"number",step:"0.1",onChange:z},null,8,["modelValue"])]),_:1}),e(S,{label:t(l)("app.webui.vulnlevel"),style:{width:"29%"},required:""},{default:a(()=>[e(T,{modelValue:g.value,"onUpdate:modelValue":s[5]||(s[5]=_=>g.value=_),readonly:"",disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.ispublic"),style:{width:"29%"}},{default:a(()=>[e(pe,{modelValue:p.value.is_public,"onUpdate:modelValue":s[6]||(s[6]=_=>p.value.is_public=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.cveid"),style:{width:"29%"}},{default:a(()=>[e(T,{modelValue:p.value.cve,"onUpdate:modelValue":s[7]||(s[7]=_=>p.value.cve=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.nvdid"),style:{width:"29%"}},{default:a(()=>[e(T,{modelValue:p.value.nvd,"onUpdate:modelValue":s[8]||(s[8]=_=>p.value.nvd=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.edbid"),style:{width:"29%"}},{default:a(()=>[e(T,{modelValue:p.value.edbid,"onUpdate:modelValue":s[9]||(s[9]=_=>p.value.edbid=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.cnnvdid"),style:{width:"29%"}},{default:a(()=>[e(T,{modelValue:p.value.cnnvd,"onUpdate:modelValue":s[10]||(s[10]=_=>p.value.cnnvd=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.cnvdid"),style:{width:"29%"}},{default:a(()=>[e(T,{modelValue:p.value.cnvd,"onUpdate:modelValue":s[11]||(s[11]=_=>p.value.cnvd=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Fofa ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.fofa_query,"onUpdate:modelValue":s[12]||(s[12]=_=>p.value.fofa_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`ZoomEye ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.zoom_eye_query,"onUpdate:modelValue":s[13]||(s[13]=_=>p.value.zoom_eye_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Quake ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.quake_query,"onUpdate:modelValue":s[14]||(s[14]=_=>p.value.quake_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Hunter ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.hunter_query,"onUpdate:modelValue":s[15]||(s[15]=_=>p.value.hunter_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Google ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.google_query,"onUpdate:modelValue":s[16]||(s[16]=_=>p.value.google_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Shodan ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.shodan_query,"onUpdate:modelValue":s[17]||(s[17]=_=>p.value.shodan_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Censys ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.censys_query,"onUpdate:modelValue":s[18]||(s[18]=_=>p.value.censys_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:`Greynoise ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(T,{modelValue:p.value.greynoise_query,"onUpdate:modelValue":s[19]||(s[19]=_=>p.value.greynoise_query=_)},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.vulndesc"),style:{width:"90%"},prop:"description",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(T,{modelValue:p.value.description,"onUpdate:modelValue":s[20]||(s[20]=_=>p.value.description=_),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(S,{label:t(l)("app.webui.vulnsuggest"),style:{width:"90%"},prop:"repair_suggestion",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(T,{modelValue:p.value.repair_suggestion,"onUpdate:modelValue":s[21]||(s[21]=_=>p.value.repair_suggestion=_),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(S,{label:"Poc",style:{width:"90%"},onChange:r.ShowPocInput},{default:a(()=>[e(he,{modelValue:P.value,"onUpdate:modelValue":s[22]||(s[22]=_=>P.value=_),size:"large"},{default:a(()=>[e(ne,{label:"Xray",value:"xray"}),e(ne,{label:"Nuclei",value:"nuclei"}),e(ne,{label:"Goby",value:"goby"}),e(ne,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(T,{modelValue:p.value.poc,"onUpdate:modelValue":s[23]||(s[23]=_=>p.value.poc=_),type:"textarea",placeholder:r.pocplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e(S,{label:"Exp",style:{width:"90%"},onChange:r.ShowExpInput},{default:a(()=>[e(he,{modelValue:I.value,"onUpdate:modelValue":s[24]||(s[24]=_=>I.value=_),size:"large"},{default:a(()=>[e(ne,{label:"Xray",value:"xray"}),e(ne,{label:"Nuclei",value:"nuclei"}),e(ne,{label:"Goby",value:"goby"}),e(ne,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(T,{modelValue:p.value.exp,"onUpdate:modelValue":s[25]||(s[25]=_=>p.value.exp=_),type:"textarea",placeholder:r.expplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e(S,{label:t(l)("app.webui.attachfile"),style:{width:"100%"}},{default:a(()=>[e(E,{class:"upload-demo",drag:"",accept:".zip,.doc,.docx,.pdf,.txt",action:"/api/v1/upload",headers:{Authorization:`Bearer ${r.token}`},"on-success":r.handleSuccess,"on-remove":r.handleRemove,style:{width:"90%"}},{tip:a(()=>[u("div",Fl,o(t(l)("app.webui.uploadnotice1")),1)]),default:a(()=>[e(Me,{class:"el-icon--upload"},{default:a(()=>[e(t(al))]),_:1}),u("div",Tl,[n(o(t(l)("app.webui.draguplaod"))+" ",1),u("em",null,o(t(l)("app.webui.clickupload")),1)])]),_:1},8,["headers","on-success","on-remove"])]),_:1},8,["label"]),e(S,{style:{width:"100%"}},{default:a(()=>[e(_e,{onClick:s[26]||(s[26]=_=>G.value=!1),size:"default"},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(_e,{type:"primary",onClick:H,size:"default"},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["header"])])):D.value?(i(),A("div",Nl,[e(ke,{shadow:"always"},{header:a(()=>[u("div",Zl,[u("span",Gl,[e(Me,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>s[33]||(s[33]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+o(c.value.data.vuln_name),1)]),e(_e,{type:"primary",onClick:q},{default:a(()=>[n(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[u("div",null,[e(Ne,{column:5},{default:a(()=>[e(J,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(ee,null,{default:a(()=>[n(o(c.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[n(o(c.value.data.vuln_type),1)]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[c.value.data.vuln_level==="Critical"?(i(),C(ee,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):c.value.data.vuln_level==="High"?(i(),C(ee,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):c.value.data.vuln_level==="Medium"?(i(),C(ee,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(i(),C(ee,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[n(o(t(se)(c.value.data.create_time)),1)]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[n(o(c.value.data.submitter),1)]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(ee,null,{default:a(()=>[n(o(c.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(ee,null,{default:a(()=>[n(o(c.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(ee,null,{default:a(()=>[n(o(c.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(ee,null,{default:a(()=>[n(o(c.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(J,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(ee,null,{default:a(()=>[n(o(c.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(J,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[n(o(c.value.data.affected_product),1)]),_:1},8,["label"]),e(J,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[n(o(c.value.data.affected_product_version),1)]),_:1},8,["label"]),e(J,{label:"CVSS:"},{default:a(()=>[n(o(c.value.data.cvss),1)]),_:1}),e(J,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",Rl,o(c.value.data.description),1)]),_:1},8,["label"]),e(J,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",Xl,o(c.value.data.repair_suggestion),1)]),_:1},8,["label"]),c.value.data.attachment_id?(i(),C(J,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",Ql,[u("a",{href:`/download/file?id=${c.value.data.attachment_id}`},o(c.value.data.attachment_name),9,Ol)])]),_:1},8,["label"])):de("",!0)]),_:1})])]),_:1}),e(ke,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(Ne,{column:5},{default:a(()=>[e(J,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.fofa_query),1)]),_:1},8,["label"]),e(J,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(J,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.quake_query),1)]),_:1},8,["label"]),e(J,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.hunter_query),1)]),_:1},8,["label"]),e(J,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.google_query),1)]),_:1},8,["label"]),e(J,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.shodan_query),1)]),_:1},8,["label"]),e(J,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.censys_query),1)]),_:1},8,["label"]),e(J,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(c.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(ke,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[c.value.data.poc!=""?(i(),A("div",Yl,[e(_e,{type:"primary",icon:t($e),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:s[27]||(s[27]=_=>r.copyToClipboard(c.value.data.poc))},null,8,["icon"]),e(T,{modelValue:c.value.data.poc,"onUpdate:modelValue":s[28]||(s[28]=_=>c.value.data.poc=_),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(i(),C(Ze,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(ke,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[c.value.data.exp!=""?(i(),A("div",Jl,[e(_e,{type:"primary",icon:t($e),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:s[29]||(s[29]=_=>r.copyToClipboard(c.value.data.exp))},null,8,["icon"]),e(T,{modelValue:c.value.data.exp,"onUpdate:modelValue":s[30]||(s[30]=_=>c.value.data.exp=_),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(i(),C(Ze,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(i(),A("div",Wl,[e(ke,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",Kl,[u("div",ea,[u("div",la,[e(T,{modelValue:k.value,"onUpdate:modelValue":s[31]||(s[31]=_=>k.value=_),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),e(_e,{disabled:F.value,type:"danger",onClick:j},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])]),e(Qe,{data:ue.value,onSelectionChange:O,onCellMouseEnter:d,onCellMouseLeave:b,onCellClick:f},{default:a(()=>[e(re,{type:"selection",width:"55"}),e(re,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(re,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(re,{prop:"vuln_type",filters:v.value,"filter-method":B,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(re,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":le,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:_})=>[_.vuln_level==="Critical"?(i(),C(ee,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):_.vuln_level==="High"?(i(),C(ee,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):_.vuln_level==="Medium"?(i(),C(ee,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(i(),C(ee,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(re,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(re,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":Q,label:"Poc&Exp",width:"120"},{default:a(({row:_})=>[u("div",aa,[_.poc!=""&&_.poc!="0"?(i(),C(ee,{key:0,type:"success",effect:"dark"},{default:a(()=>s[34]||(s[34]=[n("Poc")])),_:1})):(i(),C(ee,{key:1,type:"info",effect:"dark"},{default:a(()=>s[35]||(s[35]=[n("Poc")])),_:1})),_.exp!=""&&_.exp!="0"?(i(),C(ee,{key:2,type:"success",effect:"dark"},{default:a(()=>s[36]||(s[36]=[n("Exp")])),_:1})):(i(),C(ee,{key:3,type:"info",effect:"dark"},{default:a(()=>s[37]||(s[37]=[n("Exp")])),_:1}))])]),_:1}),e(re,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":K,width:"110"},{default:a(({row:_})=>[_.is_public?(i(),A("span",ta,o(t(l)("app.webui.yes")),1)):(i(),A("span",oa,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(re,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":oe},{default:a(({row:_})=>[u("span",null,o(t(se)(_.create_time)),1)]),_:1},8,["label"]),e(re,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":oe},{default:a(({row:_})=>[u("span",null,o(t(se)(_.update_time)),1)]),_:1},8,["label"]),e(re,{label:t(l)("app.webui.operate"),width:"140"},{default:a(_=>[e(_e,{disabled:_.row.status===0,size:"small",type:"primary",onClick:Ye=>y(_.$index,_.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["disabled","onClick"]),e(_e,{disabled:_.row.status===0,size:"small",type:"danger",onClick:Ye=>X(_.$index,_.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(Oe,{"page-sizes":[15,25,50,100,200,300],"page-size":M.value,"onUpdate:pageSize":s[32]||(s[32]=_=>M.value=_),layout:"total, sizes, prev, pager, next, jumper",total:Z.value,onSizeChange:W,onCurrentChange:$,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),na=Ve(ua,[["__scopeId","data-v-4f61de4a"]]),sa={key:0},ia={style:{"font-weight":"lighter","font-size":"17px"}},da={style:{display:"flex","justify-content":"space-around"}},pa={style:{display:"flex",width:"80%",gap:"1%"}},ra={class:"status"},ca={key:0},va={key:1},ma={key:1},fa={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ba={style:{display:"flex","align-items":"center"}},_a={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ya={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},wa={style:{"margin-top":"10px","padding-inline":"25px"}},ha=["href"],ga={key:0,style:{position:"relative"}},Va={key:0,style:{position:"relative"}},xa={style:{"margin-top":"1%"}},ka=ve({__name:"Unaudited",setup(ie){const{t:l}=me(),P=w(!1),I=sessionStorage.getItem("token"),m=w([]),g=w({}),h=w({}),c=w({id:null,audit:1,review:"",cvss:null,prid:0,erid:0,irid:0,orid:0}),v=w(""),k=[b,q],U=w(1),x=w(15),M=w(0),Z=w([]),F=w([]),D=w([]),G=w([]),p=[{id:1,name:l("app.webui.pass")},{id:2,name:l("app.webui.unpassed")}],z={id:0,rule:""};function ae(j,y){return j.is_public&&!y.is_public?-1:!j.is_public&&y.is_public?1:0}function O(j,y){const X=new Date(j.create_time),H=new Date(y.create_time);return X<H?-1:X>H?1:0}const K=Ce(()=>{const y=0+x.value;if(console.log(g.value),v.value.trim()!="")return g.value.data.filter(X=>X.id.toLowerCase().includes(v.value.toLowerCase())||X.vuln_name.toLowerCase().includes(v.value.toLowerCase()));try{return g.value.data.slice(0,y)}catch{return[]}});function oe(j){x.value=j,U.value=1,b()}async function ue(j){U.value=j,await b()}fe(()=>{k.forEach(j=>{j()})});const W=()=>{P.value=!1,h.value={}},$=async(j,y)=>{console.log(j,y);try{const X={headers:{Authorization:`Bearer ${I}`}},H=await Y.get("/api/v1/getvulndtl?id="+y.id,X);I&&H.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),h.value=H.data,c.value.id=y.id,c.value.cvss=H.data.data.cvss,P.value=!0}catch{}};async function d(){try{const j={headers:{Authorization:`Bearer ${I}`}};c.value.cvss=Number(c.value.cvss),(await Y.post("/api/v1/auditvuln",c.value,j)).data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):(N.success(l("app.webui.audited")),h.value={},P.value=!1,b())}catch{}}async function b(){try{const j={headers:{Authorization:`Bearer ${I}`}},y=await Y.get(`/api/v1/getunauditlist?page=${U.value}&limit=${x.value}`,j);g.value=y.data,M.value=y.data.total,m.value=y.data.data.reduce((X,H)=>(X.some(B=>B.value===H.vuln_type)||X.push({text:H.vuln_type,value:H.vuln_type}),X),[])}catch{}}async function q(){try{const j={headers:{Authorization:`Bearer ${I}`}},y=await Y.get("/api/v1/getscorerules",j);y.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),Z.value=y.data.data.pocrules,F.value=y.data.data.exprules,D.value=y.data.data.incidencerules,G.value=y.data.data.otherrules,Z.value.push(z),F.value.push(z),D.value.push(z),G.value.push(z)}catch{}}const V=(j,y)=>y.vuln_type===j,f=(j,y)=>y.level===j,R=(j,y)=>j==="Poc"?y.poc!="":y.exp!="";return(j,y)=>{const X=ye,H=ze,B=je,le=we,Q=Se,r=Ue,s=be,T=Ie,S=Pe,xe=Te,L=Fe,pe=qe,ne=Le,he=Be,Me=Ee;return P.value?(i(),A("div",ma,[e(s,{shadow:"always"},{header:a(()=>[u("div",fa,[u("span",ba,[e(T,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>y[18]||(y[18]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+o(h.value.data.vuln_name),1)])])]),default:a(()=>[u("div",null,[e(xe,{column:5},{default:a(()=>[e(S,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(B,null,{default:a(()=>[n(o(h.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[n(o(h.value.data.vuln_type),1)]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[h.value.data.vuln_level==="Critical"?(i(),C(B,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):h.value.data.vuln_level==="High"?(i(),C(B,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):h.value.data.vuln_level==="Medium"?(i(),C(B,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(i(),C(B,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[n(o(t(se)(h.value.data.create_time)),1)]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[n(o(h.value.data.submitter),1)]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(B,null,{default:a(()=>[n(o(h.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(B,null,{default:a(()=>[n(o(h.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(B,null,{default:a(()=>[n(o(h.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(B,null,{default:a(()=>[n(o(h.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(S,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(B,null,{default:a(()=>[n(o(h.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(S,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[n(o(h.value.data.affected_product),1)]),_:1},8,["label"]),e(S,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[n(o(h.value.data.affected_product_version),1)]),_:1},8,["label"]),e(S,{label:"CVSS:"},{default:a(()=>[n(o(h.value.data.cvss),1)]),_:1}),e(S,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",_a,o(h.value.data.description),1)]),_:1},8,["label"]),e(S,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",ya,o(h.value.data.repair_suggestion),1)]),_:1},8,["label"]),h.value.data.attachment_id?(i(),C(S,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",wa,[u("a",{href:`/download/file?id=${h.value.data.attachment_id}`},o(h.value.data.attachment_name),9,ha)])]),_:1},8,["label"])):de("",!0)]),_:1})])]),_:1}),e(s,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(xe,{column:5},{default:a(()=>[e(S,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.fofa_query),1)]),_:1},8,["label"]),e(S,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(S,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.quake_query),1)]),_:1},8,["label"]),e(S,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.hunter_query),1)]),_:1},8,["label"]),e(S,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.google_query),1)]),_:1},8,["label"]),e(S,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.shodan_query),1)]),_:1},8,["label"]),e(S,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.censys_query),1)]),_:1},8,["label"]),e(S,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),h.value.data.poc!=""?(i(),C(s,{key:0,style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[h.value.data.poc!=""?(i(),A("div",ga,[e(le,{type:"primary",icon:t($e),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:y[2]||(y[2]=E=>j.copyToClipboard(h.value.data.poc))},null,8,["icon"]),e(X,{modelValue:h.value.data.poc,"onUpdate:modelValue":y[3]||(y[3]=E=>h.value.data.poc=E),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(i(),C(L,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})):de("",!0),h.value.data.exp!=""?(i(),C(s,{key:1,style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[h.value.data.exp!=""?(i(),A("div",Va,[e(le,{type:"primary",icon:t($e),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:y[4]||(y[4]=E=>j.copyToClipboard(h.value.data.exp))},null,8,["icon"]),e(X,{modelValue:h.value.data.exp,"onUpdate:modelValue":y[5]||(y[5]=E=>h.value.data.exp=E),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(i(),C(L,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})):de("",!0),e(s,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.audit")},{default:a(()=>[e(Me,{model:c.value},{default:a(()=>[e(pe,{label:"CVSS:"},{default:a(()=>[e(X,{type:"numper",modelValue:c.value.cvss,"onUpdate:modelValue":y[6]||(y[6]=E=>c.value.cvss=E)},null,8,["modelValue"])]),_:1}),e(pe,{label:`${t(l)("app.webui.audit")}:`},{default:a(()=>[e(he,{modelValue:c.value.audit,"onUpdate:modelValue":y[7]||(y[7]=E=>c.value.audit=E),placeholder:t(l)("app.webui.observability")},{default:a(()=>[(i(),A(te,null,ce(p,E=>e(ne,{key:E.id,label:E.name,value:E.id},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),c.value.audit==2?(i(),C(pe,{key:0,label:t(l)("app.webui.reviewcomments")},{default:a(()=>[e(X,{type:"textarea",modelValue:c.value.review,"onUpdate:modelValue":y[8]||(y[8]=E=>c.value.review=E)},null,8,["modelValue"])]),_:1},8,["label"])):de("",!0),c.value.audit==1?(i(),C(pe,{key:1,label:`${t(l)("app.webui.pocscorerule")}:`},{default:a(()=>[e(he,{modelValue:c.value.prid,"onUpdate:modelValue":y[9]||(y[9]=E=>c.value.prid=E),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(i(!0),A(te,null,ce(Z.value,E=>(i(),C(ne,{key:E.id,label:E.rule,value:E.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):de("",!0),c.value.audit==1?(i(),C(pe,{key:2,label:`${t(l)("app.webui.exprule")}:`},{default:a(()=>[e(he,{modelValue:c.value.erid,"onUpdate:modelValue":y[10]||(y[10]=E=>c.value.erid=E),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(i(!0),A(te,null,ce(F.value,E=>(i(),C(ne,{key:E.id,label:E.rule,value:E.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):de("",!0),c.value.audit==1?(i(),C(pe,{key:3,label:`${t(l)("app.webui.incidencerule")}:`},{default:a(()=>[e(he,{modelValue:c.value.irid,"onUpdate:modelValue":y[11]||(y[11]=E=>c.value.irid=E),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(i(!0),A(te,null,ce(D.value,E=>(i(),C(ne,{key:E.id,label:E.rule,value:E.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):de("",!0),c.value.audit==1?(i(),C(pe,{key:4,label:`${t(l)("app.webui.otherrule")}:`},{default:a(()=>[e(he,{modelValue:c.value.orid,"onUpdate:modelValue":y[12]||(y[12]=E=>c.value.orid=E),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(i(!0),A(te,null,ce(G.value,E=>(i(),C(ne,{key:E.id,label:E.rule,value:E.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):de("",!0)]),_:1},8,["model"])]),_:1},8,["header"]),u("div",xa,[e(le,{onClick:W},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(le,{type:"primary",onClick:d},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])])):(i(),A("div",sa,[e(s,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",ia,[u("div",da,[u("div",pa,[e(X,{modelValue:v.value,"onUpdate:modelValue":y[0]||(y[0]=E=>v.value=E),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),y[13]||(y[13]=u("span",null,null,-1))]),e(Q,{data:K.value},{default:a(()=>[e(H,{type:"selection",width:"55"}),e(H,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(H,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(H,{prop:"vuln_type",filters:m.value,"filter-method":V,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(H,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":f,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:E})=>[E.vuln_level==="Critical"?(i(),C(B,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):E.vuln_level==="High"?(i(),C(B,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):E.vuln_level==="Medium"?(i(),C(B,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(i(),C(B,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(H,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(H,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":R,label:t(l)("app.webui.status"),width:"120"},{default:a(({row:E})=>[u("div",ra,[E.poc!=""&&E.poc!="0"?(i(),C(B,{key:0,type:"success",effect:"dark"},{default:a(()=>y[14]||(y[14]=[n("Poc")])),_:1})):(i(),C(B,{key:1,type:"info",effect:"dark"},{default:a(()=>y[15]||(y[15]=[n("Poc")])),_:1})),E.exp!=""&&E.exp!="0"?(i(),C(B,{key:2,type:"success",effect:"dark"},{default:a(()=>y[16]||(y[16]=[n("Exp")])),_:1})):(i(),C(B,{key:3,type:"info",effect:"dark"},{default:a(()=>y[17]||(y[17]=[n("Exp")])),_:1}))])]),_:1},8,["label"]),e(H,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":ae,width:"110"},{default:a(({row:E})=>[E.is_public?(i(),A("span",ca,o(t(l)("app.webui.yes")),1)):(i(),A("span",va,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(H,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":O},{default:a(({row:E})=>[u("span",null,o(t(se)(E.create_time)),1)]),_:1},8,["label"]),e(H,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":O},{default:a(({row:E})=>[u("span",null,o(t(se)(E.update_time)),1)]),_:1},8,["label"]),e(H,{label:t(l)("app.webui.operate"),width:"140"},{default:a(E=>[e(le,{size:"small",type:"primary",onClick:_e=>$(E.$index,E.row)},{default:a(()=>[n(o(t(l)("app.webui.audit")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(r,{"page-sizes":[15,25,50,100,200,300],"page-size":x.value,"onUpdate:pageSize":y[1]||(y[1]=E=>x.value=E),layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:oe,onCurrentChange:ue,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),$a=Ve(ka,[["__scopeId","data-v-18d0d851"]]),Ca={key:0},za={style:{"font-weight":"lighter","font-size":"17px"}},Sa={style:{display:"flex","justify-content":"space-around"}},Ua={style:{display:"flex",width:"80%",gap:"1%"}},qa={class:"status"},Ea={key:0},Ia={key:1},Ba={key:1},La={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ma={style:{display:"flex","align-items":"center"}},Ha={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ja={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Aa={style:{"margin-top":"10px","padding-inline":"25px"}},Da=["href"],Pa={key:0,style:{position:"relative"}},Ta={key:0,style:{position:"relative"}},Fa=ve({__name:"Audited",setup(ie){const{t:l}=me(),P=w(!1),I=sessionStorage.getItem("token"),m=w({}),g=w({}),h=w(""),c=w([]),v=[K],k=w(1),U=w(15),x=w(0);function M($,d){return $.is_public&&!d.is_public?-1:!$.is_public&&d.is_public?1:0}function Z($,d){const b=new Date($.create_time),q=new Date(d.create_time);return b<q?-1:b>q?1:0}const F=Ce(()=>{const d=0+U.value;if(console.log(m.value),h.value.trim()!="")return m.value.data.filter(b=>b.id.toLowerCase().includes(h.value.toLowerCase())||b.vuln_name.toLowerCase().includes(h.value.toLowerCase()));try{return m.value.data.slice(0,d)}catch{return[]}});function D($){U.value=$,k.value=1,K()}async function G($){k.value=$,await K()}const p=($,d,b,q)=>{(d.property==="id"||d.property==="vuln_name")&&(q.target.style.cursor="pointer",q.target.style.color="#409EFF")},z=($,d,b,q)=>{(d.property==="id"||d.property==="vuln_name")&&(q.target.style.cursor="",q.target.style.color="")},ae=()=>{P.value=!1,g.value={}},O=async($,d)=>{if(d.no==0||d.no==1)try{const b={headers:{Authorization:`Bearer ${I}`}},q=await Y.get("/api/v1/getvulndtl?id="+$.id,b);I&&q.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),g.value=q.data,P.value=!0}catch{}};fe(()=>{v.forEach($=>{$()})});async function K(){try{const $={headers:{Authorization:`Bearer ${I}`}},d=await Y.get(`/api/v1/getauditedlist?page=${k.value}&limit=${U.value}`,$);m.value=d.data,x.value=d.data.total,c.value=d.data.data.reduce((b,q)=>(b.some(V=>V.value===q.vuln_type)||b.push({text:q.vuln_type,value:q.vuln_type}),b),[])}catch{}}const oe=($,d)=>d.vuln_type===$,ue=($,d)=>d.level===$,W=($,d)=>$==="Poc"?d.poc!="":d.exp!="";return($,d)=>{const b=ye,q=ze,V=je,f=Se,R=Ue,j=be,y=Ie,X=we,H=Pe,B=Te,le=Fe;return P.value?(i(),A("div",Ba,[e(j,{shadow:"always"},{header:a(()=>[u("div",La,[u("span",Ma,[e(y,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>d[11]||(d[11]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+o(g.value.data.vuln_name),1)]),e(X,{type:"primary",onClick:ae},{default:a(()=>[n(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[u("div",null,[e(B,{column:5},{default:a(()=>[e(H,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(V,null,{default:a(()=>[n(o(g.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[n(o(g.value.data.vuln_type),1)]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[g.value.data.vuln_level==="Critical"?(i(),C(V,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):g.value.data.vuln_level==="High"?(i(),C(V,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):g.value.data.vuln_level==="Medium"?(i(),C(V,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(i(),C(V,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[n(o(t(se)(g.value.data.create_time)),1)]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[n(o(g.value.data.submitter),1)]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(V,null,{default:a(()=>[n(o(g.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(V,null,{default:a(()=>[n(o(g.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(V,null,{default:a(()=>[n(o(g.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(V,null,{default:a(()=>[n(o(g.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(H,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(V,null,{default:a(()=>[n(o(g.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(H,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[n(o(g.value.data.affected_product),1)]),_:1},8,["label"]),e(H,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[n(o(g.value.data.affected_product_version),1)]),_:1},8,["label"]),e(H,{label:"CVSS:"},{default:a(()=>[n(o(g.value.data.cvss),1)]),_:1}),e(H,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",Ha,o(g.value.data.description),1)]),_:1},8,["label"]),e(H,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",ja,o(g.value.data.repair_suggestion),1)]),_:1},8,["label"]),g.value.data.attachment_id?(i(),C(H,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",Aa,[u("a",{href:`/download/file?id=${g.value.data.attachment_id}`},o(g.value.data.attachment_name),9,Da)])]),_:1},8,["label"])):de("",!0)]),_:1})])]),_:1}),e(j,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(B,{column:5},{default:a(()=>[e(H,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.fofa_query),1)]),_:1},8,["label"]),e(H,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(H,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.quake_query),1)]),_:1},8,["label"]),e(H,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.hunter_query),1)]),_:1},8,["label"]),e(H,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.google_query),1)]),_:1},8,["label"]),e(H,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.shodan_query),1)]),_:1},8,["label"]),e(H,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.censys_query),1)]),_:1},8,["label"]),e(H,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(g.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(j,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[g.value.data.poc!=""?(i(),A("div",Pa,[e(X,{type:"primary",icon:t($e),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:d[2]||(d[2]=Q=>$.copyToClipboard(g.value.data.poc))},null,8,["icon"]),e(b,{modelValue:g.value.data.poc,"onUpdate:modelValue":d[3]||(d[3]=Q=>g.value.data.poc=Q),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(i(),C(le,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(j,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[g.value.data.exp!=""?(i(),A("div",Ta,[e(X,{type:"primary",icon:t($e),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:d[4]||(d[4]=Q=>$.copyToClipboard(g.value.data.exp))},null,8,["icon"]),e(b,{modelValue:g.value.data.exp,"onUpdate:modelValue":d[5]||(d[5]=Q=>g.value.data.exp=Q),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(i(),C(le,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(i(),A("div",Ca,[e(j,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",za,[u("div",Sa,[u("div",Ua,[e(b,{modelValue:h.value,"onUpdate:modelValue":d[0]||(d[0]=Q=>h.value=Q),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),d[6]||(d[6]=u("span",null,null,-1))]),e(f,{data:F.value,onSelectionChange:$.handleSelectionChange,onCellMouseEnter:p,onCellMouseLeave:z,onCellClick:O},{default:a(()=>[e(q,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(q,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(q,{prop:"vuln_type",filters:c.value,"filter-method":oe,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(q,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":ue,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:Q})=>[Q.vuln_level==="Critical"?(i(),C(V,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):Q.vuln_level==="High"?(i(),C(V,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):Q.vuln_level==="Medium"?(i(),C(V,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(i(),C(V,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(q,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(q,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":W,label:"Poc&Exp",width:"120"},{default:a(({row:Q})=>[u("div",qa,[Q.poc!=""&&Q.poc!="0"?(i(),C(V,{key:0,type:"success",effect:"dark"},{default:a(()=>d[7]||(d[7]=[n("Poc")])),_:1})):(i(),C(V,{key:1,type:"info",effect:"dark"},{default:a(()=>d[8]||(d[8]=[n("Poc")])),_:1})),Q.exp!=""&&Q.exp!="0"?(i(),C(V,{key:2,type:"success",effect:"dark"},{default:a(()=>d[9]||(d[9]=[n("Exp")])),_:1})):(i(),C(V,{key:3,type:"info",effect:"dark"},{default:a(()=>d[10]||(d[10]=[n("Exp")])),_:1}))])]),_:1}),e(q,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":M,width:"110"},{default:a(({row:Q})=>[Q.is_public?(i(),A("span",Ea,o(t(l)("app.webui.yes")),1)):(i(),A("span",Ia,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(q,{label:t(l)("app.webui.status"),sortable:"","sort-method":M,width:"110"},{default:a(({row:Q})=>[Q.status==1?(i(),C(V,{key:0,type:"success"},{default:a(()=>[n(o(t(l)("app.webui.passed")),1)]),_:1})):(i(),C(V,{key:1,type:"danger"},{default:a(()=>[n(o(t(l)("app.webui.unpassed")),1)]),_:1}))]),_:1},8,["label"]),e(q,{prop:"review_comments",label:t(l)("app.webui.reviewcomments")},null,8,["label"]),e(q,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":Z},{default:a(({row:Q})=>[u("span",null,o(t(se)(Q.update_time)),1)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])]),e(R,{"page-sizes":[15,25,50,100,200,300],"page-size":U.value,"onUpdate:pageSize":d[1]||(d[1]=Q=>U.value=Q),layout:"total, sizes, prev, pager, next, jumper",total:x.value,onSizeChange:D,onCurrentChange:G,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Na=Ve(Fa,[["__scopeId","data-v-f438273b"]]),Za={style:{"margin-top":"1%"}},Ga=ve({__name:"System",setup(ie){const{t:l}=me(),P=w(!0),I=sessionStorage.getItem("token"),m=w({emailconf:{email_host:"",email_port:0,email_user:"",email_password:"",email_sender:""},jwtconf:{jwt_secret:"",jwt_expires:0},noticeconf:{type:0,secret:"",webhook:""},sysconf:{user_register:!1,user_display:"",max_attempts:0,lockout_duration:0}}),g=w([{key:0,value:l("el.select.placeholder")},{key:1,value:l("app.webui.dingtalk")},{key:2,value:l("app.webui.wxwork")}]);fe(h);async function h(){try{const v={headers:{Authorization:`Bearer ${I}`}},k=await Y.get("/api/v1/getsysconfig",v);k.data.code==1?m.value=k.data.data:(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"))}catch{}}async function c(){console.log(m.value);try{const v={headers:{Authorization:`Bearer ${I}`}};m.value.emailconf.email_port=Number(m.value.emailconf.email_port),m.value.jwtconf.jwt_expires=Number(m.value.jwtconf.jwt_expires),m.value.noticeconf.type=Number(m.value.noticeconf.type),m.value.sysconf.max_attempts=Number(m.value.sysconf.max_attempts),m.value.sysconf.lockout_duration=Number(m.value.sysconf.lockout_duration),(await Y.post("/api/v1/updatesysconfig",m.value,v)).data.code==1?(h(),N({type:"success",message:l("app.webui.savesuccess")}),P.value=!0):N({type:"error",message:l("app.webui.savefail")})}catch{}}return(v,k)=>{const U=De,x=qe,M=ye,Z=Ee,F=be,D=Le,G=Be,p=we;return i(),A(te,null,[e(F,{header:t(l)("app.webui.regandlogincnfg")},{default:a(()=>[e(Z,{disabled:P.value,modelValue:m.value.sysconf,"onUpdate:modelValue":k[9]||(k[9]=z=>m.value.sysconf=z),"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(x,{label:t(l)("app.webui.userregister")},{default:a(()=>[e(U,{modelValue:m.value.sysconf.user_register,"onUpdate:modelValue":k[0]||(k[0]=z=>m.value.sysconf.user_register=z),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.userdisplay")},{default:a(()=>[e(M,{modelValue:m.value.sysconf.user_display,"onUpdate:modelValue":k[1]||(k[1]=z=>m.value.sysconf.user_display=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.maxattempts"),required:""},{default:a(()=>[e(M,{type:"number",modelValue:m.value.sysconf.max_attempts,"onUpdate:modelValue":k[2]||(k[2]=z=>m.value.sysconf.max_attempts=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.lockoutduration"),required:""},{default:a(()=>[e(M,{type:"number",modelValue:m.value.sysconf.lockout_duration,"onUpdate:modelValue":k[3]||(k[3]=z=>m.value.sysconf.lockout_duration=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.emailserver")},{default:a(()=>[e(M,{modelValue:m.value.emailconf.email_host,"onUpdate:modelValue":k[4]||(k[4]=z=>m.value.emailconf.email_host=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.emailport")},{default:a(()=>[e(M,{type:"number",modelValue:m.value.emailconf.email_port,"onUpdate:modelValue":k[5]||(k[5]=z=>m.value.emailconf.email_port=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.emailuser")},{default:a(()=>[e(M,{modelValue:m.value.emailconf.email_user,"onUpdate:modelValue":k[6]||(k[6]=z=>m.value.emailconf.email_user=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.emailpasswd")},{default:a(()=>[e(M,{type:"password","show-password":"",modelValue:m.value.emailconf.email_password,"onUpdate:modelValue":k[7]||(k[7]=z=>m.value.emailconf.email_password=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.emailsender")},{default:a(()=>[e(M,{modelValue:m.value.emailconf.email_sender,"onUpdate:modelValue":k[8]||(k[8]=z=>m.value.emailconf.email_sender=z)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])]),_:1},8,["header"]),e(F,{header:t(l)("app.webui.jwtconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(Z,{disabled:P.value,model:m.value.jwtconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(x,{label:t(l)("app.webui.jwtkey"),required:""},{default:a(()=>[e(M,{modelValue:m.value.jwtconf.jwt_secret,"onUpdate:modelValue":k[10]||(k[10]=z=>m.value.jwtconf.jwt_secret=z)},null,8,["modelValue"])]),_:1},8,["label"]),e(x,{label:t(l)("app.webui.jwtvalidity"),required:""},{default:a(()=>[e(M,{type:"number",modelValue:m.value.jwtconf.jwt_expires,"onUpdate:modelValue":k[11]||(k[11]=z=>m.value.jwtconf.jwt_expires=z)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","model"])]),_:1},8,["header"]),e(F,{header:t(l)("app.webui.noticeconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(Z,{disabled:P.value,model:m.value.noticeconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(x,{label:t(l)("app.webui.noticetype")},{default:a(()=>[e(G,{modelValue:m.value.noticeconf.type,"onUpdate:modelValue":k[12]||(k[12]=z=>m.value.noticeconf.type=z)},{default:a(()=>[(i(!0),A(te,null,ce(g.value,z=>(i(),C(D,{key:z.key,label:z.value,value:z.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(x,{label:"Webhook"},{default:a(()=>[e(M,{modelValue:m.value.noticeconf.webhook,"onUpdate:modelValue":k[13]||(k[13]=z=>m.value.noticeconf.webhook=z)},null,8,["modelValue"])]),_:1}),m.value.noticeconf.type==1?(i(),C(x,{key:0,label:"Secret"},{default:a(()=>[e(M,{type:"password","show-password":"",modelValue:m.value.noticeconf.secret,"onUpdate:modelValue":k[14]||(k[14]=z=>m.value.noticeconf.secret=z)},null,8,["modelValue"])]),_:1})):de("",!0)]),_:1},8,["disabled","model"])]),_:1},8,["header"]),u("div",Za,[P.value?(i(),C(p,{key:0,type:"primary",onClick:k[15]||(k[15]=z=>P.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:1})):(i(),C(p,{key:1,type:"primary",onClick:c},{default:a(()=>[n(o(t(l)("app.webui.save")),1)]),_:1}))])],64)}}}),Ra={style:{"font-weight":"lighter","font-size":"17px"}},Xa={style:{display:"flex","justify-content":"space-around"}},Qa={style:{display:"flex",width:"80%",gap:"1%"}},Oa={key:0},Ya={key:1},Ja={key:2},Wa={key:3},Ka={slot:"footer",class:"dialog-footer"},et={slot:"footer",class:"dialog-footer"},lt=ve({__name:"ScoreRule",setup(ie){const{t:l}=me(),P=w({data:[{id:1,type:1,rule:"XrayNucleiGobyPoc",score:20,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:2,type:1,rule:"XrayNucleiGobyPoc",score:10,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:3,type:1,rule:"PayloadPoc",score:5,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:4,type:2,rule:"XrayNucleiGobyExp",score:30,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:5,type:2,rule:"XrayNucleiGobyExp",score:15,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:6,type:2,rule:"XrayNucleiGobyExp",score:5,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:7,type:3,rule:" 5000",score:30,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"}]});w({});const I=w(""),m=[],g=w(1),h=w(15),c=w(0),v=w(!1),k=w(!1),U=w({}),x=w([{id:1,type:l("app.webui.pocscorerule")},{id:2,type:l("app.webui.exprule")},{id:3,type:l("app.webui.incidencerule")},{id:4,type:l("app.webui.otherrule")}]),M=w(!0),Z=d=>{M.value=d.id,d.length>0?M.value=!1:M.value=!0},F=(d,b)=>{U.value.id=b.id,U.value.type=b.type,U.value.rule=b.rule,U.value.score=b.score,U.value.coefficient=b.coefficient,k.value=!0};function D(d,b){const q=new Date(d.create_time),V=new Date(b.create_time);return q<V?-1:q>V?1:0}const G=Ce(()=>{const b=0+h.value;if(console.log(P.value),I.value.trim()!="")return P.value.data.filter(q=>q.name.toLowerCase().includes(I.value.toLowerCase()));try{return P.value.data.slice(0,b)}catch{return[]}});function p(d){h.value=d,g.value=1,ae()}async function z(d){g.value=d,await ae()}fe(()=>{m.forEach(d=>{d()})});async function ae(){try{const d=await Y.get(`/api/v1/getvulnlist?page=${g.value}&limit=${h.value}`);P.value=d.data,c.value=d.data.total,typefilter.value=d.data.data.reduce((b,q)=>(b.some(V=>V.value===q.vuln_type)||b.push({text:q.vuln_type,value:q.vuln_type}),b),[])}catch{}}function O(){ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{N({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const K=(d,b)=>{ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{N({type:"success",message:l("app.webui.deletecomplete")}),console.log(d,b)}).catch(()=>{})},oe=(d,b)=>b.type===d,ue=()=>{U.value={id:null,type:1,rule:"",score:null,coefficient:1}},W=()=>{console.log(U.value),v.value=!1},$=()=>{console.log(U.value),k.value=!1};return(d,b)=>{const q=ye,V=we,f=ze,R=Se,j=Ue,y=be,X=Le,H=Be,B=qe,le=Ee,Q=Ae;return i(),A(te,null,[u("div",null,[e(y,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",Ra,[u("div",Xa,[u("div",Qa,[e(q,{modelValue:I.value,"onUpdate:modelValue":b[0]||(b[0]=r=>I.value=r),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(V,{type:"primary",onClick:b[1]||(b[1]=r=>v.value=!0)},{default:a(()=>[n(o(t(l)("app.webui.add")),1)]),_:1}),e(V,{disabled:M.value,type:"danger",onClick:O},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(R,{data:G.value,onSelectionChange:Z},{default:a(()=>[e(f,{type:"selection",width:"55"}),e(f,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"80"},null,8,["label"]),e(f,{label:t(l)("app.webui.type"),filters:[{text:t(l)("app.webui.pocscorerule"),value:1},{text:t(l)("app.webui.exprule"),value:2},{text:t(l)("app.webui.incidencerule"),value:3},{text:t(l)("app.webui.otherrule"),value:4}],"filter-method":oe,width:"140"},{default:a(({row:r})=>[r.type==1?(i(),A("span",Oa,o(t(l)("app.webui.pocscorerule")),1)):r.type==2?(i(),A("span",Ya,o(t(l)("app.webui.exprule")),1)):r.type==3?(i(),A("span",Ja,o(t(l)("app.webui.incidencerule")),1)):(i(),A("span",Wa,o(t(l)("app.webui.otherrule")),1))]),_:1},8,["label","filters"]),e(f,{prop:"rule",label:t(l)("app.webui.scorerule")},null,8,["label"]),e(f,{prop:"score",label:t(l)("app.webui.score"),width:"120"},null,8,["label"]),e(f,{prop:"coefficient",label:t(l)("app.webui.coefficient"),width:"120"},null,8,["label"]),e(f,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":D,width:"140"},{default:a(({row:r})=>[u("span",null,o(t(se)(r.create_time)),1)]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":D,width:"140"},{default:a(({row:r})=>[u("span",null,o(t(se)(r.update_time)),1)]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.operate"),width:"140"},{default:a(r=>[e(V,{size:"small",type:"primary",onClick:s=>F(r.$index,r.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(V,{size:"small",type:"danger",onClick:s=>K(r.$index,r.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(j,{"page-sizes":[15,25,50,100,200,300],"page-size":h.value,"onUpdate:pageSize":b[2]||(b[2]=r=>h.value=r),layout:"total, sizes, prev, pager, next, jumper",total:c.value,onSizeChange:p,onCurrentChange:z,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(Q,{title:t(l)("app.webui.addscore"),modelValue:v.value,"onUpdate:modelValue":b[8]||(b[8]=r=>v.value=r),width:"30%",onClose:ue},{default:a(()=>[e(le,{model:U.value,"label-width":"100px"},{default:a(()=>[e(B,{label:t(l)("app.webui.type")},{default:a(()=>[e(H,{modelValue:U.value.type,"onUpdate:modelValue":b[3]||(b[3]=r=>U.value.type=r),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(i(!0),A(te,null,ce(x.value,r=>(i(),C(X,{key:r.id,label:r.type,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(q,{modelValue:U.value.rule,"onUpdate:modelValue":b[4]||(b[4]=r=>U.value.rule=r),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.score")},{default:a(()=>[e(q,{modelValue:U.value.score,"onUpdate:modelValue":b[5]||(b[5]=r=>U.value.score=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(q,{modelValue:U.value.coefficient,"onUpdate:modelValue":b[6]||(b[6]=r=>U.value.coefficient=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",Ka,[e(V,{onClick:b[7]||(b[7]=r=>v.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(V,{type:"primary",onClick:W},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(Q,{title:t(l)("app.webui.editscore"),modelValue:k.value,"onUpdate:modelValue":b[14]||(b[14]=r=>k.value=r),width:"30%",onClose:ue},{default:a(()=>[e(le,{model:U.value,"label-width":"100px"},{default:a(()=>[e(B,{label:t(l)("app.webui.type")},{default:a(()=>[e(H,{modelValue:U.value.type,"onUpdate:modelValue":b[9]||(b[9]=r=>U.value.type=r),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(i(!0),A(te,null,ce(x.value,r=>(i(),C(X,{key:r.id,label:r.type,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(q,{modelValue:U.value.rule,"onUpdate:modelValue":b[10]||(b[10]=r=>U.value.rule=r),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.score")},{default:a(()=>[e(q,{modelValue:U.value.score,"onUpdate:modelValue":b[11]||(b[11]=r=>U.value.score=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(q,{modelValue:U.value.coefficient,"onUpdate:modelValue":b[12]||(b[12]=r=>U.value.coefficient=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",et,[e(V,{onClick:b[13]||(b[13]=r=>k.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(V,{type:"primary",onClick:$},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),at=Ve(lt,[["__scopeId","data-v-2d458d15"]]),tt={style:{"font-weight":"lighter","font-size":"17px"}},ot={style:{display:"flex","justify-content":"space-around"}},ut={style:{display:"flex",width:"80%",gap:"1%"}},nt={slot:"footer",class:"dialog-footer"},st={slot:"footer",class:"dialog-footer"},it=ve({__name:"VulnType",setup(ie){const{t:l}=me(),P=w({}),I=w(""),m=w(sessionStorage.getItem("token")),g=[O],h=w(1),c=w(15),v=w(0),k=w(!1),U=w(!1),x=w({}),M=w(!0),Z=$=>{M.value=$.id,$.length>0?M.value=!1:M.value=!0},F=($,d)=>{x.value.id=d.id,x.value.name=d.name,U.value=!0},D=()=>{x.value.id=null,x.value.name=""};function G($,d){const b=new Date($.create_time),q=new Date(d.create_time);return b<q?-1:b>q?1:0}const p=Ce(()=>{const d=0+c.value;if(console.log(P.value),I.value.trim()!="")return P.value.data.filter(b=>b.name.toLowerCase().includes(I.value.toLowerCase()));try{return P.value.data.slice(0,d)}catch{return[]}});function z($){c.value=$,h.value=1,O()}async function ae($){h.value=$,await O()}fe(()=>{g.forEach($=>{$()})});async function O(){console.log(P.value);try{const $=await Y.get(`/api/v1/getvulntype?page=${h.value}&limit=${c.value}`);P.value=$.data,v.value=$.data.total,console.log(P.value)}catch{}}function K(){ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{N({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const oe=($,d)=>{ge.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{N({type:"success",message:l("app.webui.deletecomplete")}),console.log($,d)}).catch(()=>{})};async function ue(){console.log(x.value);try{const $={headers:{Authorization:"Bearer "+m.value}},d=await Y.post("/api/v1/addvulntype",x.value,$);if(console.log(d),d.data.code==1){N({type:"success",message:l("app.webui.addsuccess")}),O(),k.value=!1;return}else if(d.data.code==2){N({type:"error",message:l("app.webui.invalidinput")});return}else if(d.data.code==3){N({type:"error",message:l("app.webui.addfail")});return}}catch{}}const W=()=>{console.log(x.value);try{const $={headers:{Authorization:"Bearer "+m.value}},d=Y.post("/api/v1/updatevulntype",x.value,$);if(console.log(d),d.data.code==1){N({type:"success",message:l("app.webui.modifysucc")}),O(),U.value=!1;return}else if(d.data.code==2){N({type:"error",message:l("app.webui.invalidinput")});return}else if(d.data.code==3){N({type:"error",message:l("app.webui.modifyfail")});return}}catch{}};return($,d)=>{const b=ye,q=we,V=ze,f=Se,R=Ue,j=be,y=qe,X=Ee,H=Ae;return i(),A(te,null,[u("div",null,[e(j,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",tt,[u("div",ot,[u("div",ut,[e(b,{modelValue:I.value,"onUpdate:modelValue":d[0]||(d[0]=B=>I.value=B),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(q,{type:"primary",onClick:d[1]||(d[1]=B=>k.value=!0)},{default:a(()=>[n(o(t(l)("app.webui.add")),1)]),_:1}),e(q,{disabled:M.value,type:"danger",onClick:K},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(f,{data:p.value,onSelectionChange:Z},{default:a(()=>[e(V,{type:"selection",width:"55"}),e(V,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(V,{prop:"name",label:t(l)("app.webui.name")},null,8,["label"]),e(V,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":G},{default:a(({row:B})=>[u("span",null,o(t(se)(B.create_time)),1)]),_:1},8,["label"]),e(V,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":G},{default:a(({row:B})=>[u("span",null,o(t(se)(B.update_time)),1)]),_:1},8,["label"]),e(V,{label:t(l)("app.webui.operate")},{default:a(B=>[e(q,{size:"small",type:"primary",onClick:le=>F(B.$index,B.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(q,{size:"small",type:"danger",onClick:le=>oe(B.$index,B.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(R,{"page-sizes":[15,25,50,100,200,300],"page-size":c.value,"onUpdate:pageSize":d[2]||(d[2]=B=>c.value=B),layout:"total, sizes, prev, pager, next, jumper",total:v.value,onSizeChange:z,onCurrentChange:ae,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(H,{title:t(l)("app.webui.addvulntype"),modelValue:k.value,"onUpdate:modelValue":d[5]||(d[5]=B=>k.value=B),width:"30%",onClose:D},{default:a(()=>[e(X,{model:x.value,"label-width":"100px"},{default:a(()=>[e(y,{label:t(l)("app.webui.name")},{default:a(()=>[e(b,{modelValue:x.value.name,"onUpdate:modelValue":d[3]||(d[3]=B=>x.value.name=B),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",nt,[e(q,{onClick:d[4]||(d[4]=B=>k.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(q,{type:"primary",onClick:ue},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(H,{title:t(l)("app.webui.editvulntype"),modelValue:U.value,"onUpdate:modelValue":d[9]||(d[9]=B=>U.value=B),width:"30%",onClose:D},{default:a(()=>[e(X,{model:x.value,"label-width":"100px"},{default:a(()=>[e(y,{label:t(l)("app.webui.id")},{default:a(()=>[e(b,{modelValue:x.value.id,"onUpdate:modelValue":d[6]||(d[6]=B=>x.value.id=B),autocomplete:"off",disabled:"true"},null,8,["modelValue"])]),_:1},8,["label"]),e(y,{label:t(l)("app.webui.name")},{default:a(()=>[e(b,{modelValue:x.value.name,"onUpdate:modelValue":d[7]||(d[7]=B=>x.value.name=B),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",st,[e(q,{onClick:d[8]||(d[8]=B=>U.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(q,{type:"primary",onClick:W},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),dt=Ve(it,[["__scopeId","data-v-dfdc742a"]]),pt={style:{display:"flex"}},rt={style:{"margin-top":"20px","font-size":"14px"}},ct={style:{"margin-top":"20px","font-size":"14px"}},vt={style:{"margin-top":"20px","font-size":"14px"}},mt=ve({__name:"Profile",setup(ie){const{t:l}=me(),P=sessionStorage.getItem("token"),I=w({}),m=w(!0),g=[c],h=w(sessionStorage.getItem("avatar"));fe(()=>{g.forEach(F=>{F()})});async function c(){try{const F={headers:{Authorization:`Bearer ${P}`}},D=await Y.get("/api/v1/userinfo",F);I.value=D.data.data,P&&D.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload())}catch{}}const v=F=>{h.value=URL.createObjectURL(F)},k=F=>{N.success(l("app.webui.uploadsucc")),sessionStorage.setItem("avatar","/download/file?id="+F.data),location.reload()},U=()=>{if(!I.value.email.match(/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)){N.error(l("app.webui.emailformat"));return}M()},x=()=>{if(!I.value.phone.match(/^[1][3,4,5,6,7,8,9][0-9]{9}$/)){N.error(l("app.webui.phoneformat"));return}M()},M=()=>{m.value=!1},Z=async()=>{console.log(I.value);try{const F={headers:{Authorization:`Bearer ${P}`}},D={username:I.value.username,email:I.value.email,phone:I.value.phone},G=await Y.post("/api/v1/updateuserinfo",D,F);G.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):G.data.code==1?N.success(l("app.webui.modifysucc")):N.error(l("app.webui.modifyerr"))}catch(F){console.error(F)}};return(F,D)=>{const G=Re,p=Ge,z=ye,ae=we,O=be;return i(),A("div",null,[e(O,{style:{padding:"30px"},header:t(l)("app.webui.myprofile")},{default:a(()=>[u("div",pt,[e(p,{accept:".png,.jpg",action:"/api/v1/updateavatar","on-success":k,headers:{Authorization:`Bearer ${t(P)}`},"before-upload":v},{default:a(()=>[e(G,{size:"large",src:h.value},null,8,["src"])]),_:1},8,["headers"])]),u("div",rt,o(t(l)("app.webui.username")),1),e(z,{modelValue:I.value.username,"onUpdate:modelValue":D[0]||(D[0]=K=>I.value.username=K),size:"large",placeholder:I.value.username,style:{"margin-top":"10px"},onChange:M},null,8,["modelValue","placeholder"]),u("div",ct,o(t(l)("app.webui.email")),1),e(z,{modelValue:I.value.email,"onUpdate:modelValue":D[1]||(D[1]=K=>I.value.email=K),size:"large",placeholder:I.value.email,style:{"margin-top":"10px"},onChange:U},null,8,["modelValue","placeholder"]),u("div",vt,o(t(l)("app.webui.phone")),1),e(z,{modelValue:I.value.phone,"onUpdate:modelValue":D[2]||(D[2]=K=>I.value.phone=K),size:"large",placeholder:I.value.phone,style:{"margin-top":"10px"},onChange:x},null,8,["modelValue","placeholder"]),e(ae,{type:"primary",style:{"margin-top":"20px"},disabled:m.value,onClick:Z},{default:a(()=>[n(o(t(l)("app.webui.modify")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}}),ft={style:{"margin-top":"20px","font-size":"14px"}},bt={style:{"margin-top":"20px","font-size":"14px"}},_t={style:{"margin-top":"20px","font-size":"14px"}},yt=ve({__name:"Modifypasswd",setup(ie){const{t:l}=me(),P=w(!0),I=sessionStorage.getItem("token"),m=w(""),g=w(""),h=w(""),c=()=>g.value.length<8?(N.error(l("app.webui.passwordlength")),!1):g.value.match(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,}$/)?!0:(N.error(l("app.webui.passwordcomplex")),!1),v=()=>{if(g.value!=h.value){N.error(l("app.webui.passwordnotmatch"));return}c()&&k()},k=()=>{P.value=!1};async function U(){console.log(m,g,h);try{const x={headers:{Authorization:`Bearer ${I}`}},M={oldpassword:m.value,newpassword:g.value},Z=await Y.post("/api/v1/updatepassword",M,x);Z.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):Z.data.code==1?N.success(l("app.webui.modifysucc")):Z.data.code==3?N.error(l("app.webui.oldpassworderr")):N.error(l("app.webui.modifyerr"))}catch{N.error(l("app.webui.modifyfail"))}}return(x,M)=>{const Z=ye,F=we,D=be;return i(),A("div",null,[e(D,{style:{padding:"30px"},header:t(l)("app.webui.alterpwd")},{default:a(()=>[u("div",ft,o(t(l)("app.webui.oldpassword")),1),e(Z,{modelValue:m.value,"onUpdate:modelValue":M[0]||(M[0]=G=>m.value=G),size:"large",placeholder:m.value,style:{"margin-top":"10px"},type:"password","show-password":""},null,8,["modelValue","placeholder"]),u("div",bt,o(t(l)("app.webui.newpassword")),1),e(Z,{modelValue:g.value,"onUpdate:modelValue":M[1]||(M[1]=G=>g.value=G),size:"large",placeholder:g.value,style:{"margin-top":"10px"},type:"password","show-password":"",onChange:c},null,8,["modelValue","placeholder"]),u("div",_t,o(t(l)("app.webui.confirmpassword")),1),e(Z,{modelValue:h.value,"onUpdate:modelValue":M[2]||(M[2]=G=>h.value=G),size:"large",placeholder:h.value,style:{"margin-top":"10px"},type:"password","show-password":"",onChange:v},null,8,["modelValue","placeholder"]),e(F,{type:"primary",disabled:P.value,style:{"margin-top":"20px"},onClick:U},{default:a(()=>[n(o(t(l)("app.webui.submit")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}}),wt={style:{cursor:"pointer","margin-left":"auto"}},ht={style:{display:"flex","align-items":"center"}},gt={style:{display:"flex",margin:"auto",cursor:"pointer"}},Vt={key:0},xt={key:1},kt={key:2},$t={key:3},Ct={key:4},zt={key:5},St={key:6},Ut={key:7},qt={key:8},Et={key:9},It=ve({__name:"Index",setup(ie){const{t:l,locale:P}=me(),I=w(!1),m=w(!1),g=p=>{P.value=p,localStorage.setItem("selectedLanguage",p),v.value="1"},h=sessionStorage.getItem("username"),c=sessionStorage.getItem("avatar"),v=w("1"),k=w(!1),U=sessionStorage.getItem("token");function x(){k.value=!k.value}function M(p){v.value=p}const Z=ul();fe(F);function F(){U||Z.push("/login")}function D(p){p==1&&(v.value="",m.value=!1,I.value=!0),p==2&&(v.value="",I.value=!1,m.value=!0),p==3&&G()}async function G(){try{const p={headers:{Authorization:`Bearer ${U}`}},z=await Y.get("/api/v1/logout",p);sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("avatar"),location.reload()}catch{}}return(p,z)=>{const ae=Re,O=vl,K=ml,oe=fl,ue=bl,W=Ie,$=_l,d=yl,b=wl,q=hl,V=nl;return i(),A("div",null,[e(V,{style:{width:"100%"}},{default:a(()=>[e(ue,{style:{"background-color":"#393939",display:"flex","justify-content":"flex-end","align-items":"center",padding:"10px"}},{default:a(()=>[z[2]||(z[2]=u("div",{style:{display:"flex","justify-content":"center","align-items":"center",color:"#fff"}},[u("img",{src:gl,fit:"contain",style:{"margin-left":"1vw",height:"50px",width:"50px"}}),u("span",{style:{"margin-left":"1vw"}},"")],-1)),u("div",wt,[e(oe,{style:{color:"#fff"},trigger:"click",onCommand:D},{dropdown:a(()=>[e(K,null,{default:a(()=>[e(O,{command:"1"},{default:a(()=>[n(o(t(l)("app.webui.myprofile")),1)]),_:1}),e(O,{command:"2"},{default:a(()=>[n(o(t(l)("app.webui.alterpwd")),1)]),_:1}),e(O,{command:"3"},{default:a(()=>[n(o(t(l)("app.webui.logout")),1)]),_:1})]),_:1})]),default:a(()=>[u("span",ht,[e(ae,{style:{"margin-right":"10px"},src:t(c)},null,8,["src"]),n(" "+o(t(h)),1)])]),_:1})])]),_:1}),e(V,{style:{width:"100%"}},{default:a(()=>[e(b,{collapse:k.value,class:"el-menu-vertical-demo",onSelect:M},{default:a(()=>[e($,{index:"1",style:{"margin-top":"2vh"}},{default:a(()=>[e(W,null,{default:a(()=>[e(t(sl))]),_:1}),u("span",null,o(t(l)("app.webui.dashboard")),1)]),_:1}),e($,{index:"2"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(il))]),_:1}),u("span",null,o(t(l)("app.webui.systemsetting")),1)]),_:1}),e($,{index:"3"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(dl))]),_:1}),u("span",null,o(t(l)("app.webui.usermanager")),1)]),_:1}),e(d,{index:"4"},{title:a(()=>[e(W,null,{default:a(()=>z[3]||(z[3]=[u("svg",{t:"1728359731855",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1480",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"1481",fill:"#515151"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"1482",fill:"#515151"})],-1)])),_:1}),u("span",null,o(t(l)("app.webui.vulnmanager")),1)]),default:a(()=>[e($,{index:"4-1"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.vulntype")),1)]),_:1}),e($,{index:"4-2"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.allvuln")),1)]),_:1}),e($,{index:"4-3"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.unaudit")),1)]),_:1}),e($,{index:"4-4"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.audited")),1)]),_:1})]),_:1}),e($,{index:"5"},{default:a(()=>[e(W,null,{default:a(()=>[e(t(pl))]),_:1}),u("span",null,o(t(l)("app.webui.scorerule")),1)]),_:1}),e(d,{index:"6"},{title:a(()=>[z[4]||(z[4]=u("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em","data-v-f414ea64":"",class:"el-icon"},[u("path",{fill:"currentColor",d:"m18.5 10l4.4 11h-2.155l-1.201-3h-4.09l-1.199 3h-2.154L16.5 10h2zM10 2v2h6v2h-1.968a18.222 18.222 0 0 1-3.62 6.301a14.864 14.864 0 0 0 2.336 1.707l-.751 1.878A17.015 17.015 0 0 1 9 13.725a16.676 16.676 0 0 1-6.201 3.548l-.536-1.929a14.7 14.7 0 0 0 5.327-3.042A18.078 18.078 0 0 1 4.767 8h2.24A16.032 16.032 0 0 0 9 10.877a16.165 16.165 0 0 0 2.91-4.876L2 6V4h6V2h2zm7.5 10.885L16.253 16h2.492L17.5 12.885z"})],-1)),u("span",null,o(t(l)("app.webui.language")),1)]),default:a(()=>[e($,{index:"11-1",onClick:z[0]||(z[0]=f=>g("zh-CN"))},{default:a(()=>z[5]||(z[5]=[n("")])),_:1}),e($,{index:"11-2",onClick:z[1]||(z[1]=f=>g("en-US"))},{default:a(()=>z[6]||(z[6]=[n("English")])),_:1})]),_:1}),u("div",gt,[k.value?(i(),C(W,{key:1,onClick:x,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(cl))]),_:1})):(i(),C(W,{key:0,onClick:x,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(rl))]),_:1}))])]),_:1},8,["collapse"]),e(q,null,{default:a(()=>[v.value==="1"?(i(),A("div",Vt,[e(Ul)])):v.value==="2"?(i(),A("div",xt,[e(Ga)])):v.value==="3"?(i(),A("div",kt,[e(Dl)])):v.value==="4-1"?(i(),A("div",$t,[e(dt)])):v.value==="4-2"?(i(),A("div",Ct,[e(na)])):v.value==="4-3"?(i(),A("div",zt,[e($a)])):v.value==="4-4"?(i(),A("div",St,[e(Na)])):v.value==="5"?(i(),A("div",Ut,[e(at)])):I.value?(i(),A("div",qt,[e(mt)])):m.value?(i(),A("div",Et,[e(yt)])):de("",!0)]),_:1})]),_:1})]),_:1})])}}}),Mt=Ve(It,[["__scopeId","data-v-9461eefe"]]);export{Mt as default};
