import{d as de,u as pe,a as Je,r as g,o as re,b as p,c as L,e as u,f as e,w as a,t as o,g as t,F as le,E as We,h as ce,i as Ce,j as Ke,k as el,l as ll,m as ge,n as s,p as S,q as se,s as fe,v as P,x as be,y as _e,z as Ve,A as Be,B as xe,C as ke,D as $e,G as ze,H as Se,I as Me,J as He,K as Ue,_ as ye,L as al,M as qe,N as he,O as tl,P as ol,Q as Ze,R as je,S as De,T as Ae,U as Ge,V as ul,W as nl,X as il,Y as sl,Z as dl,$ as Ee,a0 as pl,a1 as rl,a2 as cl,a3 as vl,a4 as ml,a5 as fl,a6 as bl,a7 as _l,a8 as yl,a9 as wl,aa as hl}from"./index-TQ5iY1BV.js";import{a as O}from"./el-message-ZkJEpQUo.js";const gl="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='37.07'%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20198'%3e%3cpath%20fill='%2341B883'%20d='M204.8%200H256L128%20220.8L0%200h97.92L128%2051.2L157.44%200h47.36Z'%3e%3c/path%3e%3cpath%20fill='%2341B883'%20d='m0%200l128%20220.8L256%200h-51.2L128%20132.48L50.56%200H0Z'%3e%3c/path%3e%3cpath%20fill='%2335495E'%20d='M50.56%200L128%20133.12L204.8%200h-47.36L128%2051.2L97.92%200H50.56Z'%3e%3c/path%3e%3c/svg%3e",Vl={style:{display:"flex","justify-content":"center"}},xl={style:{display:"flex","justify-content":"center"}},kl={style:{display:"flex","justify-content":"center"}},Cl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},$l={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},zl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Sl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Ul=de({__name:"Dashboard",setup(ne){const{t:l}=pe(),j=Je(),E=g({}),_=g({}),x=[{color:"#20a53a",percentage:30},{color:"orange",percentage:60},{color:"red",percentage:100}],V=[k,y];let b=setInterval(y,3e3);re(()=>{V.forEach(U=>{U()})});async function y(){const U=sessionStorage.getItem("token");try{const C={headers:{Authorization:`Bearer ${U}`}},M=await O.get("/api/v1/getsystemstatus",C);M.data.code!=1&&(clearInterval(b),sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),j.push("/login")),E.value=M.data.data}catch{}}async function k(){try{const U=await O.get("/api/v1/getvulnabs");_.value=U.data}catch{}}return(U,C)=>{const M=We,Z=ce,H=Ce,q=Ke,A=el,m=ll;return p(),L(le,null,[u("div",null,[e(Z,{style:{"margin-top":"1%"},header:t(l)("app.webui.systemstatus"),"body-style":"display: flex; justify-content: space-around;"},{default:a(()=>[u("div",null,[u("span",Vl,o(t(l)("app.webui.cpuuse")),1),e(M,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:E.value.cpu,color:x},null,8,["percentage"])]),u("div",null,[u("span",xl,o(t(l)("app.webui.ramuse")),1),e(M,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:E.value.mem,color:x},null,8,["percentage"])]),u("div",null,[u("span",kl,o(t(l)("app.webui.diskuse")),1),e(M,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:E.value.disk,color:x},null,8,["percentage"])])]),_:1},8,["header"]),e(Z,{header:t(l)("app.webui.vulnstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(q,{justify:"start"},{default:a(()=>[e(Z,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalvuln")),1),e(H,{size:"25"},{default:a(()=>C[0]||(C[0]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:_.value.total},null,8,["value"]),u("div",Cl,[u("span",null,o(t(l)("app.webui.weeklyadditions")),1),u("span",null,o(_.value.weeklyAdditionsVuln),1)])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalpoc")),1),e(H,{size:"25"},{default:a(()=>C[1]||(C[1]=[u("svg",{t:"1727429978264",class:"icon",viewBox:"0 0 1161 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"20805",width:"200",height:"200"},[u("path",{d:"M258.205538 354.461538c10.436923 0 18.924308 8.467692 18.924308 18.944v624.836924c0 10.456615-8.467692 18.944-18.924308 18.944H177.289846a18.944 18.944 0 0 1-18.924308-18.944v-624.836924c0-10.476308 8.467692-18.944 18.924308-18.944h80.915692z m158.365539 120.497231c10.436923 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944h-80.915692a18.944 18.944 0 0 1-18.924308-18.944V493.883077c0-10.436923 8.467692-18.924308 18.924308-18.924308h80.915692z m-316.731077 0c10.456615 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944H18.944A18.944 18.944 0 0 1 0 998.242462V493.883077c0-10.436923 8.467692-18.924308 18.944-18.924308H99.84z m139.421538-82.628923H196.214154v586.988308h43.047384V392.329846z m158.365539 120.477539h-43.027692V979.298462h43.027692V512.787692z m-316.731077 0H37.868308V979.298462h43.027692V512.787692zM1063.384615 0a98.461538 98.461538 0 0 1 98.461539 98.461538v748.307693a98.461538 98.461538 0 0 1-98.461539 98.461538H492.307692V433.230769a39.384615 39.384615 0 0 0-36.430769-39.286154L452.923077 393.846154h-98.461539v-59.076923a39.384615 39.384615 0 0 0-36.430769-39.286154L315.076923 295.384615h-98.461538V98.461538a98.461538 98.461538 0 0 1 98.461538-98.461538h748.307692z m-142.867692 520.664615c-44.898462 0-78.769231 14.572308-102.4 44.504616-21.267692 26.387692-31.507692 60.258462-31.507692 102.006154 0 42.535385 9.846154 76.406154 30.326154 101.612307 23.236923 29.144615 57.895385 44.110769 103.975384 44.11077 30.326154 0 56.32-8.664615 77.981539-25.993847 23.236923-18.510769 37.809231-44.110769 44.110769-76.8h-41.747692l-1.476923 5.395693c-5.710769 19.377231-15.064615 34.126769-28.061539 44.228923-13.390769 10.24-30.72 15.36-51.2 15.36-31.507692 0-54.744615-9.846154-69.710769-29.538462-14.178462-18.510769-21.267692-44.504615-21.267692-78.375384 0-32.689231 7.089231-58.683077 21.661538-77.587693 15.36-20.873846 38.203077-31.113846 68.529231-31.113846 20.48 0 37.021538 4.332308 50.412307 13.390769 13.390769 9.058462 22.449231 23.236923 27.175385 42.141539h41.747692l-0.984615-5.592616c-5.060923-25.796923-17.329231-46.710154-36.430769-62.148923-21.267692-17.329231-48.443077-25.6-81.132308-25.6z m-30.956308-413.538461c-42.929231 0-76.8 13.784615-101.218461 42.141538-23.630769 26.781538-35.052308 61.44-35.052308 104.369231 0 42.535385 11.421538 77.193846 35.052308 103.975385 24.418462 27.569231 58.289231 41.747692 101.218461 41.747692 42.535385 0 76.406154-13.784615 101.218462-41.353846 23.630769-26.781538 35.446154-61.44 35.446154-104.369231 0-43.323077-11.815385-78.375385-35.446154-104.763077-24.812308-27.963077-58.683077-41.747692-101.218462-41.747692z m-292.489846 5.513846H480.492308V393.846154h42.92923v-109.489231h72.861539l5.395692-0.059077c63.763692-1.516308 95.822769-30.247385 95.822769-86.193231 0-57.107692-33.476923-85.464615-100.430769-85.464615z m292.470154 32.295385c29.932308 0 53.169231 9.452308 69.316923 29.144615 15.753846 19.298462 24.024615 45.686154 24.024616 79.556923 0 33.476923-8.270769 59.864615-24.024616 78.769231-16.147692 19.298462-39.384615 29.144615-69.316923 29.144615s-53.169231-10.24-69.710769-29.932307c-15.753846-19.298462-23.630769-45.292308-23.630769-77.981539 0-33.083077 7.876923-59.076923 23.630769-78.375385 16.541538-20.48 39.778462-30.326154 69.710769-30.326153z m-296.014769 4.332307c20.873846 0 36.233846 3.938462 46.08 11.815385 9.846154 7.089231 14.966154 19.692308 14.966154 37.021538 0 17.329231-5.12 29.932308-14.572308 37.809231-9.846154 7.876923-25.206154 11.815385-46.473846 11.815385h-70.104616v-98.461539z","p-id":"20806",fill:"#ed5565"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:_.value.hasPoc},null,8,["value"]),u("div",$l,[u("span",null,o(t(l)("app.webui.weeklyadditionspoc")),1),u("span",null,o(_.value.weeklyAdditionsPoc),1)])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalexp")),1),e(H,{size:"25"},{default:a(()=>C[2]||(C[2]=[u("svg",{t:"1727429727880",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13778",width:"200",height:"200"},[u("path",{d:"M676.408889 303.407407l-101.262222-175.976296c-132.437333-40.201481-114.801778 130.085926-203.207111 168.846222L303.407407 246.708148C347.477333 160.274963 387.337481 83.057778 429.283556 0h206.582518L758.518519 235.747556 676.408889 303.407407zM127.393185 493.037037l80.327111 61.477926c-28.899556 61.060741-55.48563 117.380741-82.223407 173.018074 29.430519 138.657185 149.238519 47.824593 215.836444 103.917037V910.222222H94.966519L0 735.156148 127.393185 493.037037zM1024 735.004444L925.999407 910.222222H682.666667v-79.568592c68.342519-48.279704 171.956148 24.045037 212.574814-97.583408l-83.133629-184.395852L895.089778 493.037037 1024 735.004444zM0 387.640889L101.793185 189.62963 303.407407 422.874074l-12.818963 32.237037L0 387.640889zM1024 358.362074L739.745185 417.185185 720.592593 392.836741 919.210667 189.62963 1024 358.362074zM417.185185 1024l80.402963-263.661037 26.699852-1.820444L606.814815 1024h-189.62963z",fill:"#1296db","p-id":"13779"}),u("path",{d:"M606.814815 455.111111h-189.62963v-75.851852h189.62963v75.851852zM682.666667 568.888889H341.333333v-75.851852h341.333334v75.851852zM796.444444 682.666667H227.555556v-75.851852h568.888888v75.851852z",fill:"#1296db","p-id":"13780"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:_.value.hasExp},null,8,["value"]),u("div",zl,[u("span",null,o(t(l)("app.webui.weeklyadditionsexp")),1),u("span",null,o(_.value.weeklyAdditionsExp),1)])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalproduct")),1),e(H,{size:"25"},{default:a(()=>C[3]||(C[3]=[u("svg",{t:"1727429889519",class:"icon",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17925",width:"200",height:"200"},[u("path",{d:"M302.32811 504.78l-146.944-88.063c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048zM459.00011 1020.878c5.888 1.792 12.544 1.28 18.688-2.304-5.632 3.072-12.288 4.096-18.688 2.304zM302.32811 504.78l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z",fill:"#3CBF71","p-id":"17926"}),u("path",{d:"M477.68811 1018.547c-6.144 3.584-12.8 4.096-18.688 2.304 6.4 1.818 13.056 0.794 18.688-2.304z",fill:"#3CBF71","p-id":"17927"}),u("path",{d:"M490.64111 954.112V511.744L880.27311 290.56l39.885-24.166c7.987-5.197 9.498-11.802 10.547-16.538 1.024-9.728-3.584-19.968-13.568-25.088L476.81711 4.608c-7.168-3.584-15.36-3.584-22.528 0L13.97011 224.768C-2.41489 235.52 0.14511 259.328 0.14511 261.888v469.76c0 8.704 4.608 16.896 12.032 21.504 0 0 430.848 260.352 438.272 263.68 15.104 7.424 24.576 5.376 31.744 1.792l143.36-82.944a25.56 25.56 0 0 0 9.216-35.072c-6.912-12.288-22.784-16.384-34.816-9.472l-99.072 57.6v-0.256l-10.24 5.632m-50.176-442.368v441.088l-390.4-235.264v-427.52l390.4 221.696z m25.088-43.52L78.22511 248.576 465.55311 55.04l387.328 193.536-387.328 219.648z",fill:"#3CBF71","p-id":"17928"}),u("path",{d:"M812.94511 917.376l201.984-121.344c5.632-3.584 9.216-9.728 9.216-16.64V556.928c0-7.834-5.888-13.312-12.288-16.384l-5.12-2.56c-0.512-0.256-1.28-0.256-1.792-0.256h1.536L810.13011 439.68c-5.376-2.56-11.776-2.56-17.152 0l-196.096 98.048c-14.336 5.504-17.92 17.792-17.92 24.704v216.96c0 6.912 3.584 13.056 9.472 16.64 0 0 200.167 120.09 201.19 120.346 0 0.025 11.93 8.857 23.322 0.998z m-30.464-49.152l-165.12-99.584V589.696l165.12 93.44v185.088z m19.2-218.112L640.65711 558.72l161.024-80.384L962.45011 558.72l-160.768 91.392zM985.74511 768.64l-164.864 99.328V683.136l164.864-93.44V768.64z",fill:"#3CBF71","p-id":"17929"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:_.value.affectedProduct},null,8,["value"]),u("div",Sl,[u("span",null,o(t(l)("app.webui.weeklyadditionsproduct")),1),u("span",null,o(_.value.weeklyAdditionsProduct),1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])]),e(Z,{header:t(l)("app.webui.userstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(q,{justify:"start"},{default:a(()=>[e(Z,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totaladmin")),1)]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:E.value.admintotal},null,8,["value"])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totaluser")),1)]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:E.value.usertotal},null,8,["value"])]),_:1})]),_:1}),e(Z,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.onlineuser")),1)]),_:1})]),default:a(()=>[e(m,null,{default:a(()=>[e(A,{value:E.value.onlineuser},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])],64)}}});function ue(ne){const l=new Date(ne),j=l.getFullYear(),E=(l.getMonth()+1).toString().padStart(2,"0"),_=l.getDate().toString().padStart(2,"0");return`${j}-${E}-${_}`}const ql={style:{"font-weight":"lighter","font-size":"17px"}},El={style:{display:"flex","justify-content":"space-around"}},Bl={style:{display:"flex",width:"80%",gap:"1%"}},Il={key:0},Ll={key:1},Ml={class:"status"},Hl={slot:"footer",class:"dialog-footer"},jl={slot:"footer",class:"dialog-footer"},Dl=de({__name:"Userlist",setup(ne){const{t:l}=pe(),j=g({}),E=g([{id:1,label:l("app.webui.admin")},{id:0,label:l("app.webui.user")}]),_=g(""),x=sessionStorage.getItem("token"),V=g(!1),b=g(!1),y=g({}),k=[G],U=g(1),C=g(15),M=g(0),Z=g([]),H=g(!0),q=g(""),A=f=>{Z.value=f,f.length>0?H.value=!1:H.value=!0},m=ge(()=>{const r=0+C.value;if(_.value.trim()!="")return j.value.data.filter(T=>T.username.toLowerCase().includes(_.value.toLowerCase())||T.email.toLowerCase().includes(_.value.toLowerCase())||T.phone.includes(_.value));try{return j.value.data.slice(0,r)}catch{return[]}});function I(f){C.value=f,U.value=1,G()}async function K(f){U.value=f,await G()}re(()=>{k.forEach(f=>{f()})});async function G(){try{const f={headers:{Authorization:`Bearer ${x}`}},r=await O.get(`/api/v1/getusers?page=${U.value}&limit=${C.value}`,f);r.data.code!=1&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username")),j.value=r.data,M.value=r.data.total}catch{}}function Q(){fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const f={ids:Z.value.map(r=>r.id)};try{const r={headers:{Authorization:`Bearer ${x}`}},T=await O.post("/api/v1/multideleteusers",f,r);T.data.code==1?(G(),P.success(l("app.webui.deletecomplete"))):T.data.code==0?P.error(l("app.webui.needlogin")):P.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})}const ee=(f,r)=>{console.log("xxx",r),y.value.id=r.id,y.value.role=r.role,y.value.username=r.username,y.value.password=r.password,y.value.email=r.email,y.value.phone=r.phone,y.value.status=r.status==1,b.value=!0},ae=(f,r)=>r.role===f,oe=(f,r)=>r.status===f,z=(f,r)=>{fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{console.log(JSON.stringify({id:r.id}));try{const T={headers:{Authorization:`Bearer ${x}`}},R=await O.post("/api/v1/deluser",{userid:r.id},T);R.data.code==1?(G(),P.success(l("app.webui.deletecomplete"))):R.data.code==0?P.error(l("app.webui.needlogin")):P.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})},n=()=>{y.value.id=null,y.value.role=null,y.value.username="",y.value.password="",y.value.email="",y.value.phone="",y.value.status=null,q.value=""};async function i(){if(y.value.role==null){P.error(l("app.webui.roleisnull"));return}if(y.value.username==""){P.error(l("app.webui.usernameempty"));return}if(y.value.password==""){P.error(l("app.webui.passwordempty"));return}if(y.value.password!=q.value){P.error(l("app.webui.passwordnotmatch"));return}try{const f={headers:{Authorization:`Bearer ${x}`}},r=await O.post("/api/v1/adduser",y.value,f);r.data.code==1?(G(),P.success(l("app.webui.addsuccess")),V.value=!1,console.log(y.value)):r.data.code==0?P.error(l("app.webui.needlogin")):P.error(l("app.webui.usernamealreadyexist"))}catch{}}async function h(){if(y.value.password==""&&y.value.password!=q.value){P.error(l("app.webui.passwordnotmatch"));return}y.value.status=y.value.status==!0?1:0;try{const f={headers:{Authorization:`Bearer ${x}`}},r=await O.post("/api/v1/updateuser",y.value,f);r.data.code==1?(G(),P.success(l("app.webui.modifysucc"))):r.data.code==0?P.error(l("app.webui.needlogin")):P.error(l("app.webui.modifyfail"))}catch{}b.value=!1}return(f,r)=>{const T=be,R=_e,Y=Ve,J=Be,F=xe,$=ke,te=ce,N=Ue,v=$e,d=ze,c=Se,D=Me,Ie=He;return p(),L(le,null,[u("div",null,[e(te,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",ql,[u("div",El,[u("div",Bl,[e(T,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=B=>_.value=B),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(R,{type:"primary",onClick:r[1]||(r[1]=B=>V.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.add")),1)]),_:1}),e(R,{disabled:H.value,type:"danger",onClick:Q},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(F,{data:m.value,onSelectionChange:A},{default:a(()=>[e(Y,{type:"selection",width:"55"}),e(Y,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(Y,{prop:"username",label:t(l)("app.webui.username")},null,8,["label"]),e(Y,{filters:[{text:t(l)("app.webui.admin"),value:1},{text:t(l)("app.webui.user"),value:0}],"filter-method":ae,label:t(l)("app.webui.role")},{default:a(({row:B})=>[B.role!=0?(p(),L("span",Il,o(t(l)("app.webui.admin")),1)):(p(),L("span",Ll,o(t(l)("app.webui.user")),1))]),_:1},8,["filters","label"]),e(Y,{prop:"email",label:t(l)("app.webui.email")},null,8,["label"]),e(Y,{prop:"phone",label:t(l)("app.webui.phone")},null,8,["label"]),e(Y,{filters:[{text:t(l)("app.webui.enable"),value:1},{text:t(l)("app.webui.disable"),value:0}],"filter-method":oe,label:t(l)("app.webui.status")},{default:a(({row:B})=>[u("div",Ml,[B.status!=0?(p(),S(J,{key:0,type:"success",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.enable")),1)]),_:1})):(p(),S(J,{key:1,type:"info",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.disable")),1)]),_:1}))])]),_:1},8,["filters","label"]),e(Y,{label:t(l)("app.webui.createtime"),sortable:""},{default:a(({row:B})=>[u("span",null,o(t(ue)(B.create_time)),1)]),_:1},8,["label"]),e(Y,{label:t(l)("app.webui.operate")},{default:a(B=>[e(R,{size:"small",type:"primary",onClick:Le=>ee(B.$index,B.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(R,{size:"small",type:"danger",onClick:Le=>z(B.$index,B.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e($,{"page-sizes":[15,25,50,100,200,300],"page-size":C.value,"onUpdate:pageSize":r[2]||(r[2]=B=>C.value=B),layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:I,onCurrentChange:K,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(D,{title:t(l)("app.webui.adduser"),modelValue:V.value,"onUpdate:modelValue":r[10]||(r[10]=B=>V.value=B),width:"30%",onClose:n},{default:a(()=>[e(c,{model:y.value,"label-width":"100px"},{default:a(()=>[e(d,{required:"",label:t(l)("app.webui.role")},{default:a(()=>[e(v,{modelValue:y.value.role,"onUpdate:modelValue":r[3]||(r[3]=B=>y.value.role=B),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(p(!0),L(le,null,se(E.value,B=>(p(),S(N,{key:B.id,label:B.label,value:B.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{required:"",label:t(l)("app.webui.username")},{default:a(()=>[e(T,{modelValue:y.value.username,"onUpdate:modelValue":r[4]||(r[4]=B=>y.value.username=B),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{required:"",label:t(l)("app.webui.password")},{default:a(()=>[e(T,{type:"password","show-password":"",modelValue:y.value.password,"onUpdate:modelValue":r[5]||(r[5]=B=>y.value.password=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{required:"",label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(T,{type:"password","show-password":"",modelValue:q.value,"onUpdate:modelValue":r[6]||(r[6]=B=>q.value=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.email")},{default:a(()=>[e(T,{modelValue:y.value.email,"onUpdate:modelValue":r[7]||(r[7]=B=>y.value.email=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.phone")},{default:a(()=>[e(T,{modelValue:y.value.phone,"onUpdate:modelValue":r[8]||(r[8]=B=>y.value.phone=B)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",Hl,[e(R,{onClick:r[9]||(r[9]=B=>V.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(R,{type:"primary",onClick:i},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(D,{title:t(l)("app.webui.edituser"),modelValue:b.value,"onUpdate:modelValue":r[19]||(r[19]=B=>b.value=B),width:"30%",onClose:n},{default:a(()=>[e(c,{model:y.value,"label-width":"100px"},{default:a(()=>[e(d,{label:t(l)("app.webui.role")},{default:a(()=>[e(v,{modelValue:y.value.role,"onUpdate:modelValue":r[11]||(r[11]=B=>y.value.role=B)},{default:a(()=>[(p(!0),L(le,null,se(E.value,B=>(p(),S(N,{key:B.id,label:B.label,value:B.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.username")},{default:a(()=>[e(T,{modelValue:y.value.username,"onUpdate:modelValue":r[12]||(r[12]=B=>y.value.username=B),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.password")},{default:a(()=>[e(T,{type:"password","show-password":"",modelValue:y.value.password,"onUpdate:modelValue":r[13]||(r[13]=B=>y.value.password=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(T,{type:"password","show-password":"",modelValue:q.value,"onUpdate:modelValue":r[14]||(r[14]=B=>q.value=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.email")},{default:a(()=>[e(T,{modelValue:y.value.email,"onUpdate:modelValue":r[15]||(r[15]=B=>y.value.email=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.phone")},{default:a(()=>[e(T,{modelValue:y.value.phone,"onUpdate:modelValue":r[16]||(r[16]=B=>y.value.phone=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{label:t(l)("app.webui.status")},{default:a(()=>[e(Ie,{modelValue:y.value.status,"onUpdate:modelValue":r[17]||(r[17]=B=>y.value.status=B),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",jl,[e(R,{onClick:r[18]||(r[18]=B=>b.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(R,{type:"primary",onClick:h},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),Al=ye(Dl,[["__scopeId","data-v-e97b9f4a"]]),Tl={key:0},Pl={class:"el-upload__text"},Fl={class:"el-upload__tip"},Nl={key:1},Zl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Gl={style:{display:"flex","align-items":"center"}},Rl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Xl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Ql={style:{"margin-top":"10px","padding-inline":"25px"}},Ol=["href"],Yl={key:0,style:{position:"relative"}},Jl={key:0,style:{position:"relative"}},Wl={key:2},Kl={style:{"font-weight":"lighter","font-size":"17px"}},ea={style:{display:"flex","justify-content":"space-around"}},la={style:{display:"flex",width:"80%",gap:"1%"}},aa={class:"status"},ta={key:0},oa={key:1},ua=de({__name:"Vulnlist",setup(ne){const{t:l}=pe(),j=g("xray"),E=g("xray"),_=g([]),x=g("--"),V=g({}),b=g({}),y=g([]),k=g(""),U=[K,T],C=g(1),M=g(15),Z=g(0),H=g(!0),q=g(!1),A=g(!1),m=g({vuln_name:"",vuln_type_id:1,cvss:.1,vuln_level:"",cve:"",nvd:"",edb:"",cnnvd:"",cnvd:"",affected_product:"",repair_suggestion:"",poc:"",exp:"",poc_type:j.value,exp_type:E.value,is_public:!1,description:"",fofa_query:"",zoom_eye_query:"",quake_query:"",hunter_query:"",google_query:"",shodan_query:"",censys_query:"",greynoise_query:"",attachment_id:"",affected_product_version:""}),I=()=>{if(m.value.cvss=Number(m.value.cvss),m.value.cvss>0&&m.value.cvss<4){m.value.vuln_level="Low",x.value=l("app.webui.low");return}else if(m.value.cvss>=4&&m.value.cvss<7){m.value.vuln_level="Medium",x.value=l("app.webui.medium");return}else if(m.value.cvss>=7&&m.value.cvss<9){m.value.vuln_level="High",x.value=l("app.webui.high");return}else if(m.value.cvss>=9&&m.value.cvss<=10){m.value.vuln_level="Critical",x.value=l("app.webui.critical");return}else P.error(l("app.webui.cvsserror"))};async function K(){try{const v=await O.get("/api/v1/getvulntypes");_.value=v.data.data}catch{}}const G=v=>{H.value=v.id,v.length>0?H.value=!1:H.value=!0};function Q(v,d){return v.is_public&&!d.is_public?-1:!v.is_public&&d.is_public?1:0}function ee(v,d){const c=new Date(v.create_time),D=new Date(d.create_time);return c<D?-1:c>D?1:0}const ae=ge(()=>{const d=0+M.value;if(k.value.trim()!="")return V.value.data.filter(c=>c.id.toLowerCase().includes(k.value.toLowerCase())||c.vuln_name.toLowerCase().includes(k.value.toLowerCase()));try{return V.value.data.slice(0,d)}catch{return[]}});function oe(v){M.value=v,C.value=1,T()}async function z(v){C.value=v,await T()}re(()=>{U.forEach(v=>{v()})});const n=(v,d,c,D)=>{(d.property==="id"||d.property==="vuln_name")&&(D.target.style.cursor="pointer",D.target.style.color="#409EFF")},i=(v,d,c,D)=>{(d.property==="id"||d.property==="vuln_name")&&(D.target.style.cursor="",D.target.style.color="")},h=()=>{q.value=!1,b.value={}};async function f(v){const d=sessionStorage.getItem("token");try{const c={headers:{Authorization:`Bearer ${d}`}},D=await O.get("/api/v1/getvulndtl?id="+v,c);d&&D.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),b.value=D.data}catch{}}const r=(v,d)=>{(d.no==1||d.no==2)&&(f(v.id),q.value=!0)};async function T(){try{const v=await O.get(`/api/v1/getvulnlist?page=${C.value}&limit=${M.value}`);V.value=v.data,Z.value=v.data.total,y.value=v.data.data.reduce((d,c)=>(d.some(D=>D.value===c.vuln_type)||d.push({text:c.vuln_type,value:c.vuln_type}),d),[])}catch{}}function R(){fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{P({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const Y=async(v,d)=>{console.log(d.id),await f(d.id),console.log(b.value),m.value=b.value.data,A.value=!0,console.log(m.value)},J=(v,d)=>{fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{P({type:"success",message:l("app.webui.deletecomplete")}),console.log(v,d)}).catch(()=>{})};function F(){console.log(m.value)}const $=(v,d)=>d.vuln_type===v,te=(v,d)=>d.level===v,N=(v,d)=>v==="Poc"?d.poc!="":d.exp!="";return(v,d)=>{const c=be,D=ze,Ie=Ue,B=$e,Le=He,ve=tl,Te=ol,Pe=Ce,Re=Ze,me=_e,Xe=Se,we=ce,W=Be,X=je,Fe=De,Ne=Ae,ie=Ve,Qe=xe,Oe=ke;return A.value?(p(),L("div",Tl,[e(we,{shadow:"always",header:t(l)("app.webui.editvuln")},{default:a(()=>[u("div",null,[e(Xe,{inline:"true",model:m.value,"label-width":"auto",size:"large"},{default:a(()=>[e(D,{label:t(l)("app.webui.vulnname"),prop:"vuln_name",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(c,{modelValue:m.value.vuln_name,"onUpdate:modelValue":d[0]||(d[0]=w=>m.value.vuln_name=w)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:t(l)("app.webui.vulntype"),style:{width:"45%"},required:""},{default:a(()=>[e(B,{modelValue:m.value.vuln_type_id,"onUpdate:modelValue":d[1]||(d[1]=w=>m.value.vuln_type_id=w),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(p(!0),L(le,null,se(_.value,w=>(p(),S(Ie,{key:w.id,label:w.name,value:w.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.affectedproduct"),prop:"affected_product",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(c,{modelValue:m.value.affected_product,"onUpdate:modelValue":d[2]||(d[2]=w=>m.value.affected_product=w)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:t(l)("app.webui.productversion"),style:{width:"45%"},prop:"affected_product_version",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(c,{modelValue:m.value.affected_product_version,"onUpdate:modelValue":d[3]||(d[3]=w=>m.value.affected_product_version=w)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:"CVSS",style:{width:"29%"},required:""},{default:a(()=>[e(c,{modelValue:m.value.cvss,"onUpdate:modelValue":d[4]||(d[4]=w=>m.value.cvss=w),type:"number",step:"0.1",onChange:I},null,8,["modelValue"])]),_:1}),e(D,{label:t(l)("app.webui.vulnlevel"),style:{width:"29%"},required:""},{default:a(()=>[e(c,{modelValue:x.value,"onUpdate:modelValue":d[5]||(d[5]=w=>x.value=w),readonly:"",disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.ispublic"),style:{width:"29%"}},{default:a(()=>[e(Le,{modelValue:m.value.is_public,"onUpdate:modelValue":d[6]||(d[6]=w=>m.value.is_public=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.cveid"),style:{width:"29%"}},{default:a(()=>[e(c,{modelValue:m.value.cve,"onUpdate:modelValue":d[7]||(d[7]=w=>m.value.cve=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.nvdid"),style:{width:"29%"}},{default:a(()=>[e(c,{modelValue:m.value.nvd,"onUpdate:modelValue":d[8]||(d[8]=w=>m.value.nvd=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.edbid"),style:{width:"29%"}},{default:a(()=>[e(c,{modelValue:m.value.edbid,"onUpdate:modelValue":d[9]||(d[9]=w=>m.value.edbid=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.cnnvdid"),style:{width:"29%"}},{default:a(()=>[e(c,{modelValue:m.value.cnnvd,"onUpdate:modelValue":d[10]||(d[10]=w=>m.value.cnnvd=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.cnvdid"),style:{width:"29%"}},{default:a(()=>[e(c,{modelValue:m.value.cnvd,"onUpdate:modelValue":d[11]||(d[11]=w=>m.value.cnvd=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Fofa ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.fofa_query,"onUpdate:modelValue":d[12]||(d[12]=w=>m.value.fofa_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`ZoomEye ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.zoom_eye_query,"onUpdate:modelValue":d[13]||(d[13]=w=>m.value.zoom_eye_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Quake ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.quake_query,"onUpdate:modelValue":d[14]||(d[14]=w=>m.value.quake_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Hunter ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.hunter_query,"onUpdate:modelValue":d[15]||(d[15]=w=>m.value.hunter_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Google ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.google_query,"onUpdate:modelValue":d[16]||(d[16]=w=>m.value.google_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Shodan ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.shodan_query,"onUpdate:modelValue":d[17]||(d[17]=w=>m.value.shodan_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Censys ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.censys_query,"onUpdate:modelValue":d[18]||(d[18]=w=>m.value.censys_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Greynoise ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(c,{modelValue:m.value.greynoise_query,"onUpdate:modelValue":d[19]||(d[19]=w=>m.value.greynoise_query=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.vulndesc"),style:{width:"90%"},prop:"description",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(c,{modelValue:m.value.description,"onUpdate:modelValue":d[20]||(d[20]=w=>m.value.description=w),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:t(l)("app.webui.vulnsuggest"),style:{width:"90%"},prop:"repair_suggestion",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(c,{modelValue:m.value.repair_suggestion,"onUpdate:modelValue":d[21]||(d[21]=w=>m.value.repair_suggestion=w),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:"Poc",style:{width:"90%"},onChange:v.ShowPocInput},{default:a(()=>[e(Te,{modelValue:j.value,"onUpdate:modelValue":d[22]||(d[22]=w=>j.value=w),size:"large"},{default:a(()=>[e(ve,{label:"Xray",value:"xray"}),e(ve,{label:"Nuclei",value:"nuclei"}),e(ve,{label:"Goby",value:"goby"}),e(ve,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(c,{modelValue:m.value.poc,"onUpdate:modelValue":d[23]||(d[23]=w=>m.value.poc=w),type:"textarea",placeholder:v.pocplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e(D,{label:"Exp",style:{width:"90%"},onChange:v.ShowExpInput},{default:a(()=>[e(Te,{modelValue:E.value,"onUpdate:modelValue":d[24]||(d[24]=w=>E.value=w),size:"large"},{default:a(()=>[e(ve,{label:"Xray",value:"xray"}),e(ve,{label:"Nuclei",value:"nuclei"}),e(ve,{label:"Goby",value:"goby"}),e(ve,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(c,{modelValue:m.value.exp,"onUpdate:modelValue":d[25]||(d[25]=w=>m.value.exp=w),type:"textarea",placeholder:v.expplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e(D,{label:t(l)("app.webui.attachfile"),style:{width:"100%"}},{default:a(()=>[e(Re,{class:"upload-demo",drag:"",accept:".zip,.doc,.docx,.pdf,.txt",action:"/api/v1/upload",headers:{Authorization:`Bearer ${v.token}`},"on-success":v.handleSuccess,"on-remove":v.handleRemove,style:{width:"90%"}},{tip:a(()=>[u("div",Fl,o(t(l)("app.webui.uploadnotice1")),1)]),default:a(()=>[e(Pe,{class:"el-icon--upload"},{default:a(()=>[e(t(al))]),_:1}),u("div",Pl,[s(o(t(l)("app.webui.draguplaod"))+" ",1),u("em",null,o(t(l)("app.webui.clickupload")),1)])]),_:1},8,["headers","on-success","on-remove"])]),_:1},8,["label"]),e(D,{style:{width:"100%"}},{default:a(()=>[e(me,{onClick:d[26]||(d[26]=w=>A.value=!1),size:"default"},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(me,{type:"primary",onClick:F,size:"default"},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["header"])])):q.value?(p(),L("div",Nl,[e(we,{shadow:"always"},{header:a(()=>[u("div",Zl,[u("span",Gl,[e(Pe,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>d[33]||(d[33]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+o(b.value.data.vuln_name),1)]),e(me,{type:"primary",onClick:h},{default:a(()=>[s(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[u("div",null,[e(Fe,{column:5},{default:a(()=>[e(X,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(W,null,{default:a(()=>[s(o(b.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[s(o(b.value.data.vuln_type),1)]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[b.value.data.vuln_level==="Critical"?(p(),S(W,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):b.value.data.vuln_level==="High"?(p(),S(W,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):b.value.data.vuln_level==="Medium"?(p(),S(W,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(p(),S(W,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[s(o(t(ue)(b.value.data.create_time)),1)]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[s(o(b.value.data.submitter),1)]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(W,null,{default:a(()=>[s(o(b.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(W,null,{default:a(()=>[s(o(b.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(W,null,{default:a(()=>[s(o(b.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(W,null,{default:a(()=>[s(o(b.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(X,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(W,null,{default:a(()=>[s(o(b.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(X,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[s(o(b.value.data.affected_product),1)]),_:1},8,["label"]),e(X,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[s(o(b.value.data.affected_product_version),1)]),_:1},8,["label"]),e(X,{label:"CVSS:"},{default:a(()=>[s(o(b.value.data.cvss),1)]),_:1}),e(X,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",Rl,o(b.value.data.description),1)]),_:1},8,["label"]),e(X,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",Xl,o(b.value.data.repair_suggestion),1)]),_:1},8,["label"]),b.value.data.attachment_id?(p(),S(X,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",Ql,[u("a",{href:`/download/file?id=${b.value.data.attachment_id}`},o(b.value.data.attachment_name),9,Ol)])]),_:1},8,["label"])):qe("",!0)]),_:1})])]),_:1}),e(we,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(Fe,{column:5},{default:a(()=>[e(X,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.fofa_query),1)]),_:1},8,["label"]),e(X,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(X,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.quake_query),1)]),_:1},8,["label"]),e(X,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.hunter_query),1)]),_:1},8,["label"]),e(X,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.google_query),1)]),_:1},8,["label"]),e(X,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.shodan_query),1)]),_:1},8,["label"]),e(X,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.censys_query),1)]),_:1},8,["label"]),e(X,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(b.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(we,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[b.value.data.poc!=""?(p(),L("div",Yl,[e(me,{type:"primary",icon:t(he),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:d[27]||(d[27]=w=>v.copyToClipboard(b.value.data.poc))},null,8,["icon"]),e(c,{modelValue:b.value.data.poc,"onUpdate:modelValue":d[28]||(d[28]=w=>b.value.data.poc=w),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(p(),S(Ne,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(we,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[b.value.data.exp!=""?(p(),L("div",Jl,[e(me,{type:"primary",icon:t(he),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:d[29]||(d[29]=w=>v.copyToClipboard(b.value.data.exp))},null,8,["icon"]),e(c,{modelValue:b.value.data.exp,"onUpdate:modelValue":d[30]||(d[30]=w=>b.value.data.exp=w),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(p(),S(Ne,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(p(),L("div",Wl,[e(we,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",Kl,[u("div",ea,[u("div",la,[e(c,{modelValue:k.value,"onUpdate:modelValue":d[31]||(d[31]=w=>k.value=w),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),e(me,{disabled:H.value,type:"danger",onClick:R},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])]),e(Qe,{data:ae.value,onSelectionChange:G,onCellMouseEnter:n,onCellMouseLeave:i,onCellClick:r},{default:a(()=>[e(ie,{type:"selection",width:"55"}),e(ie,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(ie,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(ie,{prop:"vuln_type",filters:y.value,"filter-method":$,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(ie,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":te,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:w})=>[w.vuln_level==="Critical"?(p(),S(W,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):w.vuln_level==="High"?(p(),S(W,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):w.vuln_level==="Medium"?(p(),S(W,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(p(),S(W,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(ie,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(ie,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":N,label:"Poc&Exp",width:"120"},{default:a(({row:w})=>[u("div",aa,[w.poc!=""&&w.poc!="0"?(p(),S(W,{key:0,type:"success",effect:"dark"},{default:a(()=>d[34]||(d[34]=[s("Poc")])),_:1})):(p(),S(W,{key:1,type:"info",effect:"dark"},{default:a(()=>d[35]||(d[35]=[s("Poc")])),_:1})),w.exp!=""&&w.exp!="0"?(p(),S(W,{key:2,type:"success",effect:"dark"},{default:a(()=>d[36]||(d[36]=[s("Exp")])),_:1})):(p(),S(W,{key:3,type:"info",effect:"dark"},{default:a(()=>d[37]||(d[37]=[s("Exp")])),_:1}))])]),_:1}),e(ie,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":Q,width:"110"},{default:a(({row:w})=>[w.is_public?(p(),L("span",ta,o(t(l)("app.webui.yes")),1)):(p(),L("span",oa,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(ie,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":ee},{default:a(({row:w})=>[u("span",null,o(t(ue)(w.create_time)),1)]),_:1},8,["label"]),e(ie,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":ee},{default:a(({row:w})=>[u("span",null,o(t(ue)(w.update_time)),1)]),_:1},8,["label"]),e(ie,{label:t(l)("app.webui.operate"),width:"140"},{default:a(w=>[e(me,{size:"small",type:"primary",onClick:Ye=>Y(w.$index,w.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(me,{size:"small",type:"danger",onClick:Ye=>J(w.$index,w.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(Oe,{"page-sizes":[15,25,50,100,200,300],"page-size":M.value,"onUpdate:pageSize":d[32]||(d[32]=w=>M.value=w),layout:"total, sizes, prev, pager, next, jumper",total:Z.value,onSizeChange:oe,onCurrentChange:z,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),na=ye(ua,[["__scopeId","data-v-47f7f80c"]]),ia={key:0},sa={style:{"font-weight":"lighter","font-size":"17px"}},da={style:{display:"flex","justify-content":"space-around"}},pa={style:{display:"flex",width:"80%",gap:"1%"}},ra={class:"status"},ca={key:0},va={key:1},ma={key:1},fa={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ba={style:{display:"flex","align-items":"center"}},_a={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ya={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},wa={style:{"margin-top":"10px","padding-inline":"25px"}},ha=["href"],ga={key:0,style:{position:"relative"}},Va={key:0,style:{position:"relative"}},xa={style:{"margin-top":"1%"}},ka=de({__name:"Unaudited",setup(ne){const{t:l}=pe(),j=g(!1),E=sessionStorage.getItem("token"),_=g([]),x=g({}),V=g({}),b=g({id:null,audit:1,review:"",cvss:null,prid:1,erid:1,irid:1,orid:1}),y=g(""),k=[ee],U=g(1),C=g(15),M=g(0),Z=[{id:1,name:""},{id:2,name:""},{id:3,name:""},{id:4,name:""}];function H(n,i){return n.is_public&&!i.is_public?-1:!n.is_public&&i.is_public?1:0}function q(n,i){const h=new Date(n.create_time),f=new Date(i.create_time);return h<f?-1:h>f?1:0}const A=ge(()=>{const i=0+C.value;if(console.log(x.value),y.value.trim()!="")return x.value.data.filter(h=>h.id.toLowerCase().includes(y.value.toLowerCase())||h.vuln_name.toLowerCase().includes(y.value.toLowerCase()));try{return x.value.data.slice(0,i)}catch{return[]}});function m(n){C.value=n,U.value=1,ee()}async function I(n){U.value=n,await ee()}re(()=>{k.forEach(n=>{n()})});const K=()=>{j.value=!1,V.value={}},G=async(n,i)=>{console.log(n,i);try{const h={headers:{Authorization:`Bearer ${E}`}},f=await O.get("/api/v1/getvulndtl?id="+i.id,h);E&&f.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),V.value=f.data,b.value.id=i.id,b.value.cvss=f.data.data.cvss,j.value=!0}catch{}},Q=()=>{console.log(""),console.log(b.value)};async function ee(){try{const n={headers:{Authorization:`Bearer ${E}`}},i=await O.get(`/api/v1/getunauditlist?page=${U.value}&limit=${C.value}`,n);x.value=i.data,M.value=i.data.total,_.value=i.data.data.reduce((h,f)=>(h.some(r=>r.value===f.vuln_type)||h.push({text:f.vuln_type,value:f.vuln_type}),h),[])}catch{}}const ae=(n,i)=>i.vuln_type===n,oe=(n,i)=>i.level===n,z=(n,i)=>n==="Poc"?i.poc!="":i.exp!="";return(n,i)=>{const h=be,f=Ve,r=Be,T=_e,R=xe,Y=ke,J=ce,F=Ce,$=je,te=De,N=Ae,v=Ue,d=$e;return j.value?(p(),L("div",ma,[e(J,{shadow:"always"},{header:a(()=>[u("div",fa,[u("span",ba,[e(F,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>i[18]||(i[18]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+o(V.value.data.vuln_name),1)])])]),default:a(()=>[u("div",null,[e(te,{column:5},{default:a(()=>[e($,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(r,null,{default:a(()=>[s(o(V.value.data.id),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[s(o(V.value.data.vuln_type),1)]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[V.value.data.vuln_level==="Critical"?(p(),S(r,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):V.value.data.vuln_level==="High"?(p(),S(r,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):V.value.data.vuln_level==="Medium"?(p(),S(r,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(p(),S(r,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[s(o(t(ue)(V.value.data.create_time)),1)]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[s(o(V.value.data.submitter),1)]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(r,null,{default:a(()=>[s(o(V.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(r,null,{default:a(()=>[s(o(V.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(r,null,{default:a(()=>[s(o(V.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(r,null,{default:a(()=>[s(o(V.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(r,null,{default:a(()=>[s(o(V.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e($,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[s(o(V.value.data.affected_product),1)]),_:1},8,["label"]),e($,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[s(o(V.value.data.affected_product_version),1)]),_:1},8,["label"]),e($,{label:"CVSS:"},{default:a(()=>[s(o(V.value.data.cvss),1)]),_:1}),e($,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",_a,o(V.value.data.description),1)]),_:1},8,["label"]),e($,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",ya,o(V.value.data.repair_suggestion),1)]),_:1},8,["label"]),V.value.data.attachment_id?(p(),S($,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",wa,[u("a",{href:`/download/file?id=${V.value.data.attachment_id}`},o(V.value.data.attachment_name),9,ha)])]),_:1},8,["label"])):qe("",!0)]),_:1})])]),_:1}),e(J,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(te,{column:5},{default:a(()=>[e($,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.fofa_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e($,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.quake_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.hunter_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.google_query),1)]),_:1},8,["label"]),e($,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.shodan_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.censys_query),1)]),_:1},8,["label"]),e($,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(V.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(J,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[V.value.data.poc!=""?(p(),L("div",ga,[e(T,{type:"primary",icon:t(he),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:i[2]||(i[2]=c=>n.copyToClipboard(V.value.data.poc))},null,8,["icon"]),e(h,{modelValue:V.value.data.poc,"onUpdate:modelValue":i[3]||(i[3]=c=>V.value.data.poc=c),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(p(),S(N,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(J,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[V.value.data.exp!=""?(p(),L("div",Va,[e(T,{type:"primary",icon:t(he),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:i[4]||(i[4]=c=>n.copyToClipboard(V.value.data.exp))},null,8,["icon"]),e(h,{modelValue:V.value.data.exp,"onUpdate:modelValue":i[5]||(i[5]=c=>V.value.data.exp=c),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(p(),S(N,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(J,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.audit")},{default:a(()=>[u("div",null,[e(h,{type:"numper",modelValue:b.value.cvss,"onUpdate:modelValue":i[6]||(i[6]=c=>b.value.cvss=c)},null,8,["modelValue"])]),u("div",null,[e(d,{modelValue:b.value.audit,"onUpdate:modelValue":i[7]||(i[7]=c=>b.value.audit=c),placeholder:t(l)("app.webui.observability")},{default:a(()=>[(p(),L(le,null,se(Z,c=>e(v,{key:c.id,label:c.name,value:c.id},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),u("div",null,[e(h,{type:"textarea",modelValue:b.value.review,"onUpdate:modelValue":i[8]||(i[8]=c=>b.value.review=c)},null,8,["modelValue"])]),u("div",null,[e(d,{modelValue:b.value.prid,"onUpdate:modelValue":i[9]||(i[9]=c=>b.value.prid=c),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(p(),L(le,null,se(Z,c=>e(v,{key:c.id,label:c.name,value:c.id},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),u("div",null,[e(d,{modelValue:b.value.erid,"onUpdate:modelValue":i[10]||(i[10]=c=>b.value.erid=c),placeholder:t(l)("app.webui.exploitability")},{default:a(()=>[(p(!0),L(le,null,se(n.exploitability,c=>(p(),S(v,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),u("div",null,[e(d,{modelValue:b.value.irid,"onUpdate:modelValue":i[11]||(i[11]=c=>b.value.irid=c),placeholder:t(l)("app.webui.impact")},{default:a(()=>[(p(!0),L(le,null,se(n.impact,c=>(p(),S(v,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),u("div",null,[e(d,{modelValue:b.value.orid,"onUpdate:modelValue":i[12]||(i[12]=c=>b.value.orid=c),placeholder:t(l)("app.webui.observability")},{default:a(()=>[(p(!0),L(le,null,se(n.observability,c=>(p(),S(v,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),_:1},8,["header"]),u("div",xa,[e(T,{onClick:K},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(T,{type:"primary",onClick:Q},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])])):(p(),L("div",ia,[e(J,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",sa,[u("div",da,[u("div",pa,[e(h,{modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=c=>y.value=c),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),i[13]||(i[13]=u("span",null,null,-1))]),e(R,{data:A.value},{default:a(()=>[e(f,{type:"selection",width:"55"}),e(f,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(f,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(f,{prop:"vuln_type",filters:_.value,"filter-method":ae,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(f,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":oe,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:c})=>[c.vuln_level==="Critical"?(p(),S(r,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):c.vuln_level==="High"?(p(),S(r,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):c.vuln_level==="Medium"?(p(),S(r,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(p(),S(r,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(f,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(f,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":z,label:t(l)("app.webui.status"),width:"120"},{default:a(({row:c})=>[u("div",ra,[c.poc!=""&&c.poc!="0"?(p(),S(r,{key:0,type:"success",effect:"dark"},{default:a(()=>i[14]||(i[14]=[s("Poc")])),_:1})):(p(),S(r,{key:1,type:"info",effect:"dark"},{default:a(()=>i[15]||(i[15]=[s("Poc")])),_:1})),c.exp!=""&&c.exp!="0"?(p(),S(r,{key:2,type:"success",effect:"dark"},{default:a(()=>i[16]||(i[16]=[s("Exp")])),_:1})):(p(),S(r,{key:3,type:"info",effect:"dark"},{default:a(()=>i[17]||(i[17]=[s("Exp")])),_:1}))])]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":H,width:"110"},{default:a(({row:c})=>[c.is_public?(p(),L("span",ca,o(t(l)("app.webui.yes")),1)):(p(),L("span",va,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":q},{default:a(({row:c})=>[u("span",null,o(t(ue)(c.create_time)),1)]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":q},{default:a(({row:c})=>[u("span",null,o(t(ue)(c.update_time)),1)]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.operate"),width:"140"},{default:a(c=>[e(T,{size:"small",type:"primary",onClick:D=>G(c.$index,c.row)},{default:a(()=>[s(o(t(l)("app.webui.audit")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(Y,{"page-sizes":[15,25,50,100,200,300],"page-size":C.value,"onUpdate:pageSize":i[1]||(i[1]=c=>C.value=c),layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:m,onCurrentChange:I,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Ca=ye(ka,[["__scopeId","data-v-362449d2"]]),$a={key:0},za={style:{"font-weight":"lighter","font-size":"17px"}},Sa={style:{display:"flex","justify-content":"space-around"}},Ua={style:{display:"flex",width:"80%",gap:"1%"}},qa={class:"status"},Ea={key:0},Ba={key:1},Ia={key:1},La={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ma={style:{display:"flex","align-items":"center"}},Ha={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ja={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Da={style:{"margin-top":"10px","padding-inline":"25px"}},Aa=["href"],Ta={key:0,style:{position:"relative"}},Pa={key:0,style:{position:"relative"}},Fa=de({__name:"Audited",setup(ne){const{t:l}=pe(),j=g(!1),E=sessionStorage.getItem("token"),_=g({}),x=g({}),V=g(""),b=g([]),y=[Q],k=g(1),U=g(15),C=g(0);function M(z,n){return z.is_public&&!n.is_public?-1:!z.is_public&&n.is_public?1:0}function Z(z,n){const i=new Date(z.create_time),h=new Date(n.create_time);return i<h?-1:i>h?1:0}const H=ge(()=>{const n=0+U.value;if(console.log(_.value),V.value.trim()!="")return _.value.data.filter(i=>i.id.toLowerCase().includes(V.value.toLowerCase())||i.vuln_name.toLowerCase().includes(V.value.toLowerCase()));try{return _.value.data.slice(0,n)}catch{return[]}});function q(z){U.value=z,k.value=1,Q()}async function A(z){k.value=z,await Q()}const m=(z,n,i,h)=>{(n.property==="id"||n.property==="vuln_name")&&(h.target.style.cursor="pointer",h.target.style.color="#409EFF")},I=(z,n,i,h)=>{(n.property==="id"||n.property==="vuln_name")&&(h.target.style.cursor="",h.target.style.color="")},K=()=>{j.value=!1,x.value={}},G=async(z,n)=>{if(n.no==0||n.no==1)try{const i={headers:{Authorization:`Bearer ${E}`}},h=await O.get("/api/v1/getvulndtl?id="+z.id,i);E&&h.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),x.value=h.data,j.value=!0}catch{}};re(()=>{y.forEach(z=>{z()})});async function Q(){try{const z={headers:{Authorization:`Bearer ${E}`}},n=await O.get(`/api/v1/getauditedlist?page=${k.value}&limit=${U.value}`,z);_.value=n.data,C.value=n.data.total,b.value=n.data.data.reduce((i,h)=>(i.some(f=>f.value===h.vuln_type)||i.push({text:h.vuln_type,value:h.vuln_type}),i),[])}catch{}}const ee=(z,n)=>n.vuln_type===z,ae=(z,n)=>n.level===z,oe=(z,n)=>z==="Poc"?n.poc!="":n.exp!="";return(z,n)=>{const i=be,h=Ve,f=Be,r=xe,T=ke,R=ce,Y=Ce,J=_e,F=je,$=De,te=Ae;return j.value?(p(),L("div",Ia,[e(R,{shadow:"always"},{header:a(()=>[u("div",La,[u("span",Ma,[e(Y,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>n[11]||(n[11]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+o(x.value.data.vuln_name),1)]),e(J,{type:"primary",onClick:K},{default:a(()=>[s(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[u("div",null,[e($,{column:5},{default:a(()=>[e(F,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(f,null,{default:a(()=>[s(o(x.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[s(o(x.value.data.vuln_type),1)]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[x.value.data.vuln_level==="Critical"?(p(),S(f,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):x.value.data.vuln_level==="High"?(p(),S(f,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):x.value.data.vuln_level==="Medium"?(p(),S(f,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(p(),S(f,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[s(o(t(ue)(x.value.data.create_time)),1)]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[s(o(x.value.data.submitter),1)]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(f,null,{default:a(()=>[s(o(x.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(f,null,{default:a(()=>[s(o(x.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(f,null,{default:a(()=>[s(o(x.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(f,null,{default:a(()=>[s(o(x.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(F,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(f,null,{default:a(()=>[s(o(x.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(F,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[s(o(x.value.data.affected_product),1)]),_:1},8,["label"]),e(F,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[s(o(x.value.data.affected_product_version),1)]),_:1},8,["label"]),e(F,{label:"CVSS:"},{default:a(()=>[s(o(x.value.data.cvss),1)]),_:1}),e(F,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",Ha,o(x.value.data.description),1)]),_:1},8,["label"]),e(F,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",ja,o(x.value.data.repair_suggestion),1)]),_:1},8,["label"]),x.value.data.attachment_id?(p(),S(F,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",Da,[u("a",{href:`/download/file?id=${x.value.data.attachment_id}`},o(x.value.data.attachment_name),9,Aa)])]),_:1},8,["label"])):qe("",!0)]),_:1})])]),_:1}),e(R,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e($,{column:5},{default:a(()=>[e(F,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.fofa_query),1)]),_:1},8,["label"]),e(F,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(F,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.quake_query),1)]),_:1},8,["label"]),e(F,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.hunter_query),1)]),_:1},8,["label"]),e(F,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.google_query),1)]),_:1},8,["label"]),e(F,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.shodan_query),1)]),_:1},8,["label"]),e(F,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.censys_query),1)]),_:1},8,["label"]),e(F,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(x.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(R,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[x.value.data.poc!=""?(p(),L("div",Ta,[e(J,{type:"primary",icon:t(he),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:n[2]||(n[2]=N=>z.copyToClipboard(x.value.data.poc))},null,8,["icon"]),e(i,{modelValue:x.value.data.poc,"onUpdate:modelValue":n[3]||(n[3]=N=>x.value.data.poc=N),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(p(),S(te,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(R,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[x.value.data.exp!=""?(p(),L("div",Pa,[e(J,{type:"primary",icon:t(he),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:n[4]||(n[4]=N=>z.copyToClipboard(x.value.data.exp))},null,8,["icon"]),e(i,{modelValue:x.value.data.exp,"onUpdate:modelValue":n[5]||(n[5]=N=>x.value.data.exp=N),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(p(),S(te,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(p(),L("div",$a,[e(R,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",za,[u("div",Sa,[u("div",Ua,[e(i,{modelValue:V.value,"onUpdate:modelValue":n[0]||(n[0]=N=>V.value=N),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),n[6]||(n[6]=u("span",null,null,-1))]),e(r,{data:H.value,onSelectionChange:z.handleSelectionChange,onCellMouseEnter:m,onCellMouseLeave:I,onCellClick:G},{default:a(()=>[e(h,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(h,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(h,{prop:"vuln_type",filters:b.value,"filter-method":ee,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(h,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":ae,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:N})=>[N.vuln_level==="Critical"?(p(),S(f,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):N.vuln_level==="High"?(p(),S(f,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):N.vuln_level==="Medium"?(p(),S(f,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(p(),S(f,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(h,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(h,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":oe,label:"Poc&Exp",width:"120"},{default:a(({row:N})=>[u("div",qa,[N.poc!=""&&N.poc!="0"?(p(),S(f,{key:0,type:"success",effect:"dark"},{default:a(()=>n[7]||(n[7]=[s("Poc")])),_:1})):(p(),S(f,{key:1,type:"info",effect:"dark"},{default:a(()=>n[8]||(n[8]=[s("Poc")])),_:1})),N.exp!=""&&N.exp!="0"?(p(),S(f,{key:2,type:"success",effect:"dark"},{default:a(()=>n[9]||(n[9]=[s("Exp")])),_:1})):(p(),S(f,{key:3,type:"info",effect:"dark"},{default:a(()=>n[10]||(n[10]=[s("Exp")])),_:1}))])]),_:1}),e(h,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":M,width:"110"},{default:a(({row:N})=>[N.is_public?(p(),L("span",Ea,o(t(l)("app.webui.yes")),1)):(p(),L("span",Ba,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(h,{label:t(l)("app.webui.status"),sortable:"","sort-method":M,width:"110"},{default:a(({row:N})=>[N.status==1?(p(),S(f,{key:0,type:"success"},{default:a(()=>[s(o(t(l)("app.webui.passed")),1)]),_:1})):(p(),S(f,{key:1,type:"danger"},{default:a(()=>[s(o(t(l)("app.webui.unpassed")),1)]),_:1}))]),_:1},8,["label"]),e(h,{prop:"review_comments",label:t(l)("app.webui.reviewcomments")},null,8,["label"]),e(h,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":Z},{default:a(({row:N})=>[u("span",null,o(t(ue)(N.update_time)),1)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])]),e(T,{"page-sizes":[15,25,50,100,200,300],"page-size":U.value,"onUpdate:pageSize":n[1]||(n[1]=N=>U.value=N),layout:"total, sizes, prev, pager, next, jumper",total:C.value,onSizeChange:q,onCurrentChange:A,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Na=ye(Fa,[["__scopeId","data-v-1a7b571d"]]),Za={style:{"margin-top":"1%"}},Ga=de({__name:"System",setup(ne){const{t:l}=pe(),j=g(!0),E=sessionStorage.getItem("token"),_=g({emailconf:{email_host:"",email_port:0,email_user:"",email_password:"",email_sender:""},jwtconf:{jwt_secret:"",jwt_expires:0},noticeconf:{type:0,secret:"",webhook:""},sysconf:{user_register:!1,user_display:"",max_attempts:0,lockout_duration:0}}),x=g([{key:0,value:l("el.select.placeholder")},{key:1,value:l("app.webui.dingtalk")},{key:2,value:l("app.webui.wxwork")}]);re(V);async function V(){try{const y={headers:{Authorization:`Bearer ${E}`}},k=await O.get("/api/v1/getsysconfig",y);k.data.code==1?_.value=k.data.data:(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"))}catch{}}async function b(){console.log(_.value);try{const y={headers:{Authorization:`Bearer ${E}`}};_.value.emailconf.email_port=Number(_.value.emailconf.email_port),_.value.jwtconf.jwt_expires=Number(_.value.jwtconf.jwt_expires),_.value.noticeconf.type=Number(_.value.noticeconf.type),_.value.sysconf.max_attempts=Number(_.value.sysconf.max_attempts),_.value.sysconf.lockout_duration=Number(_.value.sysconf.lockout_duration),(await O.post("/api/v1/updatesysconfig",_.value,y)).data.code==1?(V(),P({type:"success",message:l("app.webui.savesuccess")}),j.value=!0):P({type:"error",message:l("app.webui.savefail")})}catch{}}return(y,k)=>{const U=He,C=ze,M=be,Z=Se,H=ce,q=Ue,A=$e,m=_e;return p(),L(le,null,[e(H,{header:t(l)("app.webui.regandlogincnfg")},{default:a(()=>[e(Z,{disabled:j.value,modelValue:_.value.sysconf,"onUpdate:modelValue":k[9]||(k[9]=I=>_.value.sysconf=I),"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(C,{label:t(l)("app.webui.userregister")},{default:a(()=>[e(U,{modelValue:_.value.sysconf.user_register,"onUpdate:modelValue":k[0]||(k[0]=I=>_.value.sysconf.user_register=I),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.userdisplay")},{default:a(()=>[e(M,{modelValue:_.value.sysconf.user_display,"onUpdate:modelValue":k[1]||(k[1]=I=>_.value.sysconf.user_display=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.maxattempts"),required:""},{default:a(()=>[e(M,{type:"number",modelValue:_.value.sysconf.max_attempts,"onUpdate:modelValue":k[2]||(k[2]=I=>_.value.sysconf.max_attempts=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.lockoutduration"),required:""},{default:a(()=>[e(M,{type:"number",modelValue:_.value.sysconf.lockout_duration,"onUpdate:modelValue":k[3]||(k[3]=I=>_.value.sysconf.lockout_duration=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailserver")},{default:a(()=>[e(M,{modelValue:_.value.emailconf.email_host,"onUpdate:modelValue":k[4]||(k[4]=I=>_.value.emailconf.email_host=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailport")},{default:a(()=>[e(M,{type:"number",modelValue:_.value.emailconf.email_port,"onUpdate:modelValue":k[5]||(k[5]=I=>_.value.emailconf.email_port=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailuser")},{default:a(()=>[e(M,{modelValue:_.value.emailconf.email_user,"onUpdate:modelValue":k[6]||(k[6]=I=>_.value.emailconf.email_user=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailpasswd")},{default:a(()=>[e(M,{type:"password","show-password":"",modelValue:_.value.emailconf.email_password,"onUpdate:modelValue":k[7]||(k[7]=I=>_.value.emailconf.email_password=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailsender")},{default:a(()=>[e(M,{modelValue:_.value.emailconf.email_sender,"onUpdate:modelValue":k[8]||(k[8]=I=>_.value.emailconf.email_sender=I)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])]),_:1},8,["header"]),e(H,{header:t(l)("app.webui.jwtconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(Z,{disabled:j.value,model:_.value.jwtconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(C,{label:t(l)("app.webui.jwtkey"),required:""},{default:a(()=>[e(M,{modelValue:_.value.jwtconf.jwt_secret,"onUpdate:modelValue":k[10]||(k[10]=I=>_.value.jwtconf.jwt_secret=I)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.jwtvalidity"),required:""},{default:a(()=>[e(M,{type:"number",modelValue:_.value.jwtconf.jwt_expires,"onUpdate:modelValue":k[11]||(k[11]=I=>_.value.jwtconf.jwt_expires=I)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","model"])]),_:1},8,["header"]),e(H,{header:t(l)("app.webui.noticeconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(Z,{disabled:j.value,model:_.value.noticeconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(C,{label:t(l)("app.webui.noticetype")},{default:a(()=>[e(A,{modelValue:_.value.noticeconf.type,"onUpdate:modelValue":k[12]||(k[12]=I=>_.value.noticeconf.type=I)},{default:a(()=>[(p(!0),L(le,null,se(x.value,I=>(p(),S(q,{key:I.key,label:I.value,value:I.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(C,{label:"Webhook"},{default:a(()=>[e(M,{modelValue:_.value.noticeconf.webhook,"onUpdate:modelValue":k[13]||(k[13]=I=>_.value.noticeconf.webhook=I)},null,8,["modelValue"])]),_:1}),_.value.noticeconf.type==1?(p(),S(C,{key:0,label:"Secret"},{default:a(()=>[e(M,{type:"password","show-password":"",modelValue:_.value.noticeconf.secret,"onUpdate:modelValue":k[14]||(k[14]=I=>_.value.noticeconf.secret=I)},null,8,["modelValue"])]),_:1})):qe("",!0)]),_:1},8,["disabled","model"])]),_:1},8,["header"]),u("div",Za,[j.value?(p(),S(m,{key:0,type:"primary",onClick:k[15]||(k[15]=I=>j.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:1})):(p(),S(m,{key:1,type:"primary",onClick:b},{default:a(()=>[s(o(t(l)("app.webui.save")),1)]),_:1}))])],64)}}}),Ra={style:{"font-weight":"lighter","font-size":"17px"}},Xa={style:{display:"flex","justify-content":"space-around"}},Qa={style:{display:"flex",width:"80%",gap:"1%"}},Oa={key:0},Ya={key:1},Ja={key:2},Wa={key:3},Ka={slot:"footer",class:"dialog-footer"},et={slot:"footer",class:"dialog-footer"},lt=de({__name:"ScoreRule",setup(ne){const{t:l}=pe(),j=g({data:[{id:1,type:1,rule:"XrayNucleiGobyPoc",score:20,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:2,type:1,rule:"XrayNucleiGobyPoc",score:10,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:3,type:1,rule:"PayloadPoc",score:5,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:4,type:2,rule:"XrayNucleiGobyExp",score:30,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:5,type:2,rule:"XrayNucleiGobyExp",score:15,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:6,type:2,rule:"XrayNucleiGobyExp",score:5,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:7,type:3,rule:" 5000",score:30,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"}]});g({});const E=g(""),_=[],x=g(1),V=g(15),b=g(0),y=g(!1),k=g(!1),U=g({}),C=g([{id:1,type:l("app.webui.pocscorerule")},{id:2,type:l("app.webui.exprule")},{id:3,type:l("app.webui.incidencerule")},{id:4,type:l("app.webui.otherrule")}]),M=g(!0),Z=n=>{M.value=n.id,n.length>0?M.value=!1:M.value=!0},H=(n,i)=>{U.value.id=i.id,U.value.type=i.type,U.value.rule=i.rule,U.value.score=i.score,U.value.coefficient=i.coefficient,k.value=!0};function q(n,i){const h=new Date(n.create_time),f=new Date(i.create_time);return h<f?-1:h>f?1:0}const A=ge(()=>{const i=0+V.value;if(console.log(j.value),E.value.trim()!="")return j.value.data.filter(h=>h.name.toLowerCase().includes(E.value.toLowerCase()));try{return j.value.data.slice(0,i)}catch{return[]}});function m(n){V.value=n,x.value=1,K()}async function I(n){x.value=n,await K()}re(()=>{_.forEach(n=>{n()})});async function K(){try{const n=await O.get(`/api/v1/getvulnlist?page=${x.value}&limit=${V.value}`);j.value=n.data,b.value=n.data.total,typefilter.value=n.data.data.reduce((i,h)=>(i.some(f=>f.value===h.vuln_type)||i.push({text:h.vuln_type,value:h.vuln_type}),i),[])}catch{}}function G(){fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{P({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const Q=(n,i)=>{fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{P({type:"success",message:l("app.webui.deletecomplete")}),console.log(n,i)}).catch(()=>{})},ee=(n,i)=>i.type===n,ae=()=>{U.value={id:null,type:1,rule:"",score:null,coefficient:1}},oe=()=>{console.log(U.value),y.value=!1},z=()=>{console.log(U.value),k.value=!1};return(n,i)=>{const h=be,f=_e,r=Ve,T=xe,R=ke,Y=ce,J=Ue,F=$e,$=ze,te=Se,N=Me;return p(),L(le,null,[u("div",null,[e(Y,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",Ra,[u("div",Xa,[u("div",Qa,[e(h,{modelValue:E.value,"onUpdate:modelValue":i[0]||(i[0]=v=>E.value=v),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(f,{type:"primary",onClick:i[1]||(i[1]=v=>y.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.add")),1)]),_:1}),e(f,{disabled:M.value,type:"danger",onClick:G},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(T,{data:A.value,onSelectionChange:Z},{default:a(()=>[e(r,{type:"selection",width:"55"}),e(r,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"80"},null,8,["label"]),e(r,{label:t(l)("app.webui.type"),filters:[{text:t(l)("app.webui.pocscorerule"),value:1},{text:t(l)("app.webui.exprule"),value:2},{text:t(l)("app.webui.incidencerule"),value:3},{text:t(l)("app.webui.otherrule"),value:4}],"filter-method":ee,width:"140"},{default:a(({row:v})=>[v.type==1?(p(),L("span",Oa,o(t(l)("app.webui.pocscorerule")),1)):v.type==2?(p(),L("span",Ya,o(t(l)("app.webui.exprule")),1)):v.type==3?(p(),L("span",Ja,o(t(l)("app.webui.incidencerule")),1)):(p(),L("span",Wa,o(t(l)("app.webui.otherrule")),1))]),_:1},8,["label","filters"]),e(r,{prop:"rule",label:t(l)("app.webui.scorerule")},null,8,["label"]),e(r,{prop:"score",label:t(l)("app.webui.score"),width:"120"},null,8,["label"]),e(r,{prop:"coefficient",label:t(l)("app.webui.coefficient"),width:"120"},null,8,["label"]),e(r,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":q,width:"140"},{default:a(({row:v})=>[u("span",null,o(t(ue)(v.create_time)),1)]),_:1},8,["label"]),e(r,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":q,width:"140"},{default:a(({row:v})=>[u("span",null,o(t(ue)(v.update_time)),1)]),_:1},8,["label"]),e(r,{label:t(l)("app.webui.operate"),width:"140"},{default:a(v=>[e(f,{size:"small",type:"primary",onClick:d=>H(v.$index,v.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(f,{size:"small",type:"danger",onClick:d=>Q(v.$index,v.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(R,{"page-sizes":[15,25,50,100,200,300],"page-size":V.value,"onUpdate:pageSize":i[2]||(i[2]=v=>V.value=v),layout:"total, sizes, prev, pager, next, jumper",total:b.value,onSizeChange:m,onCurrentChange:I,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(N,{title:t(l)("app.webui.addscore"),modelValue:y.value,"onUpdate:modelValue":i[8]||(i[8]=v=>y.value=v),width:"30%",onClose:ae},{default:a(()=>[e(te,{model:U.value,"label-width":"100px"},{default:a(()=>[e($,{label:t(l)("app.webui.type")},{default:a(()=>[e(F,{modelValue:U.value.type,"onUpdate:modelValue":i[3]||(i[3]=v=>U.value.type=v),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(p(!0),L(le,null,se(C.value,v=>(p(),S(J,{key:v.id,label:v.type,value:v.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(h,{modelValue:U.value.rule,"onUpdate:modelValue":i[4]||(i[4]=v=>U.value.rule=v),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.score")},{default:a(()=>[e(h,{modelValue:U.value.score,"onUpdate:modelValue":i[5]||(i[5]=v=>U.value.score=v),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(h,{modelValue:U.value.coefficient,"onUpdate:modelValue":i[6]||(i[6]=v=>U.value.coefficient=v),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",Ka,[e(f,{onClick:i[7]||(i[7]=v=>y.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(f,{type:"primary",onClick:oe},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(N,{title:t(l)("app.webui.editscore"),modelValue:k.value,"onUpdate:modelValue":i[14]||(i[14]=v=>k.value=v),width:"30%",onClose:ae},{default:a(()=>[e(te,{model:U.value,"label-width":"100px"},{default:a(()=>[e($,{label:t(l)("app.webui.type")},{default:a(()=>[e(F,{modelValue:U.value.type,"onUpdate:modelValue":i[9]||(i[9]=v=>U.value.type=v),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(p(!0),L(le,null,se(C.value,v=>(p(),S(J,{key:v.id,label:v.type,value:v.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(h,{modelValue:U.value.rule,"onUpdate:modelValue":i[10]||(i[10]=v=>U.value.rule=v),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.score")},{default:a(()=>[e(h,{modelValue:U.value.score,"onUpdate:modelValue":i[11]||(i[11]=v=>U.value.score=v),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(h,{modelValue:U.value.coefficient,"onUpdate:modelValue":i[12]||(i[12]=v=>U.value.coefficient=v),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",et,[e(f,{onClick:i[13]||(i[13]=v=>k.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(f,{type:"primary",onClick:z},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),at=ye(lt,[["__scopeId","data-v-8d0af99d"]]),tt={style:{"font-weight":"lighter","font-size":"17px"}},ot={style:{display:"flex","justify-content":"space-around"}},ut={style:{display:"flex",width:"80%",gap:"1%"}},nt={slot:"footer",class:"dialog-footer"},it={slot:"footer",class:"dialog-footer"},st=de({__name:"VulnType",setup(ne){const{t:l}=pe(),j=g({}),E=g(""),_=g(sessionStorage.getItem("token")),x=[G],V=g(1),b=g(15),y=g(0),k=g(!1),U=g(!1),C=g({}),M=g(!0),Z=z=>{M.value=z.id,z.length>0?M.value=!1:M.value=!0},H=(z,n)=>{C.value.id=n.id,C.value.name=n.name,U.value=!0},q=()=>{C.value.id=null,C.value.name=""};function A(z,n){const i=new Date(z.create_time),h=new Date(n.create_time);return i<h?-1:i>h?1:0}const m=ge(()=>{const n=0+b.value;if(console.log(j.value),E.value.trim()!="")return j.value.data.filter(i=>i.name.toLowerCase().includes(E.value.toLowerCase()));try{return j.value.data.slice(0,n)}catch{return[]}});function I(z){b.value=z,V.value=1,G()}async function K(z){V.value=z,await G()}re(()=>{x.forEach(z=>{z()})});async function G(){console.log(j.value);try{const z=await O.get(`/api/v1/getvulntype?page=${V.value}&limit=${b.value}`);j.value=z.data,y.value=z.data.total,console.log(j.value)}catch{}}function Q(){fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{P({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const ee=(z,n)=>{fe.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{P({type:"success",message:l("app.webui.deletecomplete")}),console.log(z,n)}).catch(()=>{})};async function ae(){console.log(C.value);try{const z={headers:{Authorization:"Bearer "+_.value}},n=await O.post("/api/v1/addvulntype",C.value,z);if(console.log(n),n.data.code==1){P({type:"success",message:l("app.webui.addsuccess")}),G(),k.value=!1;return}else if(n.data.code==2){P({type:"error",message:l("app.webui.invalidinput")});return}else if(n.data.code==3){P({type:"error",message:l("app.webui.addfail")});return}}catch{}}const oe=()=>{console.log(C.value);try{const z={headers:{Authorization:"Bearer "+_.value}},n=O.post("/api/v1/updatevulntype",C.value,z);if(console.log(n),n.data.code==1){P({type:"success",message:l("app.webui.modifysucc")}),G(),U.value=!1;return}else if(n.data.code==2){P({type:"error",message:l("app.webui.invalidinput")});return}else if(n.data.code==3){P({type:"error",message:l("app.webui.modifyfail")});return}}catch{}};return(z,n)=>{const i=be,h=_e,f=Ve,r=xe,T=ke,R=ce,Y=ze,J=Se,F=Me;return p(),L(le,null,[u("div",null,[e(R,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",tt,[u("div",ot,[u("div",ut,[e(i,{modelValue:E.value,"onUpdate:modelValue":n[0]||(n[0]=$=>E.value=$),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(h,{type:"primary",onClick:n[1]||(n[1]=$=>k.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.add")),1)]),_:1}),e(h,{disabled:M.value,type:"danger",onClick:Q},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(r,{data:m.value,onSelectionChange:Z},{default:a(()=>[e(f,{type:"selection",width:"55"}),e(f,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(f,{prop:"name",label:t(l)("app.webui.name")},null,8,["label"]),e(f,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":A},{default:a(({row:$})=>[u("span",null,o(t(ue)($.create_time)),1)]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":A},{default:a(({row:$})=>[u("span",null,o(t(ue)($.update_time)),1)]),_:1},8,["label"]),e(f,{label:t(l)("app.webui.operate")},{default:a($=>[e(h,{size:"small",type:"primary",onClick:te=>H($.$index,$.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(h,{size:"small",type:"danger",onClick:te=>ee($.$index,$.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(T,{"page-sizes":[15,25,50,100,200,300],"page-size":b.value,"onUpdate:pageSize":n[2]||(n[2]=$=>b.value=$),layout:"total, sizes, prev, pager, next, jumper",total:y.value,onSizeChange:I,onCurrentChange:K,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(F,{title:t(l)("app.webui.addvulntype"),modelValue:k.value,"onUpdate:modelValue":n[5]||(n[5]=$=>k.value=$),width:"30%",onClose:q},{default:a(()=>[e(J,{model:C.value,"label-width":"100px"},{default:a(()=>[e(Y,{label:t(l)("app.webui.name")},{default:a(()=>[e(i,{modelValue:C.value.name,"onUpdate:modelValue":n[3]||(n[3]=$=>C.value.name=$),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",nt,[e(h,{onClick:n[4]||(n[4]=$=>k.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(h,{type:"primary",onClick:ae},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(F,{title:t(l)("app.webui.editvulntype"),modelValue:U.value,"onUpdate:modelValue":n[9]||(n[9]=$=>U.value=$),width:"30%",onClose:q},{default:a(()=>[e(J,{model:C.value,"label-width":"100px"},{default:a(()=>[e(Y,{label:t(l)("app.webui.id")},{default:a(()=>[e(i,{modelValue:C.value.id,"onUpdate:modelValue":n[6]||(n[6]=$=>C.value.id=$),autocomplete:"off",disabled:"true"},null,8,["modelValue"])]),_:1},8,["label"]),e(Y,{label:t(l)("app.webui.name")},{default:a(()=>[e(i,{modelValue:C.value.name,"onUpdate:modelValue":n[7]||(n[7]=$=>C.value.name=$),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",it,[e(h,{onClick:n[8]||(n[8]=$=>U.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(h,{type:"primary",onClick:oe},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),dt=ye(st,[["__scopeId","data-v-f13eabdc"]]),pt={style:{display:"flex"}},rt={style:{"margin-top":"20px","font-size":"14px"}},ct={style:{"margin-top":"20px","font-size":"14px"}},vt={style:{"margin-top":"20px","font-size":"14px"}},mt=de({__name:"Profile",setup(ne){const{t:l}=pe(),j=sessionStorage.getItem("token"),E=g({}),_=g(!0),x=[b],V=g(sessionStorage.getItem("avatar"));re(()=>{x.forEach(H=>{H()})});async function b(){try{const H={headers:{Authorization:`Bearer ${j}`}},q=await O.get("/api/v1/userinfo",H);E.value=q.data.data,j&&q.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload())}catch{}}const y=H=>{V.value=URL.createObjectURL(H)},k=H=>{P.success(l("app.webui.uploadsucc")),sessionStorage.setItem("avatar","/download/file?id="+H.data),location.reload()},U=()=>{if(!E.value.email.match(/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)){P.error(l("app.webui.emailformat"));return}M()},C=()=>{if(!E.value.phone.match(/^[1][3,4,5,6,7,8,9][0-9]{9}$/)){P.error(l("app.webui.phoneformat"));return}M()},M=()=>{_.value=!1},Z=async()=>{console.log(E.value);try{const H={headers:{Authorization:`Bearer ${j}`}},q={username:E.value.username,email:E.value.email,phone:E.value.phone},A=await O.post("/api/v1/updateuserinfo",q,H);A.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):A.data.code==1?P.success(l("app.webui.modifysucc")):P.error(l("app.webui.modifyerr"))}catch(H){console.error(H)}};return(H,q)=>{const A=Ge,m=Ze,I=be,K=_e,G=ce;return p(),L("div",null,[e(G,{style:{padding:"30px"},header:t(l)("app.webui.myprofile")},{default:a(()=>[u("div",pt,[e(m,{accept:".png,.jpg",action:"/api/v1/updateavatar","on-success":k,headers:{Authorization:`Bearer ${t(j)}`},"before-upload":y},{default:a(()=>[e(A,{size:"large",src:V.value},null,8,["src"])]),_:1},8,["headers"])]),u("div",rt,o(t(l)("app.webui.username")),1),e(I,{modelValue:E.value.username,"onUpdate:modelValue":q[0]||(q[0]=Q=>E.value.username=Q),size:"large",placeholder:E.value.username,style:{"margin-top":"10px"},onChange:M},null,8,["modelValue","placeholder"]),u("div",ct,o(t(l)("app.webui.email")),1),e(I,{modelValue:E.value.email,"onUpdate:modelValue":q[1]||(q[1]=Q=>E.value.email=Q),size:"large",placeholder:E.value.email,style:{"margin-top":"10px"},onChange:U},null,8,["modelValue","placeholder"]),u("div",vt,o(t(l)("app.webui.phone")),1),e(I,{modelValue:E.value.phone,"onUpdate:modelValue":q[2]||(q[2]=Q=>E.value.phone=Q),size:"large",placeholder:E.value.phone,style:{"margin-top":"10px"},onChange:C},null,8,["modelValue","placeholder"]),e(K,{type:"primary",style:{"margin-top":"20px"},disabled:_.value,onClick:Z},{default:a(()=>[s(o(t(l)("app.webui.modify")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}}),ft={style:{"margin-top":"50%"}},bt={style:{display:"flex",margin:"auto",cursor:"pointer"}},_t={style:{width:"100%"}},yt={style:{cursor:"pointer","margin-left":"auto"}},wt={style:{display:"flex","align-items":"center"}},ht={key:0},gt={key:1},Vt={key:2},xt={key:3},kt={key:4},Ct={key:5},$t={key:6},zt={key:7},St={key:8},Ut=de({__name:"Index",setup(ne){const{t:l,locale:j}=pe(),E=g(!1),_=H=>{j.value=H,localStorage.setItem("selectedLanguage",H),b.value="1"},x=sessionStorage.getItem("username"),V=sessionStorage.getItem("avatar"),b=g("1"),y=g(!1);function k(){y.value=!y.value}function U(H){b.value=H}const C=ul();re(M);function M(){sessionStorage.getItem("token")||C.push("/login")}function Z(H){H==1&&(b.value="",E.value=!0),H==2&&(sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("avatar"),location.reload())}return(H,q)=>{const A=Ce,m=vl,I=ml,K=fl,G=Ge,Q=bl,ee=_l,ae=yl,oe=wl,z=hl,n=nl;return p(),L("div",null,[e(n,null,{default:a(()=>[e(K,{collapse:y.value,class:"el-menu-vertical-demo",onSelect:U},{default:a(()=>[q[6]||(q[6]=u("div",{style:{display:"flex",margin:"auto",height:"50px",width:"50px"}},[u("img",{src:gl,fit:"contain"})],-1)),u("div",ft,[e(m,{index:"1"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(il))]),_:1}),u("span",null,o(t(l)("app.webui.dashboard")),1)]),_:1}),e(m,{index:"2"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(sl))]),_:1}),u("span",null,o(t(l)("app.webui.systemsetting")),1)]),_:1}),e(m,{index:"3"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(dl))]),_:1}),u("span",null,o(t(l)("app.webui.usermanager")),1)]),_:1}),e(I,{index:"4"},{title:a(()=>[e(A,null,{default:a(()=>q[2]||(q[2]=[u("svg",{t:"1728359731855",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1480",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"1481",fill:"#515151"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"1482",fill:"#515151"})],-1)])),_:1}),u("span",null,o(t(l)("app.webui.vulnmanager")),1)]),default:a(()=>[e(m,{index:"4-1"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(Ee))]),_:1}),u("span",null,o(t(l)("app.webui.vulntype")),1)]),_:1}),e(m,{index:"4-2"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(Ee))]),_:1}),u("span",null,o(t(l)("app.webui.allvuln")),1)]),_:1}),e(m,{index:"4-3"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(Ee))]),_:1}),u("span",null,o(t(l)("app.webui.unaudit")),1)]),_:1}),e(m,{index:"4-4"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(Ee))]),_:1}),u("span",null,o(t(l)("app.webui.audited")),1)]),_:1})]),_:1}),e(m,{index:"5"},{default:a(()=>[e(A,null,{default:a(()=>[e(t(pl))]),_:1}),u("span",null,o(t(l)("app.webui.scorerule")),1)]),_:1}),e(I,{index:"6"},{title:a(()=>[q[3]||(q[3]=u("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em","data-v-f414ea64":"",class:"el-icon"},[u("path",{fill:"currentColor",d:"m18.5 10l4.4 11h-2.155l-1.201-3h-4.09l-1.199 3h-2.154L16.5 10h2zM10 2v2h6v2h-1.968a18.222 18.222 0 0 1-3.62 6.301a14.864 14.864 0 0 0 2.336 1.707l-.751 1.878A17.015 17.015 0 0 1 9 13.725a16.676 16.676 0 0 1-6.201 3.548l-.536-1.929a14.7 14.7 0 0 0 5.327-3.042A18.078 18.078 0 0 1 4.767 8h2.24A16.032 16.032 0 0 0 9 10.877a16.165 16.165 0 0 0 2.91-4.876L2 6V4h6V2h2zm7.5 10.885L16.253 16h2.492L17.5 12.885z"})],-1)),u("span",null,o(t(l)("app.webui.language")),1)]),default:a(()=>[e(m,{index:"11-1",onClick:q[0]||(q[0]=i=>_("zh-CN"))},{default:a(()=>q[4]||(q[4]=[s("")])),_:1}),e(m,{index:"11-2",onClick:q[1]||(q[1]=i=>_("en-US"))},{default:a(()=>q[5]||(q[5]=[s("English")])),_:1})]),_:1}),u("div",bt,[y.value?(p(),S(A,{key:1,onClick:k,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(cl))]),_:1})):(p(),S(A,{key:0,onClick:k,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(rl))]),_:1}))])])]),_:1},8,["collapse"]),u("div",_t,[e(oe,{style:{"background-color":"#393939",display:"flex","justify-content":"flex-end","align-items":"center",padding:"10px"}},{default:a(()=>[u("div",yt,[e(ae,{style:{color:"#fff"},trigger:"click",onCommand:Z},{dropdown:a(()=>[e(ee,null,{default:a(()=>[e(Q,{command:"1"},{default:a(()=>[s(o(t(l)("app.webui.myprofile")),1)]),_:1}),e(Q,{command:"2"},{default:a(()=>[s(o(t(l)("app.webui.logout")),1)]),_:1})]),_:1})]),default:a(()=>[u("span",wt,[e(G,{style:{"margin-right":"10px"},src:t(V)},null,8,["src"]),s(" "+o(t(x)),1)])]),_:1})])]),_:1}),e(z,null,{default:a(()=>[b.value==="1"?(p(),L("div",ht,[e(Ul)])):b.value==="2"?(p(),L("div",gt,[e(Ga)])):b.value==="3"?(p(),L("div",Vt,[e(Al)])):b.value==="4-1"?(p(),L("div",xt,[e(dt)])):b.value==="4-2"?(p(),L("div",kt,[e(na)])):b.value==="4-3"?(p(),L("div",Ct,[e(Ca)])):b.value==="4-4"?(p(),L("div",$t,[e(Na)])):b.value==="5"?(p(),L("div",zt,[e(at)])):E.value?(p(),L("div",St,[e(mt)])):qe("",!0)]),_:1})])]),_:1})])}}}),Bt=ye(Ut,[["__scopeId","data-v-91fe8c71"]]);export{Bt as default};
