import{d as ve,u as fe,a as ll,r as b,o as me,b as r,c as M,e as n,f as e,w as a,t as o,g as t,F as ue,E as al,h as be,i as Ie,j as tl,k as ol,l as ul,m as ze,n as s,p as C,q as ce,s as Ve,v as z,x as we,y as he,z as Se,A as He,B as Ue,C as qe,D as Le,G as Ee,H as Be,I as De,J as Fe,K as Me,_ as ke,L as nl,M as re,N as Ce,O as sl,P as il,Q as Oe,R as Pe,S as Te,T as Ne,U as Xe,V as dl,W as rl,X as pl,Y as cl,Z as vl,$ as Ae,a0 as fl,a1 as ml,a2 as bl,a3 as _l,a4 as yl,a5 as wl,a6 as hl,a7 as gl,a8 as Vl,a9 as xl,aa as kl}from"./index-PUrVetuF.js";import{a as X}from"./el-message-ZkJEpQUo.js";/* empty css                     */const $l="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='37.07'%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20198'%3e%3cpath%20fill='%2341B883'%20d='M204.8%200H256L128%20220.8L0%200h97.92L128%2051.2L157.44%200h47.36Z'%3e%3c/path%3e%3cpath%20fill='%2341B883'%20d='m0%200l128%20220.8L256%200h-51.2L128%20132.48L50.56%200H0Z'%3e%3c/path%3e%3cpath%20fill='%2335495E'%20d='M50.56%200L128%20133.12L204.8%200h-47.36L128%2051.2L97.92%200H50.56Z'%3e%3c/path%3e%3c/svg%3e",Cl={style:{display:"flex","justify-content":"center"}},zl={style:{display:"flex","justify-content":"center"}},Sl={style:{display:"flex","justify-content":"center"}},Ul={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},ql={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},El={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Bl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Il=ve({__name:"Dashboard",setup(de){const{t:l}=fe(),H=ll(),q=b({}),c=b({}),g=[{color:"#20a53a",percentage:30},{color:"orange",percentage:60},{color:"red",percentage:100}],_=[x,d];let E=setInterval(d,3e3);me(()=>{_.forEach(F=>{F()})});async function d(){const F=sessionStorage.getItem("token");try{const $={headers:{Authorization:`Bearer ${F}`}},y=await X.get("/api/v1/getsystemstatus",$);y.data.code!=1&&(clearInterval(E),sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),H.push("/login")),q.value=y.data.data}catch{}}async function x(){try{const F=await X.get("/api/v1/getvulnabs");c.value=F.data}catch{}}return(F,$)=>{const y=al,T=be,N=Ie,P=tl,O=ol,G=ul;return r(),M(ue,null,[n("div",null,[e(T,{style:{"margin-top":"1%"},header:t(l)("app.webui.systemstatus"),"body-style":"display: flex; justify-content: space-around;"},{default:a(()=>[n("div",null,[n("span",Cl,o(t(l)("app.webui.cpuuse")),1),e(y,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:q.value.cpu,color:g},null,8,["percentage"])]),n("div",null,[n("span",zl,o(t(l)("app.webui.ramuse")),1),e(y,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:q.value.mem,color:g},null,8,["percentage"])]),n("div",null,[n("span",Sl,o(t(l)("app.webui.diskuse")),1),e(y,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:q.value.disk,color:g},null,8,["percentage"])])]),_:1},8,["header"]),e(T,{header:t(l)("app.webui.vulnstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(P,{justify:"start"},{default:a(()=>[e(T,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.totalvuln")),1),e(N,{size:"25"},{default:a(()=>$[0]||($[0]=[n("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[n("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),n("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:c.value.total},null,8,["value"]),n("div",Ul,[n("span",null,o(t(l)("app.webui.weeklyadditions")),1),n("span",null,o(c.value.weeklyAdditionsVuln),1)])]),_:1})]),_:1}),e(T,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.totalpoc")),1),e(N,{size:"25"},{default:a(()=>$[1]||($[1]=[n("svg",{t:"1727429978264",class:"icon",viewBox:"0 0 1161 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"20805",width:"200",height:"200"},[n("path",{d:"M258.205538 354.461538c10.436923 0 18.924308 8.467692 18.924308 18.944v624.836924c0 10.456615-8.467692 18.944-18.924308 18.944H177.289846a18.944 18.944 0 0 1-18.924308-18.944v-624.836924c0-10.476308 8.467692-18.944 18.924308-18.944h80.915692z m158.365539 120.497231c10.436923 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944h-80.915692a18.944 18.944 0 0 1-18.924308-18.944V493.883077c0-10.436923 8.467692-18.924308 18.924308-18.924308h80.915692z m-316.731077 0c10.456615 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944H18.944A18.944 18.944 0 0 1 0 998.242462V493.883077c0-10.436923 8.467692-18.924308 18.944-18.924308H99.84z m139.421538-82.628923H196.214154v586.988308h43.047384V392.329846z m158.365539 120.477539h-43.027692V979.298462h43.027692V512.787692z m-316.731077 0H37.868308V979.298462h43.027692V512.787692zM1063.384615 0a98.461538 98.461538 0 0 1 98.461539 98.461538v748.307693a98.461538 98.461538 0 0 1-98.461539 98.461538H492.307692V433.230769a39.384615 39.384615 0 0 0-36.430769-39.286154L452.923077 393.846154h-98.461539v-59.076923a39.384615 39.384615 0 0 0-36.430769-39.286154L315.076923 295.384615h-98.461538V98.461538a98.461538 98.461538 0 0 1 98.461538-98.461538h748.307692z m-142.867692 520.664615c-44.898462 0-78.769231 14.572308-102.4 44.504616-21.267692 26.387692-31.507692 60.258462-31.507692 102.006154 0 42.535385 9.846154 76.406154 30.326154 101.612307 23.236923 29.144615 57.895385 44.110769 103.975384 44.11077 30.326154 0 56.32-8.664615 77.981539-25.993847 23.236923-18.510769 37.809231-44.110769 44.110769-76.8h-41.747692l-1.476923 5.395693c-5.710769 19.377231-15.064615 34.126769-28.061539 44.228923-13.390769 10.24-30.72 15.36-51.2 15.36-31.507692 0-54.744615-9.846154-69.710769-29.538462-14.178462-18.510769-21.267692-44.504615-21.267692-78.375384 0-32.689231 7.089231-58.683077 21.661538-77.587693 15.36-20.873846 38.203077-31.113846 68.529231-31.113846 20.48 0 37.021538 4.332308 50.412307 13.390769 13.390769 9.058462 22.449231 23.236923 27.175385 42.141539h41.747692l-0.984615-5.592616c-5.060923-25.796923-17.329231-46.710154-36.430769-62.148923-21.267692-17.329231-48.443077-25.6-81.132308-25.6z m-30.956308-413.538461c-42.929231 0-76.8 13.784615-101.218461 42.141538-23.630769 26.781538-35.052308 61.44-35.052308 104.369231 0 42.535385 11.421538 77.193846 35.052308 103.975385 24.418462 27.569231 58.289231 41.747692 101.218461 41.747692 42.535385 0 76.406154-13.784615 101.218462-41.353846 23.630769-26.781538 35.446154-61.44 35.446154-104.369231 0-43.323077-11.815385-78.375385-35.446154-104.763077-24.812308-27.963077-58.683077-41.747692-101.218462-41.747692z m-292.489846 5.513846H480.492308V393.846154h42.92923v-109.489231h72.861539l5.395692-0.059077c63.763692-1.516308 95.822769-30.247385 95.822769-86.193231 0-57.107692-33.476923-85.464615-100.430769-85.464615z m292.470154 32.295385c29.932308 0 53.169231 9.452308 69.316923 29.144615 15.753846 19.298462 24.024615 45.686154 24.024616 79.556923 0 33.476923-8.270769 59.864615-24.024616 78.769231-16.147692 19.298462-39.384615 29.144615-69.316923 29.144615s-53.169231-10.24-69.710769-29.932307c-15.753846-19.298462-23.630769-45.292308-23.630769-77.981539 0-33.083077 7.876923-59.076923 23.630769-78.375385 16.541538-20.48 39.778462-30.326154 69.710769-30.326153z m-296.014769 4.332307c20.873846 0 36.233846 3.938462 46.08 11.815385 9.846154 7.089231 14.966154 19.692308 14.966154 37.021538 0 17.329231-5.12 29.932308-14.572308 37.809231-9.846154 7.876923-25.206154 11.815385-46.473846 11.815385h-70.104616v-98.461539z","p-id":"20806",fill:"#ed5565"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:c.value.hasPoc},null,8,["value"]),n("div",ql,[n("span",null,o(t(l)("app.webui.weeklyadditionspoc")),1),n("span",null,o(c.value.weeklyAdditionsPoc),1)])]),_:1})]),_:1}),e(T,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.totalexp")),1),e(N,{size:"25"},{default:a(()=>$[2]||($[2]=[n("svg",{t:"1727429727880",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13778",width:"200",height:"200"},[n("path",{d:"M676.408889 303.407407l-101.262222-175.976296c-132.437333-40.201481-114.801778 130.085926-203.207111 168.846222L303.407407 246.708148C347.477333 160.274963 387.337481 83.057778 429.283556 0h206.582518L758.518519 235.747556 676.408889 303.407407zM127.393185 493.037037l80.327111 61.477926c-28.899556 61.060741-55.48563 117.380741-82.223407 173.018074 29.430519 138.657185 149.238519 47.824593 215.836444 103.917037V910.222222H94.966519L0 735.156148 127.393185 493.037037zM1024 735.004444L925.999407 910.222222H682.666667v-79.568592c68.342519-48.279704 171.956148 24.045037 212.574814-97.583408l-83.133629-184.395852L895.089778 493.037037 1024 735.004444zM0 387.640889L101.793185 189.62963 303.407407 422.874074l-12.818963 32.237037L0 387.640889zM1024 358.362074L739.745185 417.185185 720.592593 392.836741 919.210667 189.62963 1024 358.362074zM417.185185 1024l80.402963-263.661037 26.699852-1.820444L606.814815 1024h-189.62963z",fill:"#1296db","p-id":"13779"}),n("path",{d:"M606.814815 455.111111h-189.62963v-75.851852h189.62963v75.851852zM682.666667 568.888889H341.333333v-75.851852h341.333334v75.851852zM796.444444 682.666667H227.555556v-75.851852h568.888888v75.851852z",fill:"#1296db","p-id":"13780"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:c.value.hasExp},null,8,["value"]),n("div",El,[n("span",null,o(t(l)("app.webui.weeklyadditionsexp")),1),n("span",null,o(c.value.weeklyAdditionsExp),1)])]),_:1})]),_:1}),e(T,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.totalproduct")),1),e(N,{size:"25"},{default:a(()=>$[3]||($[3]=[n("svg",{t:"1727429889519",class:"icon",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17925",width:"200",height:"200"},[n("path",{d:"M302.32811 504.78l-146.944-88.063c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048zM459.00011 1020.878c5.888 1.792 12.544 1.28 18.688-2.304-5.632 3.072-12.288 4.096-18.688 2.304zM302.32811 504.78l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z",fill:"#3CBF71","p-id":"17926"}),n("path",{d:"M477.68811 1018.547c-6.144 3.584-12.8 4.096-18.688 2.304 6.4 1.818 13.056 0.794 18.688-2.304z",fill:"#3CBF71","p-id":"17927"}),n("path",{d:"M490.64111 954.112V511.744L880.27311 290.56l39.885-24.166c7.987-5.197 9.498-11.802 10.547-16.538 1.024-9.728-3.584-19.968-13.568-25.088L476.81711 4.608c-7.168-3.584-15.36-3.584-22.528 0L13.97011 224.768C-2.41489 235.52 0.14511 259.328 0.14511 261.888v469.76c0 8.704 4.608 16.896 12.032 21.504 0 0 430.848 260.352 438.272 263.68 15.104 7.424 24.576 5.376 31.744 1.792l143.36-82.944a25.56 25.56 0 0 0 9.216-35.072c-6.912-12.288-22.784-16.384-34.816-9.472l-99.072 57.6v-0.256l-10.24 5.632m-50.176-442.368v441.088l-390.4-235.264v-427.52l390.4 221.696z m25.088-43.52L78.22511 248.576 465.55311 55.04l387.328 193.536-387.328 219.648z",fill:"#3CBF71","p-id":"17928"}),n("path",{d:"M812.94511 917.376l201.984-121.344c5.632-3.584 9.216-9.728 9.216-16.64V556.928c0-7.834-5.888-13.312-12.288-16.384l-5.12-2.56c-0.512-0.256-1.28-0.256-1.792-0.256h1.536L810.13011 439.68c-5.376-2.56-11.776-2.56-17.152 0l-196.096 98.048c-14.336 5.504-17.92 17.792-17.92 24.704v216.96c0 6.912 3.584 13.056 9.472 16.64 0 0 200.167 120.09 201.19 120.346 0 0.025 11.93 8.857 23.322 0.998z m-30.464-49.152l-165.12-99.584V589.696l165.12 93.44v185.088z m19.2-218.112L640.65711 558.72l161.024-80.384L962.45011 558.72l-160.768 91.392zM985.74511 768.64l-164.864 99.328V683.136l164.864-93.44V768.64z",fill:"#3CBF71","p-id":"17929"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:c.value.affectedProduct},null,8,["value"]),n("div",Bl,[n("span",null,o(t(l)("app.webui.weeklyadditionsproduct")),1),n("span",null,o(c.value.weeklyAdditionsProduct),1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])]),e(T,{header:t(l)("app.webui.userstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(P,{justify:"start"},{default:a(()=>[e(T,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.totaladmin")),1)]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:q.value.admintotal},null,8,["value"])]),_:1})]),_:1}),e(T,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.totaluser")),1)]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:q.value.usertotal},null,8,["value"])]),_:1})]),_:1}),e(T,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(P,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[n("span",null,o(t(l)("app.webui.onlineuser")),1)]),_:1})]),default:a(()=>[e(G,null,{default:a(()=>[e(O,{value:q.value.onlineuser},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])],64)}}});function ie(de){const l=new Date(de),H=l.getFullYear(),q=(l.getMonth()+1).toString().padStart(2,"0"),c=l.getDate().toString().padStart(2,"0");return`${H}-${q}-${c}`}const Ll={style:{"font-weight":"lighter","font-size":"17px"}},Ml={style:{display:"flex","justify-content":"space-around"}},Al={style:{display:"flex",width:"80%",gap:"1%"}},Hl={key:0},jl={key:1},Dl={class:"status"},Fl={slot:"footer",class:"dialog-footer"},Pl={slot:"footer",class:"dialog-footer"},Tl=ve({__name:"Userlist",setup(de){const{t:l}=fe(),H=b({}),q=b([{id:1,label:l("app.webui.admin")},{id:0,label:l("app.webui.user")}]),c=b(""),g=sessionStorage.getItem("token"),_=b(!1),E=b(!1),d=b({}),x=[le],F=b(1),$=b(15),y=b(0),T=b([]),N=b(!0),P=b(""),O=i=>{T.value=i,i.length>0?N.value=!1:N.value=!0},G=ze(()=>{const p=0+$.value;if(c.value.trim()!="")return H.value.data.filter(R=>R.username.toLowerCase().includes(c.value.toLowerCase())||R.email.toLowerCase().includes(c.value.toLowerCase())||R.phone.includes(c.value));try{return H.value.data.slice(0,p)}catch{return[]}});function k(i){$.value=i,F.value=1,le()}async function w(i){F.value=i,await le()}me(()=>{x.forEach(i=>{i()})});async function le(){try{const i={headers:{Authorization:`Bearer ${g}`}},p=await X.get(`/api/v1/getusers?page=${F.value}&limit=${$.value}`,i);p.data.code!=1&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username")),H.value=p.data,y.value=p.data.total}catch{}}function W(){Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const i={ids:T.value.map(p=>p.id)};try{const p={headers:{Authorization:`Bearer ${g}`}},R=await X.post("/api/v1/multidelusers",i,p);R.data.code==1?(z.success(l("app.webui.delsuccess")),le(),N.value=!1):R.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})}const ne=(i,p)=>{d.value.id=p.id,d.value.role=p.role,d.value.username=p.username,d.value.password=p.password,d.value.email=p.email,d.value.phone=p.phone,d.value.status=p.status==1,E.value=!0},se=(i,p)=>p.role===i,te=(i,p)=>p.status===i,j=(i,p)=>{Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{try{const R={headers:{Authorization:`Bearer ${g}`}},S=await X.post("/api/v1/deluser",{userid:p.id},R);S.data.code==1?(le(),z.success(l("app.webui.deletecomplete"))):S.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})},v=()=>{d.value.id=null,d.value.role=null,d.value.username="",d.value.password="",d.value.email="",d.value.phone="",d.value.status=null,P.value=""};async function V(){if(d.value.role==null){z.error(l("app.webui.roleisnull"));return}if(d.value.username==""){z.error(l("app.webui.usernameempty"));return}if(d.value.password==""){z.error(l("app.webui.passwordempty"));return}if(d.value.password!=P.value){z.error(l("app.webui.passwordnotmatch"));return}try{const i={headers:{Authorization:`Bearer ${g}`}},p=await X.post("/api/v1/adduser",d.value,i);p.data.code==1?(le(),z.success(l("app.webui.addsuccess")),_.value=!1):p.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.usernamealreadyexist"))}catch{}}async function h(){if(d.value.password==""&&d.value.password!=P.value){z.error(l("app.webui.passwordnotmatch"));return}d.value.status=d.value.status==!0?1:0;try{const i={headers:{Authorization:`Bearer ${g}`}},p=await X.post("/api/v1/updateuser",d.value,i);p.data.code==1?(le(),z.success(l("app.webui.modifysucc"))):p.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.modifyfail"))}catch{}E.value=!1}return(i,p)=>{const R=we,S=he,m=Se,Y=He,B=Ue,J=qe,Q=be,Z=Me,_e=Le,ee=Ee,A=Be,K=De,I=Fe;return r(),M(ue,null,[n("div",null,[e(Q,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[n("div",Ll,[n("div",Ml,[n("div",Al,[e(R,{modelValue:c.value,"onUpdate:modelValue":p[0]||(p[0]=u=>c.value=u),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),n("div",null,[e(S,{type:"primary",onClick:p[1]||(p[1]=u=>_.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.add")),1)]),_:1}),e(S,{disabled:N.value,type:"danger",onClick:W},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(B,{data:G.value,onSelectionChange:O},{default:a(()=>[e(m,{type:"selection",width:"55"}),e(m,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(m,{prop:"username",label:t(l)("app.webui.username")},null,8,["label"]),e(m,{filters:[{text:t(l)("app.webui.admin"),value:1},{text:t(l)("app.webui.user"),value:0}],"filter-method":se,label:t(l)("app.webui.role")},{default:a(({row:u})=>[u.role!=0?(r(),M("span",Hl,o(t(l)("app.webui.admin")),1)):(r(),M("span",jl,o(t(l)("app.webui.user")),1))]),_:1},8,["filters","label"]),e(m,{prop:"email",label:t(l)("app.webui.email")},null,8,["label"]),e(m,{prop:"phone",label:t(l)("app.webui.phone")},null,8,["label"]),e(m,{filters:[{text:t(l)("app.webui.enable"),value:1},{text:t(l)("app.webui.disable"),value:0}],"filter-method":te,label:t(l)("app.webui.status")},{default:a(({row:u})=>[n("div",Dl,[u.status!=0?(r(),C(Y,{key:0,type:"success",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.enable")),1)]),_:1})):(r(),C(Y,{key:1,type:"info",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.disable")),1)]),_:1}))])]),_:1},8,["filters","label"]),e(m,{label:t(l)("app.webui.createtime"),sortable:""},{default:a(({row:u})=>[n("span",null,o(t(ie)(u.create_time)),1)]),_:1},8,["label"]),e(m,{label:t(l)("app.webui.operate")},{default:a(u=>[e(S,{size:"small",type:"primary",onClick:L=>ne(u.$index,u.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(S,{size:"small",type:"danger",onClick:L=>j(u.$index,u.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(J,{"page-sizes":[15,25,50,100,200,300],"page-size":$.value,"onUpdate:pageSize":p[2]||(p[2]=u=>$.value=u),layout:"total, sizes, prev, pager, next, jumper",total:y.value,onSizeChange:k,onCurrentChange:w,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(K,{title:t(l)("app.webui.adduser"),modelValue:_.value,"onUpdate:modelValue":p[10]||(p[10]=u=>_.value=u),width:"30%",onClose:v},{default:a(()=>[e(A,{model:d.value,"label-width":"100px"},{default:a(()=>[e(ee,{required:"",label:t(l)("app.webui.role")},{default:a(()=>[e(_e,{modelValue:d.value.role,"onUpdate:modelValue":p[3]||(p[3]=u=>d.value.role=u),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(r(!0),M(ue,null,ce(q.value,u=>(r(),C(Z,{key:u.id,label:u.label,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(ee,{required:"",label:t(l)("app.webui.username")},{default:a(()=>[e(R,{modelValue:d.value.username,"onUpdate:modelValue":p[4]||(p[4]=u=>d.value.username=u),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{required:"",label:t(l)("app.webui.password")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:d.value.password,"onUpdate:modelValue":p[5]||(p[5]=u=>d.value.password=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{required:"",label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:P.value,"onUpdate:modelValue":p[6]||(p[6]=u=>P.value=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.email")},{default:a(()=>[e(R,{modelValue:d.value.email,"onUpdate:modelValue":p[7]||(p[7]=u=>d.value.email=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.phone")},{default:a(()=>[e(R,{modelValue:d.value.phone,"onUpdate:modelValue":p[8]||(p[8]=u=>d.value.phone=u)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),n("span",Fl,[e(S,{onClick:p[9]||(p[9]=u=>_.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(S,{type:"primary",onClick:V},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(K,{title:t(l)("app.webui.edituser"),modelValue:E.value,"onUpdate:modelValue":p[19]||(p[19]=u=>E.value=u),width:"30%",onClose:v},{default:a(()=>[e(A,{model:d.value,"label-width":"100px"},{default:a(()=>[e(ee,{label:t(l)("app.webui.role")},{default:a(()=>[e(_e,{modelValue:d.value.role,"onUpdate:modelValue":p[11]||(p[11]=u=>d.value.role=u)},{default:a(()=>[(r(!0),M(ue,null,ce(q.value,u=>(r(),C(Z,{key:u.id,label:u.label,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.username")},{default:a(()=>[e(R,{modelValue:d.value.username,"onUpdate:modelValue":p[12]||(p[12]=u=>d.value.username=u),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.password")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:d.value.password,"onUpdate:modelValue":p[13]||(p[13]=u=>d.value.password=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:P.value,"onUpdate:modelValue":p[14]||(p[14]=u=>P.value=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.email")},{default:a(()=>[e(R,{modelValue:d.value.email,"onUpdate:modelValue":p[15]||(p[15]=u=>d.value.email=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.phone")},{default:a(()=>[e(R,{modelValue:d.value.phone,"onUpdate:modelValue":p[16]||(p[16]=u=>d.value.phone=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(ee,{label:t(l)("app.webui.status")},{default:a(()=>[e(I,{modelValue:d.value.status,"onUpdate:modelValue":p[17]||(p[17]=u=>d.value.status=u),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),n("span",Pl,[e(S,{onClick:p[18]||(p[18]=u=>E.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(S,{type:"primary",onClick:h},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),Nl=ke(Tl,[["__scopeId","data-v-f4927fb3"]]),Rl={key:0},Gl={class:"el-upload__text"},Zl={class:"el-upload__tip"},Ql={key:1},Ol={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Xl={style:{display:"flex","align-items":"center"}},Yl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Wl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Jl={style:{"margin-top":"10px","padding-inline":"25px"}},Kl=["href"],ea={key:0,style:{position:"relative"}},la={key:0,style:{position:"relative"}},aa={key:2},ta={style:{"font-weight":"lighter","font-size":"17px"}},oa={style:{display:"flex","justify-content":"space-around"}},ua={style:{display:"flex",width:"80%",gap:"1%"}},na={class:"status"},sa={key:0},ia={key:1},da=ve({__name:"Vulnlist",setup(de){const{t:l}=fe(),H=sessionStorage.getItem("token"),q=b("xray"),c=b("xray"),g=b([]),_=b("--"),E=b({}),d=b({}),x=b([]),F=b(""),$=[W,B],y=b(1),T=b(15),N=b(0),P=b(!0),O=b([]),G=b(!1),k=b(!1),w=b({vuln_name:"",vuln_type_id:1,cvss:.1,vuln_level:"",cve:"",nvd:"",edb:"",cnnvd:"",cnvd:"",affected_product:"",repair_suggestion:"",poc:"",exp:"",poc_type:q.value,exp_type:c.value,is_public:!1,description:"",fofa_query:"",zoom_eye_query:"",quake_query:"",hunter_query:"",google_query:"",shodan_query:"",censys_query:"",greynoise_query:"",attachment_id:"",affected_product_version:""}),le=()=>{if(w.value.cvss=Number(w.value.cvss),w.value.cvss>0&&w.value.cvss<4){w.value.vuln_level="Low",_.value=l("app.webui.low");return}else if(w.value.cvss>=4&&w.value.cvss<7){w.value.vuln_level="Medium",_.value=l("app.webui.medium");return}else if(w.value.cvss>=7&&w.value.cvss<9){w.value.vuln_level="High",_.value=l("app.webui.high");return}else if(w.value.cvss>=9&&w.value.cvss<=10){w.value.vuln_level="Critical",_.value=l("app.webui.critical");return}else z.error(l("app.webui.cvsserror"))};async function W(){try{const I=await X.get("/api/v1/getvulntypes");g.value=I.data.data}catch{}}const ne=I=>{O.value=I,I.length>0?P.value=!1:P.value=!0},se=I=>{z.success(l("app.webui.uploadsucc")),w.value.attachment_id=I.file_id},te=async()=>{try{const I={headers:{Authorization:`Bearer ${H}`}},u=await X.get("/delete/file?id="+w.value.attachment_id,I);w.value.attachment_id=""}catch{}};function j(I,u){return I.is_public&&!u.is_public?-1:!I.is_public&&u.is_public?1:0}function v(I,u){const L=new Date(I.create_time),D=new Date(u.create_time);return L<D?-1:L>D?1:0}const V=ze(()=>{const u=0+T.value;if(F.value.trim()!="")return E.value.data.filter(L=>L.id.toLowerCase().includes(F.value.toLowerCase())||L.vuln_name.toLowerCase().includes(F.value.toLowerCase()));try{return E.value.data.slice(0,u)}catch{return[]}});function h(I){T.value=I,y.value=1,B()}async function i(I){y.value=I,await B()}me(()=>{$.forEach(I=>{I()})});const p=(I,u,L,D)=>{(u.property==="id"||u.property==="vuln_name")&&(D.target.style.cursor="pointer",D.target.style.color="#409EFF")},R=(I,u,L,D)=>{(u.property==="id"||u.property==="vuln_name")&&(D.target.style.cursor="",D.target.style.color="")},S=()=>{G.value=!1,d.value={}};async function m(I){const u=sessionStorage.getItem("token");try{const L={headers:{Authorization:`Bearer ${u}`}},D=await X.get("/api/v1/getvulndtl?id="+I,L);u&&D.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),d.value=D.data}catch{}}const Y=(I,u)=>{(u.no==1||u.no==2)&&(m(I.id),G.value=!0)};async function B(){try{const I=await X.get(`/api/v1/getvulnlist?page=${y.value}&limit=${T.value}`);E.value=I.data,N.value=I.data.total,x.value=I.data.data.reduce((u,L)=>(u.some(D=>D.value===L.vuln_type)||u.push({text:L.vuln_type,value:L.vuln_type}),u),[])}catch{}}function J(){Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const I={ids:O.value.map(u=>u.id)};try{const u={headers:{Authorization:`Bearer ${H}`}},L=await X.post("/api/v1/multidelvulns",I,u);L.data.code==1?(z.success(l("app.webui.delsuccess")),B()):L.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.deletefail"))}catch{}}).catch(I=>{console.log(I)})}const Q=async(I,u)=>{await m(u.id),w.value=d.value.data,k.value=!0},Z=(I,u)=>{Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{try{const L={headers:{Authorization:`Bearer ${H}`}},D=await X.post("/api/v1/delvuln",{id:u.id},L);if(D.data.code==1){z({type:"success",message:l("app.webui.delsuccess")}),B();return}else if(D.data.code==2){z({type:"error",message:l("app.webui.invalidinput")});return}else if(D.data.code==3){z({type:"error",message:l("app.webui.delfail")});return}}catch{}}).catch(()=>{})};async function _e(){try{const I={headers:{Authorization:`Bearer ${H}`}},u=await X.post("/api/v1/editvuln",w.value,I);if(u.data.code==1){z({type:"success",message:l("app.webui.modifysucc")}),B(),k.value=!1;return}else if(u.data.code==2){z({type:"error",message:l("app.webui.invalidinput")});return}else if(u.data.code==3){z({type:"error",message:l("app.webui.modifyfail")});return}}catch{}}const ee=(I,u)=>u.vuln_type===I,A=(I,u)=>u.level===I,K=(I,u)=>I==="Poc"?u.poc!="":u.exp!="";return(I,u)=>{const L=we,D=Ee,xe=Me,je=Le,U=Fe,ye=sl,Re=il,Ge=Ie,Ye=Oe,ge=he,We=Be,$e=be,oe=He,ae=Pe,Ze=Te,Qe=Ne,pe=Se,Je=Ue,Ke=qe;return k.value?(r(),M("div",Rl,[e($e,{shadow:"always",header:t(l)("app.webui.editvuln")},{default:a(()=>[n("div",null,[e(We,{inline:"true",model:w.value,"label-width":"auto",size:"large"},{default:a(()=>[e(D,{label:t(l)("app.webui.vulnname"),prop:"vuln_name",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(L,{modelValue:w.value.vuln_name,"onUpdate:modelValue":u[0]||(u[0]=f=>w.value.vuln_name=f)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:t(l)("app.webui.vulntype"),style:{width:"45%"},required:""},{default:a(()=>[e(je,{modelValue:w.value.vuln_type_id,"onUpdate:modelValue":u[1]||(u[1]=f=>w.value.vuln_type_id=f),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(r(!0),M(ue,null,ce(g.value,f=>(r(),C(xe,{key:f.id,label:f.name,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.affectedproduct"),prop:"affected_product",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(L,{modelValue:w.value.affected_product,"onUpdate:modelValue":u[2]||(u[2]=f=>w.value.affected_product=f)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:t(l)("app.webui.productversion"),style:{width:"45%"},prop:"affected_product_version",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(L,{modelValue:w.value.affected_product_version,"onUpdate:modelValue":u[3]||(u[3]=f=>w.value.affected_product_version=f)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:"CVSS",style:{width:"29%"},required:""},{default:a(()=>[e(L,{modelValue:w.value.cvss,"onUpdate:modelValue":u[4]||(u[4]=f=>w.value.cvss=f),type:"number",step:"0.1",onChange:le},null,8,["modelValue"])]),_:1}),e(D,{label:t(l)("app.webui.vulnlevel"),style:{width:"29%"},required:""},{default:a(()=>[e(L,{modelValue:_.value,"onUpdate:modelValue":u[5]||(u[5]=f=>_.value=f),readonly:"",disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.ispublic"),style:{width:"29%"}},{default:a(()=>[e(U,{modelValue:w.value.is_public,"onUpdate:modelValue":u[6]||(u[6]=f=>w.value.is_public=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.cveid"),style:{width:"29%"}},{default:a(()=>[e(L,{modelValue:w.value.cve,"onUpdate:modelValue":u[7]||(u[7]=f=>w.value.cve=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.nvdid"),style:{width:"29%"}},{default:a(()=>[e(L,{modelValue:w.value.nvd,"onUpdate:modelValue":u[8]||(u[8]=f=>w.value.nvd=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.edbid"),style:{width:"29%"}},{default:a(()=>[e(L,{modelValue:w.value.edbid,"onUpdate:modelValue":u[9]||(u[9]=f=>w.value.edbid=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.cnnvdid"),style:{width:"29%"}},{default:a(()=>[e(L,{modelValue:w.value.cnnvd,"onUpdate:modelValue":u[10]||(u[10]=f=>w.value.cnnvd=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.cnvdid"),style:{width:"29%"}},{default:a(()=>[e(L,{modelValue:w.value.cnvd,"onUpdate:modelValue":u[11]||(u[11]=f=>w.value.cnvd=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Fofa ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.fofa_query,"onUpdate:modelValue":u[12]||(u[12]=f=>w.value.fofa_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`ZoomEye ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.zoom_eye_query,"onUpdate:modelValue":u[13]||(u[13]=f=>w.value.zoom_eye_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Quake ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.quake_query,"onUpdate:modelValue":u[14]||(u[14]=f=>w.value.quake_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Hunter ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.hunter_query,"onUpdate:modelValue":u[15]||(u[15]=f=>w.value.hunter_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Google ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.google_query,"onUpdate:modelValue":u[16]||(u[16]=f=>w.value.google_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Shodan ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.shodan_query,"onUpdate:modelValue":u[17]||(u[17]=f=>w.value.shodan_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Censys ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.censys_query,"onUpdate:modelValue":u[18]||(u[18]=f=>w.value.censys_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:`Greynoise ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(L,{modelValue:w.value.greynoise_query,"onUpdate:modelValue":u[19]||(u[19]=f=>w.value.greynoise_query=f)},null,8,["modelValue"])]),_:1},8,["label"]),e(D,{label:t(l)("app.webui.vulndesc"),style:{width:"90%"},prop:"description",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(L,{modelValue:w.value.description,"onUpdate:modelValue":u[20]||(u[20]=f=>w.value.description=f),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:t(l)("app.webui.vulnsuggest"),style:{width:"90%"},prop:"repair_suggestion",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(L,{modelValue:w.value.repair_suggestion,"onUpdate:modelValue":u[21]||(u[21]=f=>w.value.repair_suggestion=f),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:"Poc",style:{width:"90%"},onChange:I.ShowPocInput},{default:a(()=>[e(Re,{modelValue:q.value,"onUpdate:modelValue":u[22]||(u[22]=f=>q.value=f),size:"large"},{default:a(()=>[e(ye,{label:"Xray",value:"xray"}),e(ye,{label:"Nuclei",value:"nuclei"}),e(ye,{label:"Goby",value:"goby"}),e(ye,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(L,{modelValue:w.value.poc,"onUpdate:modelValue":u[23]||(u[23]=f=>w.value.poc=f),type:"textarea",placeholder:I.pocplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e(D,{label:"Exp",style:{width:"90%"},onChange:I.ShowExpInput},{default:a(()=>[e(Re,{modelValue:c.value,"onUpdate:modelValue":u[24]||(u[24]=f=>c.value=f),size:"large"},{default:a(()=>[e(ye,{label:"Xray",value:"xray"}),e(ye,{label:"Nuclei",value:"nuclei"}),e(ye,{label:"Goby",value:"goby"}),e(ye,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(L,{modelValue:w.value.exp,"onUpdate:modelValue":u[25]||(u[25]=f=>w.value.exp=f),type:"textarea",placeholder:I.expplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e(D,{label:t(l)("app.webui.attachfile"),style:{width:"100%"}},{default:a(()=>[e(Ye,{class:"upload-demo",drag:"",accept:".zip,.doc,.docx,.pdf,.txt",action:"/api/v1/upload",headers:{Authorization:`Bearer ${t(H)}`},"on-success":se,"on-remove":te,style:{width:"90%"}},{tip:a(()=>[n("div",Zl,o(t(l)("app.webui.uploadnotice1")),1)]),default:a(()=>[e(Ge,{class:"el-icon--upload"},{default:a(()=>[e(t(nl))]),_:1}),n("div",Gl,[s(o(t(l)("app.webui.draguplaod"))+" ",1),n("em",null,o(t(l)("app.webui.clickupload")),1)])]),_:1},8,["headers"])]),_:1},8,["label"]),e(D,{style:{width:"100%"}},{default:a(()=>[e(ge,{onClick:u[26]||(u[26]=f=>k.value=!1),size:"default"},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(ge,{type:"primary",onClick:_e,size:"default"},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["header"])])):G.value?(r(),M("div",Ql,[e($e,{shadow:"always"},{header:a(()=>[n("div",Ol,[n("span",Xl,[e(Ge,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>u[33]||(u[33]=[n("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[n("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),n("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+o(d.value.data.vuln_name),1)]),e(ge,{type:"primary",onClick:S},{default:a(()=>[s(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[n("div",null,[e(Ze,{column:5},{default:a(()=>[e(ae,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(oe,null,{default:a(()=>[s(o(d.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[s(o(d.value.data.vuln_type),1)]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[d.value.data.vuln_level==="Critical"?(r(),C(oe,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):d.value.data.vuln_level==="High"?(r(),C(oe,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):d.value.data.vuln_level==="Medium"?(r(),C(oe,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(r(),C(oe,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[s(o(t(ie)(d.value.data.create_time)),1)]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[s(o(d.value.data.submitter),1)]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(oe,null,{default:a(()=>[s(o(d.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(oe,null,{default:a(()=>[s(o(d.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(oe,null,{default:a(()=>[s(o(d.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(oe,null,{default:a(()=>[s(o(d.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(ae,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(oe,null,{default:a(()=>[s(o(d.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(ae,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[s(o(d.value.data.affected_product),1)]),_:1},8,["label"]),e(ae,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[s(o(d.value.data.affected_product_version),1)]),_:1},8,["label"]),e(ae,{label:"CVSS:"},{default:a(()=>[s(o(d.value.data.cvss),1)]),_:1}),e(ae,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[n("div",Yl,o(d.value.data.description),1)]),_:1},8,["label"]),e(ae,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[n("div",Wl,o(d.value.data.repair_suggestion),1)]),_:1},8,["label"]),d.value.data.attachment_id?(r(),C(ae,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[n("div",Jl,[n("a",{href:`/download/file?id=${d.value.data.attachment_id}`},o(d.value.data.attachment_name),9,Kl)])]),_:1},8,["label"])):re("",!0)]),_:1})])]),_:1}),e($e,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[n("div",null,[e(Ze,{column:5},{default:a(()=>[e(ae,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.fofa_query),1)]),_:1},8,["label"]),e(ae,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(ae,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.quake_query),1)]),_:1},8,["label"]),e(ae,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.hunter_query),1)]),_:1},8,["label"]),e(ae,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.google_query),1)]),_:1},8,["label"]),e(ae,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.shodan_query),1)]),_:1},8,["label"]),e(ae,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.censys_query),1)]),_:1},8,["label"]),e(ae,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(d.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e($e,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[d.value.data.poc!=""?(r(),M("div",ea,[e(ge,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:u[27]||(u[27]=f=>I.copyToClipboard(d.value.data.poc))},null,8,["icon"]),e(L,{modelValue:d.value.data.poc,"onUpdate:modelValue":u[28]||(u[28]=f=>d.value.data.poc=f),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(r(),C(Qe,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e($e,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[d.value.data.exp!=""?(r(),M("div",la,[e(ge,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:u[29]||(u[29]=f=>I.copyToClipboard(d.value.data.exp))},null,8,["icon"]),e(L,{modelValue:d.value.data.exp,"onUpdate:modelValue":u[30]||(u[30]=f=>d.value.data.exp=f),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(r(),C(Qe,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(r(),M("div",aa,[e($e,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[n("div",ta,[n("div",oa,[n("div",ua,[e(L,{modelValue:F.value,"onUpdate:modelValue":u[31]||(u[31]=f=>F.value=f),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),e(ge,{disabled:P.value,type:"danger",onClick:J},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])]),e(Je,{data:V.value,onSelectionChange:ne,onCellMouseEnter:p,onCellMouseLeave:R,onCellClick:Y},{default:a(()=>[e(pe,{type:"selection",width:"55"}),e(pe,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(pe,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(pe,{prop:"vuln_type",filters:x.value,"filter-method":ee,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(pe,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":A,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:f})=>[f.vuln_level==="Critical"?(r(),C(oe,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):f.vuln_level==="High"?(r(),C(oe,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):f.vuln_level==="Medium"?(r(),C(oe,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(r(),C(oe,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(pe,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(pe,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":K,label:"Poc&Exp",width:"120"},{default:a(({row:f})=>[n("div",na,[f.poc!=""&&f.poc!="0"?(r(),C(oe,{key:0,type:"success",effect:"dark"},{default:a(()=>u[34]||(u[34]=[s("Poc")])),_:1})):(r(),C(oe,{key:1,type:"info",effect:"dark"},{default:a(()=>u[35]||(u[35]=[s("Poc")])),_:1})),f.exp!=""&&f.exp!="0"?(r(),C(oe,{key:2,type:"success",effect:"dark"},{default:a(()=>u[36]||(u[36]=[s("Exp")])),_:1})):(r(),C(oe,{key:3,type:"info",effect:"dark"},{default:a(()=>u[37]||(u[37]=[s("Exp")])),_:1}))])]),_:1}),e(pe,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":j,width:"110"},{default:a(({row:f})=>[f.is_public?(r(),M("span",sa,o(t(l)("app.webui.yes")),1)):(r(),M("span",ia,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(pe,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":v},{default:a(({row:f})=>[n("span",null,o(t(ie)(f.create_time)),1)]),_:1},8,["label"]),e(pe,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":v},{default:a(({row:f})=>[n("span",null,o(t(ie)(f.update_time)),1)]),_:1},8,["label"]),e(pe,{label:t(l)("app.webui.operate"),width:"140"},{default:a(f=>[e(ge,{disabled:f.row.status===0,size:"small",type:"primary",onClick:el=>Q(f.$index,f.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["disabled","onClick"]),e(ge,{disabled:f.row.status===0,size:"small",type:"danger",onClick:el=>Z(f.$index,f.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(Ke,{"page-sizes":[15,25,50,100,200,300],"page-size":T.value,"onUpdate:pageSize":u[32]||(u[32]=f=>T.value=f),layout:"total, sizes, prev, pager, next, jumper",total:N.value,onSizeChange:h,onCurrentChange:i,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),ra=ke(da,[["__scopeId","data-v-779b2d27"]]),pa={key:0},ca={style:{"font-weight":"lighter","font-size":"17px"}},va={style:{display:"flex","justify-content":"space-around"}},fa={style:{display:"flex",width:"80%",gap:"1%"}},ma={class:"status"},ba={key:0},_a={key:1},ya={key:1},wa={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ha={style:{display:"flex","align-items":"center"}},ga={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Va={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},xa={style:{"margin-top":"10px","padding-inline":"25px"}},ka=["href"],$a={key:0,style:{position:"relative"}},Ca={key:0,style:{position:"relative"}},za={style:{"margin-top":"1%"}},Sa=ve({__name:"Unaudited",setup(de){const{t:l}=fe(),H=b(!1),q=sessionStorage.getItem("token"),c=b([]),g=b({}),_=b({}),E=b({id:null,audit:1,review:"",cvss:null,prid:0,erid:0,irid:0,orid:0}),d=b(""),x=[V,h],F=b(1),$=b(15),y=b(0),T=b([]),N=b([]),P=b([]),O=b([]),G=[{id:1,name:l("app.webui.pass")},{id:2,name:l("app.webui.unpassed")}],k={id:0,rule:""};function w(S,m){return S.is_public&&!m.is_public?-1:!S.is_public&&m.is_public?1:0}function le(S,m){const Y=new Date(S.create_time),B=new Date(m.create_time);return Y<B?-1:Y>B?1:0}const W=ze(()=>{const m=0+$.value;if(console.log(g.value),d.value.trim()!="")return g.value.data.filter(Y=>Y.id.toLowerCase().includes(d.value.toLowerCase())||Y.vuln_name.toLowerCase().includes(d.value.toLowerCase()));try{return g.value.data.slice(0,m)}catch{return[]}});function ne(S){$.value=S,F.value=1,V()}async function se(S){F.value=S,await V()}me(()=>{x.forEach(S=>{S()})});const te=()=>{H.value=!1,_.value={}},j=async(S,m)=>{console.log(S,m);try{const Y={headers:{Authorization:`Bearer ${q}`}},B=await X.get("/api/v1/getvulndtl?id="+m.id,Y);q&&B.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),_.value=B.data,E.value.id=m.id,E.value.cvss=B.data.data.cvss,H.value=!0}catch{}};async function v(){try{const S={headers:{Authorization:`Bearer ${q}`}};E.value.cvss=Number(E.value.cvss),(await X.post("/api/v1/auditvuln",E.value,S)).data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):(z.success(l("app.webui.audited")),_.value={},H.value=!1,V())}catch{}}async function V(){try{const S={headers:{Authorization:`Bearer ${q}`}},m=await X.get(`/api/v1/getunauditlist?page=${F.value}&limit=${$.value}`,S);g.value=m.data,y.value=m.data.total,c.value=m.data.data.reduce((Y,B)=>(Y.some(J=>J.value===B.vuln_type)||Y.push({text:B.vuln_type,value:B.vuln_type}),Y),[])}catch{}}async function h(){try{const S={headers:{Authorization:`Bearer ${q}`}},m=await X.get("/api/v1/getallscorerules",S);m.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),T.value=m.data.data.pocrules,N.value=m.data.data.exprules,P.value=m.data.data.incidencerules,O.value=m.data.data.otherrules,T.value.push(k),N.value.push(k),P.value.push(k),O.value.push(k)}catch{}}const i=(S,m)=>m.vuln_type===S,p=(S,m)=>m.level===S,R=(S,m)=>S==="Poc"?m.poc!="":m.exp!="";return(S,m)=>{const Y=we,B=Se,J=He,Q=he,Z=Ue,_e=qe,ee=be,A=Ie,K=Pe,I=Te,u=Ne,L=Ee,D=Me,xe=Le,je=Be;return H.value?(r(),M("div",ya,[e(ee,{shadow:"always"},{header:a(()=>[n("div",wa,[n("span",ha,[e(A,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>m[18]||(m[18]=[n("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[n("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),n("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+o(_.value.data.vuln_name),1)])])]),default:a(()=>[n("div",null,[e(I,{column:5},{default:a(()=>[e(K,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(J,null,{default:a(()=>[s(o(_.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[s(o(_.value.data.vuln_type),1)]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[_.value.data.vuln_level==="Critical"?(r(),C(J,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):_.value.data.vuln_level==="High"?(r(),C(J,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):_.value.data.vuln_level==="Medium"?(r(),C(J,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(r(),C(J,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[s(o(t(ie)(_.value.data.create_time)),1)]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[s(o(_.value.data.submitter),1)]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(J,null,{default:a(()=>[s(o(_.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(J,null,{default:a(()=>[s(o(_.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(J,null,{default:a(()=>[s(o(_.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(J,null,{default:a(()=>[s(o(_.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(K,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(J,null,{default:a(()=>[s(o(_.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(K,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[s(o(_.value.data.affected_product),1)]),_:1},8,["label"]),e(K,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[s(o(_.value.data.affected_product_version),1)]),_:1},8,["label"]),e(K,{label:"CVSS:"},{default:a(()=>[s(o(_.value.data.cvss),1)]),_:1}),e(K,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[n("div",ga,o(_.value.data.description),1)]),_:1},8,["label"]),e(K,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[n("div",Va,o(_.value.data.repair_suggestion),1)]),_:1},8,["label"]),_.value.data.attachment_id?(r(),C(K,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[n("div",xa,[n("a",{href:`/download/file?id=${_.value.data.attachment_id}`},o(_.value.data.attachment_name),9,ka)])]),_:1},8,["label"])):re("",!0)]),_:1})])]),_:1}),e(ee,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[n("div",null,[e(I,{column:5},{default:a(()=>[e(K,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.fofa_query),1)]),_:1},8,["label"]),e(K,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(K,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.quake_query),1)]),_:1},8,["label"]),e(K,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.hunter_query),1)]),_:1},8,["label"]),e(K,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.google_query),1)]),_:1},8,["label"]),e(K,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.shodan_query),1)]),_:1},8,["label"]),e(K,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.censys_query),1)]),_:1},8,["label"]),e(K,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(_.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),_.value.data.poc!=""?(r(),C(ee,{key:0,style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[_.value.data.poc!=""?(r(),M("div",$a,[e(Q,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:m[2]||(m[2]=U=>S.copyToClipboard(_.value.data.poc))},null,8,["icon"]),e(Y,{modelValue:_.value.data.poc,"onUpdate:modelValue":m[3]||(m[3]=U=>_.value.data.poc=U),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(r(),C(u,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})):re("",!0),_.value.data.exp!=""?(r(),C(ee,{key:1,style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[_.value.data.exp!=""?(r(),M("div",Ca,[e(Q,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:m[4]||(m[4]=U=>S.copyToClipboard(_.value.data.exp))},null,8,["icon"]),e(Y,{modelValue:_.value.data.exp,"onUpdate:modelValue":m[5]||(m[5]=U=>_.value.data.exp=U),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(r(),C(u,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})):re("",!0),e(ee,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.audit")},{default:a(()=>[e(je,{model:E.value},{default:a(()=>[e(L,{label:"CVSS:"},{default:a(()=>[e(Y,{type:"numper",modelValue:E.value.cvss,"onUpdate:modelValue":m[6]||(m[6]=U=>E.value.cvss=U)},null,8,["modelValue"])]),_:1}),e(L,{label:`${t(l)("app.webui.audit")}:`},{default:a(()=>[e(xe,{modelValue:E.value.audit,"onUpdate:modelValue":m[7]||(m[7]=U=>E.value.audit=U),placeholder:t(l)("app.webui.observability")},{default:a(()=>[(r(),M(ue,null,ce(G,U=>e(D,{key:U.id,label:U.name,value:U.id},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),E.value.audit==2?(r(),C(L,{key:0,label:t(l)("app.webui.reviewcomments")},{default:a(()=>[e(Y,{type:"textarea",modelValue:E.value.review,"onUpdate:modelValue":m[8]||(m[8]=U=>E.value.review=U)},null,8,["modelValue"])]),_:1},8,["label"])):re("",!0),E.value.audit==1?(r(),C(L,{key:1,label:`${t(l)("app.webui.pocscorerule")}:`},{default:a(()=>[e(xe,{modelValue:E.value.prid,"onUpdate:modelValue":m[9]||(m[9]=U=>E.value.prid=U),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(r(!0),M(ue,null,ce(T.value,U=>(r(),C(D,{key:U.id,label:U.rule,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):re("",!0),E.value.audit==1?(r(),C(L,{key:2,label:`${t(l)("app.webui.exprule")}:`},{default:a(()=>[e(xe,{modelValue:E.value.erid,"onUpdate:modelValue":m[10]||(m[10]=U=>E.value.erid=U),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(r(!0),M(ue,null,ce(N.value,U=>(r(),C(D,{key:U.id,label:U.rule,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):re("",!0),E.value.audit==1?(r(),C(L,{key:3,label:`${t(l)("app.webui.incidencerule")}:`},{default:a(()=>[e(xe,{modelValue:E.value.irid,"onUpdate:modelValue":m[11]||(m[11]=U=>E.value.irid=U),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(r(!0),M(ue,null,ce(P.value,U=>(r(),C(D,{key:U.id,label:U.rule,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):re("",!0),E.value.audit==1?(r(),C(L,{key:4,label:`${t(l)("app.webui.otherrule")}:`},{default:a(()=>[e(xe,{modelValue:E.value.orid,"onUpdate:modelValue":m[12]||(m[12]=U=>E.value.orid=U),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(r(!0),M(ue,null,ce(O.value,U=>(r(),C(D,{key:U.id,label:U.rule,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):re("",!0)]),_:1},8,["model"])]),_:1},8,["header"]),n("div",za,[e(Q,{onClick:te},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(Q,{type:"primary",onClick:v},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])])):(r(),M("div",pa,[e(ee,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[n("div",ca,[n("div",va,[n("div",fa,[e(Y,{modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=U=>d.value=U),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),m[13]||(m[13]=n("span",null,null,-1))]),e(Z,{data:W.value},{default:a(()=>[e(B,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(B,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(B,{prop:"vuln_type",filters:c.value,"filter-method":i,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(B,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":p,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:U})=>[U.vuln_level==="Critical"?(r(),C(J,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):U.vuln_level==="High"?(r(),C(J,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):U.vuln_level==="Medium"?(r(),C(J,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(r(),C(J,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(B,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(B,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":R,label:t(l)("app.webui.status"),width:"120"},{default:a(({row:U})=>[n("div",ma,[U.poc!=""&&U.poc!="0"?(r(),C(J,{key:0,type:"success",effect:"dark"},{default:a(()=>m[14]||(m[14]=[s("Poc")])),_:1})):(r(),C(J,{key:1,type:"info",effect:"dark"},{default:a(()=>m[15]||(m[15]=[s("Poc")])),_:1})),U.exp!=""&&U.exp!="0"?(r(),C(J,{key:2,type:"success",effect:"dark"},{default:a(()=>m[16]||(m[16]=[s("Exp")])),_:1})):(r(),C(J,{key:3,type:"info",effect:"dark"},{default:a(()=>m[17]||(m[17]=[s("Exp")])),_:1}))])]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":w,width:"110"},{default:a(({row:U})=>[U.is_public?(r(),M("span",ba,o(t(l)("app.webui.yes")),1)):(r(),M("span",_a,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":le},{default:a(({row:U})=>[n("span",null,o(t(ie)(U.create_time)),1)]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":le},{default:a(({row:U})=>[n("span",null,o(t(ie)(U.update_time)),1)]),_:1},8,["label"]),e(B,{label:t(l)("app.webui.operate"),width:"140"},{default:a(U=>[e(Q,{size:"small",type:"primary",onClick:ye=>j(U.$index,U.row)},{default:a(()=>[s(o(t(l)("app.webui.audit")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(_e,{"page-sizes":[15,25,50,100,200,300],"page-size":$.value,"onUpdate:pageSize":m[1]||(m[1]=U=>$.value=U),layout:"total, sizes, prev, pager, next, jumper",total:y.value,onSizeChange:ne,onCurrentChange:se,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Ua=ke(Sa,[["__scopeId","data-v-fda2e9d7"]]),qa={key:0},Ea={style:{"font-weight":"lighter","font-size":"17px"}},Ba={style:{display:"flex","justify-content":"space-around"}},Ia={style:{display:"flex",width:"80%",gap:"1%"}},La={class:"status"},Ma={key:0},Aa={key:1},Ha={key:1},ja={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Da={style:{display:"flex","align-items":"center"}},Fa={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Pa={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Ta={style:{"margin-top":"10px","padding-inline":"25px"}},Na=["href"],Ra={key:0,style:{position:"relative"}},Ga={key:0,style:{position:"relative"}},Za=ve({__name:"Audited",setup(de){const{t:l}=fe(),H=b(!1),q=sessionStorage.getItem("token"),c=b({}),g=b({}),_=b(""),E=b([]),d=[W],x=b(1),F=b(15),$=b(0);function y(j,v){return j.is_public&&!v.is_public?-1:!j.is_public&&v.is_public?1:0}function T(j,v){const V=new Date(j.create_time),h=new Date(v.create_time);return V<h?-1:V>h?1:0}const N=ze(()=>{const v=0+F.value;if(console.log(c.value),_.value.trim()!="")return c.value.data.filter(V=>V.id.toLowerCase().includes(_.value.toLowerCase())||V.vuln_name.toLowerCase().includes(_.value.toLowerCase()));try{return c.value.data.slice(0,v)}catch{return[]}});function P(j){F.value=j,x.value=1,W()}async function O(j){x.value=j,await W()}const G=(j,v,V,h)=>{(v.property==="id"||v.property==="vuln_name")&&(h.target.style.cursor="pointer",h.target.style.color="#409EFF")},k=(j,v,V,h)=>{(v.property==="id"||v.property==="vuln_name")&&(h.target.style.cursor="",h.target.style.color="")},w=()=>{H.value=!1,g.value={}},le=async(j,v)=>{if(v.no==0||v.no==1)try{const V={headers:{Authorization:`Bearer ${q}`}},h=await X.get("/api/v1/getvulndtl?id="+j.id,V);q&&h.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),g.value=h.data,H.value=!0}catch{}};me(()=>{d.forEach(j=>{j()})});async function W(){try{const j={headers:{Authorization:`Bearer ${q}`}},v=await X.get(`/api/v1/getauditedlist?page=${x.value}&limit=${F.value}`,j);c.value=v.data,$.value=v.data.total,E.value=v.data.data.reduce((V,h)=>(V.some(i=>i.value===h.vuln_type)||V.push({text:h.vuln_type,value:h.vuln_type}),V),[])}catch{}}const ne=(j,v)=>v.vuln_type===j,se=(j,v)=>v.level===j,te=(j,v)=>j==="Poc"?v.poc!="":v.exp!="";return(j,v)=>{const V=we,h=Se,i=He,p=Ue,R=qe,S=be,m=Ie,Y=he,B=Pe,J=Te,Q=Ne;return H.value?(r(),M("div",Ha,[e(S,{shadow:"always"},{header:a(()=>[n("div",ja,[n("span",Da,[e(m,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>v[11]||(v[11]=[n("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[n("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),n("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+o(g.value.data.vuln_name),1)]),e(Y,{type:"primary",onClick:w},{default:a(()=>[s(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[n("div",null,[e(J,{column:5},{default:a(()=>[e(B,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(i,null,{default:a(()=>[s(o(g.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[s(o(g.value.data.vuln_type),1)]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[g.value.data.vuln_level==="Critical"?(r(),C(i,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):g.value.data.vuln_level==="High"?(r(),C(i,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):g.value.data.vuln_level==="Medium"?(r(),C(i,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(r(),C(i,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[s(o(t(ie)(g.value.data.create_time)),1)]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[s(o(g.value.data.submitter),1)]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(i,null,{default:a(()=>[s(o(g.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(i,null,{default:a(()=>[s(o(g.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(i,null,{default:a(()=>[s(o(g.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(i,null,{default:a(()=>[s(o(g.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(B,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(i,null,{default:a(()=>[s(o(g.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(B,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[s(o(g.value.data.affected_product),1)]),_:1},8,["label"]),e(B,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[s(o(g.value.data.affected_product_version),1)]),_:1},8,["label"]),e(B,{label:"CVSS:"},{default:a(()=>[s(o(g.value.data.cvss),1)]),_:1}),e(B,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[n("div",Fa,o(g.value.data.description),1)]),_:1},8,["label"]),e(B,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[n("div",Pa,o(g.value.data.repair_suggestion),1)]),_:1},8,["label"]),g.value.data.attachment_id?(r(),C(B,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[n("div",Ta,[n("a",{href:`/download/file?id=${g.value.data.attachment_id}`},o(g.value.data.attachment_name),9,Na)])]),_:1},8,["label"])):re("",!0)]),_:1})])]),_:1}),e(S,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[n("div",null,[e(J,{column:5},{default:a(()=>[e(B,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.fofa_query),1)]),_:1},8,["label"]),e(B,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(B,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.quake_query),1)]),_:1},8,["label"]),e(B,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.hunter_query),1)]),_:1},8,["label"]),e(B,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.google_query),1)]),_:1},8,["label"]),e(B,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.shodan_query),1)]),_:1},8,["label"]),e(B,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.censys_query),1)]),_:1},8,["label"]),e(B,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[s(o(g.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(S,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[g.value.data.poc!=""?(r(),M("div",Ra,[e(Y,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:v[2]||(v[2]=Z=>j.copyToClipboard(g.value.data.poc))},null,8,["icon"]),e(V,{modelValue:g.value.data.poc,"onUpdate:modelValue":v[3]||(v[3]=Z=>g.value.data.poc=Z),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(r(),C(Q,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(S,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[g.value.data.exp!=""?(r(),M("div",Ga,[e(Y,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:v[4]||(v[4]=Z=>j.copyToClipboard(g.value.data.exp))},null,8,["icon"]),e(V,{modelValue:g.value.data.exp,"onUpdate:modelValue":v[5]||(v[5]=Z=>g.value.data.exp=Z),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(r(),C(Q,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(r(),M("div",qa,[e(S,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[n("div",Ea,[n("div",Ba,[n("div",Ia,[e(V,{modelValue:_.value,"onUpdate:modelValue":v[0]||(v[0]=Z=>_.value=Z),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),v[6]||(v[6]=n("span",null,null,-1))]),e(p,{data:N.value,onSelectionChange:j.handleSelectionChange,onCellMouseEnter:G,onCellMouseLeave:k,onCellClick:le},{default:a(()=>[e(h,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(h,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(h,{prop:"vuln_type",filters:E.value,"filter-method":ne,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(h,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":se,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:Z})=>[Z.vuln_level==="Critical"?(r(),C(i,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(o(t(l)("app.webui.critical")),1)]),_:1})):Z.vuln_level==="High"?(r(),C(i,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(o(t(l)("app.webui.high")),1)]),_:1})):Z.vuln_level==="Medium"?(r(),C(i,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(o(t(l)("app.webui.medium")),1)]),_:1})):(r(),C(i,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(h,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(h,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":te,label:"Poc&Exp",width:"120"},{default:a(({row:Z})=>[n("div",La,[Z.poc!=""&&Z.poc!="0"?(r(),C(i,{key:0,type:"success",effect:"dark"},{default:a(()=>v[7]||(v[7]=[s("Poc")])),_:1})):(r(),C(i,{key:1,type:"info",effect:"dark"},{default:a(()=>v[8]||(v[8]=[s("Poc")])),_:1})),Z.exp!=""&&Z.exp!="0"?(r(),C(i,{key:2,type:"success",effect:"dark"},{default:a(()=>v[9]||(v[9]=[s("Exp")])),_:1})):(r(),C(i,{key:3,type:"info",effect:"dark"},{default:a(()=>v[10]||(v[10]=[s("Exp")])),_:1}))])]),_:1}),e(h,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":y,width:"110"},{default:a(({row:Z})=>[Z.is_public?(r(),M("span",Ma,o(t(l)("app.webui.yes")),1)):(r(),M("span",Aa,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(h,{label:t(l)("app.webui.status"),sortable:"","sort-method":y,width:"110"},{default:a(({row:Z})=>[Z.status==1?(r(),C(i,{key:0,type:"success"},{default:a(()=>[s(o(t(l)("app.webui.passed")),1)]),_:1})):(r(),C(i,{key:1,type:"danger"},{default:a(()=>[s(o(t(l)("app.webui.unpassed")),1)]),_:1}))]),_:1},8,["label"]),e(h,{prop:"review_comments",label:t(l)("app.webui.reviewcomments")},null,8,["label"]),e(h,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":T},{default:a(({row:Z})=>[n("span",null,o(t(ie)(Z.update_time)),1)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])]),e(R,{"page-sizes":[15,25,50,100,200,300],"page-size":F.value,"onUpdate:pageSize":v[1]||(v[1]=Z=>F.value=Z),layout:"total, sizes, prev, pager, next, jumper",total:$.value,onSizeChange:P,onCurrentChange:O,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Qa=ke(Za,[["__scopeId","data-v-f438273b"]]),Oa={style:{color:"red"}},Xa={key:0,style:{"margin-top":"1%"}},Ya={key:1,style:{"margin-top":"1%"}},Wa=ve({__name:"System",setup(de){const{t:l}=fe(),H=b(!0),q=sessionStorage.getItem("token"),c=b({emailconf:{email_host:"",email_port:0,email_user:"",email_password:"",email_sender:""},jwtconf:{jwt_secret:"",jwt_expires:0},noticeconf:{type:0,secret:"",webhook:""},sysconf:{user_register:!1,user_display:"",max_attempts:0,lockout_duration:0}}),g=b([{key:0,value:l("el.select.placeholder")},{key:1,value:l("app.webui.dingtalk")},{key:2,value:l("app.webui.wxwork")}]);me(_);async function _(){try{const d={headers:{Authorization:`Bearer ${q}`}},x=await X.get("/api/v1/getsysconfig",d);x.data.code==1?c.value=x.data.data:(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"))}catch{}}async function E(){console.log(c.value);try{const d={headers:{Authorization:`Bearer ${q}`}};c.value.emailconf.email_port=Number(c.value.emailconf.email_port),c.value.jwtconf.jwt_expires=Number(c.value.jwtconf.jwt_expires),c.value.noticeconf.type=Number(c.value.noticeconf.type),c.value.sysconf.max_attempts=Number(c.value.sysconf.max_attempts),c.value.sysconf.lockout_duration=Number(c.value.sysconf.lockout_duration),(await X.post("/api/v1/updatesysconfig",c.value,d)).data.code==1?(_(),z({type:"success",message:l("app.webui.savesuccess")}),H.value=!0):z({type:"error",message:l("app.webui.savefail")})}catch{}}return(d,x)=>{const F=Fe,$=Ee,y=we,T=Be,N=be,P=Me,O=Le,G=he;return r(),M(ue,null,[e(N,{header:t(l)("app.webui.regandlogincnfg")},{default:a(()=>[e(T,{disabled:H.value,modelValue:c.value.sysconf,"onUpdate:modelValue":x[9]||(x[9]=k=>c.value.sysconf=k),"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e($,{label:t(l)("app.webui.userregister")},{default:a(()=>[e(F,{modelValue:c.value.sysconf.user_register,"onUpdate:modelValue":x[0]||(x[0]=k=>c.value.sysconf.user_register=k),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.userdisplay")},{default:a(()=>[e(y,{modelValue:c.value.sysconf.user_display,"onUpdate:modelValue":x[1]||(x[1]=k=>c.value.sysconf.user_display=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.maxattempts"),required:""},{default:a(()=>[e(y,{type:"number",modelValue:c.value.sysconf.max_attempts,"onUpdate:modelValue":x[2]||(x[2]=k=>c.value.sysconf.max_attempts=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.lockoutduration"),required:""},{default:a(()=>[e(y,{type:"number",modelValue:c.value.sysconf.lockout_duration,"onUpdate:modelValue":x[3]||(x[3]=k=>c.value.sysconf.lockout_duration=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,null,{default:a(()=>[n("span",Oa,o(t(l)("app.webui.needemail")),1)]),_:1}),e($,{label:t(l)("app.webui.emailserver")},{default:a(()=>[e(y,{modelValue:c.value.emailconf.email_host,"onUpdate:modelValue":x[4]||(x[4]=k=>c.value.emailconf.email_host=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.emailport")},{default:a(()=>[e(y,{type:"number",modelValue:c.value.emailconf.email_port,"onUpdate:modelValue":x[5]||(x[5]=k=>c.value.emailconf.email_port=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.emailuser")},{default:a(()=>[e(y,{modelValue:c.value.emailconf.email_user,"onUpdate:modelValue":x[6]||(x[6]=k=>c.value.emailconf.email_user=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.emailpasswd")},{default:a(()=>[e(y,{type:"password","show-password":"",modelValue:c.value.emailconf.email_password,"onUpdate:modelValue":x[7]||(x[7]=k=>c.value.emailconf.email_password=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.emailsender")},{default:a(()=>[e(y,{modelValue:c.value.emailconf.email_sender,"onUpdate:modelValue":x[8]||(x[8]=k=>c.value.emailconf.email_sender=k)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])]),_:1},8,["header"]),e(N,{header:t(l)("app.webui.jwtconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(T,{disabled:H.value,model:c.value.jwtconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e($,{label:t(l)("app.webui.jwtkey"),required:""},{default:a(()=>[e(y,{type:"password","show-password":"",modelValue:c.value.jwtconf.jwt_secret,"onUpdate:modelValue":x[10]||(x[10]=k=>c.value.jwtconf.jwt_secret=k)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.jwtvalidity"),required:""},{default:a(()=>[e(y,{type:"number",modelValue:c.value.jwtconf.jwt_expires,"onUpdate:modelValue":x[11]||(x[11]=k=>c.value.jwtconf.jwt_expires=k)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","model"])]),_:1},8,["header"]),e(N,{header:t(l)("app.webui.noticeconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(T,{disabled:H.value,model:c.value.noticeconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e($,{label:t(l)("app.webui.noticetype")},{default:a(()=>[e(O,{modelValue:c.value.noticeconf.type,"onUpdate:modelValue":x[12]||(x[12]=k=>c.value.noticeconf.type=k)},{default:a(()=>[(r(!0),M(ue,null,ce(g.value,k=>(r(),C(P,{key:k.key,label:k.value,value:k.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e($,{label:"Webhook"},{default:a(()=>[e(y,{modelValue:c.value.noticeconf.webhook,"onUpdate:modelValue":x[13]||(x[13]=k=>c.value.noticeconf.webhook=k)},null,8,["modelValue"])]),_:1}),c.value.noticeconf.type==1?(r(),C($,{key:0,label:"Secret"},{default:a(()=>[e(y,{type:"password","show-password":"",modelValue:c.value.noticeconf.secret,"onUpdate:modelValue":x[14]||(x[14]=k=>c.value.noticeconf.secret=k)},null,8,["modelValue"])]),_:1})):re("",!0)]),_:1},8,["disabled","model"])]),_:1},8,["header"]),H.value?(r(),M("div",Xa,[e(G,{type:"primary",onClick:x[15]||(x[15]=k=>H.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:1})])):(r(),M("div",Ya,[e(G,{type:"primary",onClick:E},{default:a(()=>[s(o(t(l)("app.webui.save")),1)]),_:1}),e(G,{onClick:x[16]||(x[16]=k=>H.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1})]))],64)}}}),Ja={style:{"font-weight":"lighter","font-size":"17px"}},Ka={style:{display:"flex","justify-content":"space-around"}},et={style:{display:"flex",width:"80%",gap:"1%"}},lt={key:0},at={key:1},tt={key:2},ot={key:3},ut={slot:"footer",class:"dialog-footer"},nt={slot:"footer",class:"dialog-footer"},st=ve({__name:"ScoreRule",setup(de){const{t:l}=fe(),H=sessionStorage.getItem("token"),q=b({}),c=b(""),g=[W],_=b(1),E=b(15),d=b(0),x=b(!1),F=b(!1),$=b([]),y=b({}),T=b([{id:1,type:l("app.webui.pocscorerule")},{id:2,type:l("app.webui.exprule")},{id:3,type:l("app.webui.incidencerule")},{id:4,type:l("app.webui.otherrule")}]),N=b(!0),P=h=>{$.value=h,h.length>0?N.value=!1:N.value=!0},O=(h,i)=>{y.value.id=i.id,y.value.type=i.type,y.value.rule=i.rule,y.value.score=i.score,y.value.coefficient=i.coefficient,F.value=!0};function G(h,i){const p=new Date(h.create_time),R=new Date(i.create_time);return p<R?-1:p>R?1:0}const k=ze(()=>{const i=0+E.value;if(c.value.trim()!="")return q.value.data.filter(p=>p.name.toLowerCase().includes(c.value.toLowerCase()));try{return q.value.data.slice(0,i)}catch{return[]}});function w(h){E.value=h,_.value=1,W()}async function le(h){_.value=h,await W()}me(()=>{g.forEach(h=>{h()})});async function W(){try{const h={headers:{Authorization:`Bearer ${H}`}},i=await X.get(`/api/v1/getscorerules?page=${_.value}&limit=${E.value}`,h);i.data.code!=1&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username")),q.value=i.data,d.value=i.data.total}catch{}}function ne(){Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const h={ids:$.value.map(i=>i.id)};try{const i={headers:{Authorization:`Bearer ${H}`}},p=await X.post("/api/v1/multidelscorerules",h,i);p.data.code==1?(z.success(l("app.webui.delsuccess")),W(),N.value=!1):p.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})}const se=(h,i)=>{Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{try{const p={headers:{Authorization:`Bearer ${H}`}},R=await X.post("/api/v1/delscorerule",{id:i.id},p);if(R.data.code==1){z({type:"success",message:l("app.webui.delsuccess")}),W(),F.value=!1;return}else if(R.data.code==2){z({type:"error",message:l("app.webui.invalidinput")});return}else if(R.data.code==3){z({type:"error",message:l("app.webui.delfail")});return}}catch{}}).catch(()=>{})},te=(h,i)=>i.type===h,j=()=>{y.value={id:null,type:1,rule:"",score:null,coefficient:1}},v=async()=>{try{const h={headers:{Authorization:`Bearer ${H}`}};y.value.score=Number(y.value.score),y.value.coefficient=Number(y.value.coefficient);const i=await X.post("/api/v1/addscorerule",y.value,h);if(i.data.code==1)W(),z.success(l("app.webui.addsuccess")),x.value=!1;else if(i.data.code==2){z.error(l("app.webui.invalidinput"));return}else if(i.data.code==3){z.error(l("app.webui.addfail"));return}}catch{}},V=async()=>{try{const h={headers:{Authorization:`Bearer ${H}`}};y.value.score=Number(y.value.score),y.value.coefficient=Number(y.value.coefficient);const i=await X.post("/api/v1/editscorerule",y.value,h);if(i.data.code==1){W(),z.success(l("app.webui.addsuccess")),F.value=!1;return}else if(i.data.code==2){z.error(l("app.webui.invalidinput"));return}else if(i.data.code==3){z.error(l("app.webui.modifyfail"));return}}catch{}};return(h,i)=>{const p=we,R=he,S=Se,m=Ue,Y=qe,B=be,J=Me,Q=Le,Z=Ee,_e=Be,ee=De;return r(),M(ue,null,[n("div",null,[e(B,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[n("div",Ja,[n("div",Ka,[n("div",et,[e(p,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=A=>c.value=A),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),n("div",null,[e(R,{type:"primary",onClick:i[1]||(i[1]=A=>x.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.add")),1)]),_:1}),e(R,{disabled:N.value,type:"danger",onClick:ne},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(m,{data:k.value,onSelectionChange:P},{default:a(()=>[e(S,{type:"selection",width:"55"}),e(S,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"80"},null,8,["label"]),e(S,{label:t(l)("app.webui.type"),filters:[{text:t(l)("app.webui.pocscorerule"),value:1},{text:t(l)("app.webui.exprule"),value:2},{text:t(l)("app.webui.incidencerule"),value:3},{text:t(l)("app.webui.otherrule"),value:4}],"filter-method":te,width:"140"},{default:a(({row:A})=>[A.type==1?(r(),M("span",lt,o(t(l)("app.webui.pocscorerule")),1)):A.type==2?(r(),M("span",at,o(t(l)("app.webui.exprule")),1)):A.type==3?(r(),M("span",tt,o(t(l)("app.webui.incidencerule")),1)):(r(),M("span",ot,o(t(l)("app.webui.otherrule")),1))]),_:1},8,["label","filters"]),e(S,{prop:"rule",label:t(l)("app.webui.scorerule")},null,8,["label"]),e(S,{prop:"score",label:t(l)("app.webui.score"),width:"120"},null,8,["label"]),e(S,{prop:"coefficient",label:t(l)("app.webui.coefficient"),width:"120"},null,8,["label"]),e(S,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":G,width:"140"},{default:a(({row:A})=>[n("span",null,o(t(ie)(A.create_time)),1)]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":G,width:"140"},{default:a(({row:A})=>[n("span",null,o(t(ie)(A.update_time)),1)]),_:1},8,["label"]),e(S,{label:t(l)("app.webui.operate"),width:"140"},{default:a(A=>[e(R,{size:"small",type:"primary",onClick:K=>O(A.$index,A.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(R,{size:"small",type:"danger",onClick:K=>se(A.$index,A.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(Y,{"page-sizes":[15,25,50,100,200,300],"page-size":E.value,"onUpdate:pageSize":i[2]||(i[2]=A=>E.value=A),layout:"total, sizes, prev, pager, next, jumper",total:d.value,onSizeChange:w,onCurrentChange:le,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(ee,{title:t(l)("app.webui.addscore"),modelValue:x.value,"onUpdate:modelValue":i[8]||(i[8]=A=>x.value=A),width:"30%",onClose:j},{default:a(()=>[e(_e,{model:y.value,"label-width":"100px"},{default:a(()=>[e(Z,{label:t(l)("app.webui.type")},{default:a(()=>[e(Q,{modelValue:y.value.type,"onUpdate:modelValue":i[3]||(i[3]=A=>y.value.type=A),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(r(!0),M(ue,null,ce(T.value,A=>(r(),C(J,{key:A.id,label:A.type,value:A.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(Z,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(p,{modelValue:y.value.rule,"onUpdate:modelValue":i[4]||(i[4]=A=>y.value.rule=A),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(Z,{label:t(l)("app.webui.score")},{default:a(()=>[e(p,{modelValue:y.value.score,"onUpdate:modelValue":i[5]||(i[5]=A=>y.value.score=A),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(Z,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(p,{modelValue:y.value.coefficient,"onUpdate:modelValue":i[6]||(i[6]=A=>y.value.coefficient=A),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),n("span",ut,[e(R,{onClick:i[7]||(i[7]=A=>x.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(R,{type:"primary",onClick:v},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(ee,{title:t(l)("app.webui.editscore"),modelValue:F.value,"onUpdate:modelValue":i[14]||(i[14]=A=>F.value=A),width:"30%",onClose:j},{default:a(()=>[e(_e,{model:y.value,"label-width":"100px"},{default:a(()=>[e(Z,{label:t(l)("app.webui.type")},{default:a(()=>[e(Q,{modelValue:y.value.type,"onUpdate:modelValue":i[9]||(i[9]=A=>y.value.type=A),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(r(!0),M(ue,null,ce(T.value,A=>(r(),C(J,{key:A.id,label:A.type,value:A.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(Z,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(p,{modelValue:y.value.rule,"onUpdate:modelValue":i[10]||(i[10]=A=>y.value.rule=A),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(Z,{label:t(l)("app.webui.score")},{default:a(()=>[e(p,{modelValue:y.value.score,"onUpdate:modelValue":i[11]||(i[11]=A=>y.value.score=A),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(Z,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(p,{modelValue:y.value.coefficient,"onUpdate:modelValue":i[12]||(i[12]=A=>y.value.coefficient=A),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),n("span",nt,[e(R,{onClick:i[13]||(i[13]=A=>F.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(R,{type:"primary",onClick:V},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),it=ke(st,[["__scopeId","data-v-a337e590"]]),dt={style:{"font-weight":"lighter","font-size":"17px"}},rt={style:{display:"flex","justify-content":"space-around"}},pt={style:{display:"flex",width:"80%",gap:"1%"}},ct={slot:"footer",class:"dialog-footer"},vt={slot:"footer",class:"dialog-footer"},ft=ve({__name:"VulnType",setup(de){const{t:l}=fe(),H=b({}),q=b(""),c=sessionStorage.getItem("token"),g=[W],_=b(1),E=b(15),d=b(0),x=b(!1),F=b(!1),$=b({}),y=b([]),T=b(!0),N=v=>{y.value=v,v.length>0?T.value=!1:T.value=!0},P=(v,V)=>{$.value.id=V.id,$.value.name=V.name,F.value=!0},O=()=>{$.value.id=null,$.value.name=""};function G(v,V){const h=new Date(v.create_time),i=new Date(V.create_time);return h<i?-1:h>i?1:0}const k=ze(()=>{const V=0+E.value;if(q.value.trim()!="")return H.value.data.filter(h=>h.name.toLowerCase().includes(q.value.toLowerCase()));try{return H.value.data.slice(0,V)}catch{return[]}});function w(v){E.value=v,_.value=1,W()}async function le(v){_.value=v,await W()}me(()=>{g.forEach(v=>{v()})});async function W(){try{const v=await X.get(`/api/v1/getvulntype?page=${_.value}&limit=${E.value}`);H.value=v.data,d.value=v.data.total}catch{}}function ne(){Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const v={ids:y.value.map(V=>V.id)};try{const V={headers:{Authorization:`Bearer ${c}`}},h=await X.post("/api/v1/multidelvulntypes",v,V);h.data.code==1?(z.success(l("app.webui.delsuccess")),W()):h.data.code==0?z.error(l("app.webui.needlogin")):z.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})}const se=(v,V)=>{Ve.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{try{const h={headers:{Authorization:`Bearer ${c}`}},i=await X.post("/api/v1/delvulntype",{id:V.id},h);if(i.data.code==1){z({type:"success",message:l("app.webui.delsuccess")}),W(),x.value=!1;return}else if(i.data.code==2){z({type:"error",message:l("app.webui.invalidinput")});return}else if(i.data.code==3){z({type:"error",message:l("app.webui.delfail")});return}}catch{}}).catch(()=>{})};async function te(){try{const v={headers:{Authorization:`Bearer ${c}`}},V=await X.post("/api/v1/addvulntype",$.value,v);if(V.data.code==1){z({type:"success",message:l("app.webui.addsuccess")}),W(),x.value=!1;return}else if(V.data.code==2){z({type:"error",message:l("app.webui.invalidinput")});return}else if(V.data.code==3){z({type:"error",message:l("app.webui.addfail")});return}}catch{}}const j=()=>{try{const v={headers:{Authorization:`Bearer ${c}`}},V=X.post("/api/v1/updatevulntype",$.value,v);if(V.data.code==1){z({type:"success",message:l("app.webui.modifysucc")}),W(),F.value=!1;return}else if(V.data.code==2){z({type:"error",message:l("app.webui.invalidinput")});return}else if(V.data.code==3){z({type:"error",message:l("app.webui.modifyfail")});return}}catch{}};return(v,V)=>{const h=we,i=he,p=Se,R=Ue,S=qe,m=be,Y=Ee,B=Be,J=De;return r(),M(ue,null,[n("div",null,[e(m,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[n("div",dt,[n("div",rt,[n("div",pt,[e(h,{modelValue:q.value,"onUpdate:modelValue":V[0]||(V[0]=Q=>q.value=Q),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),n("div",null,[e(i,{type:"primary",onClick:V[1]||(V[1]=Q=>x.value=!0)},{default:a(()=>[s(o(t(l)("app.webui.add")),1)]),_:1}),e(i,{disabled:T.value,type:"danger",onClick:ne},{default:a(()=>[s(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(R,{data:k.value,onSelectionChange:N},{default:a(()=>[e(p,{type:"selection",width:"55"}),e(p,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(p,{prop:"name",label:t(l)("app.webui.name")},null,8,["label"]),e(p,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":G},{default:a(({row:Q})=>[n("span",null,o(t(ie)(Q.create_time)),1)]),_:1},8,["label"]),e(p,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":G},{default:a(({row:Q})=>[n("span",null,o(t(ie)(Q.update_time)),1)]),_:1},8,["label"]),e(p,{label:t(l)("app.webui.operate")},{default:a(Q=>[e(i,{size:"small",type:"primary",onClick:Z=>P(Q.$index,Q.row)},{default:a(()=>[s(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(i,{size:"small",type:"danger",onClick:Z=>se(Q.$index,Q.row)},{default:a(()=>[s(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(S,{"page-sizes":[15,25,50,100,200,300],"page-size":E.value,"onUpdate:pageSize":V[2]||(V[2]=Q=>E.value=Q),layout:"total, sizes, prev, pager, next, jumper",total:d.value,onSizeChange:w,onCurrentChange:le,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(J,{title:t(l)("app.webui.addvulntype"),modelValue:x.value,"onUpdate:modelValue":V[5]||(V[5]=Q=>x.value=Q),width:"30%",onClose:O},{default:a(()=>[e(B,{model:$.value,"label-width":"100px"},{default:a(()=>[e(Y,{label:t(l)("app.webui.name")},{default:a(()=>[e(h,{modelValue:$.value.name,"onUpdate:modelValue":V[3]||(V[3]=Q=>$.value.name=Q),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),n("span",ct,[e(i,{onClick:V[4]||(V[4]=Q=>x.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(i,{type:"primary",onClick:te},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(J,{title:t(l)("app.webui.editvulntype"),modelValue:F.value,"onUpdate:modelValue":V[9]||(V[9]=Q=>F.value=Q),width:"30%",onClose:O},{default:a(()=>[e(B,{model:$.value,"label-width":"100px"},{default:a(()=>[e(Y,{label:t(l)("app.webui.id")},{default:a(()=>[e(h,{modelValue:$.value.id,"onUpdate:modelValue":V[6]||(V[6]=Q=>$.value.id=Q),autocomplete:"off",disabled:"true"},null,8,["modelValue"])]),_:1},8,["label"]),e(Y,{label:t(l)("app.webui.name")},{default:a(()=>[e(h,{modelValue:$.value.name,"onUpdate:modelValue":V[7]||(V[7]=Q=>$.value.name=Q),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),n("span",vt,[e(i,{onClick:V[8]||(V[8]=Q=>F.value=!1)},{default:a(()=>[s(o(t(l)("app.webui.cancel")),1)]),_:1}),e(i,{type:"primary",onClick:j},{default:a(()=>[s(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),mt=ke(ft,[["__scopeId","data-v-60862191"]]),bt={style:{display:"flex"}},_t={style:{"margin-top":"20px","font-size":"14px"}},yt={style:{"margin-top":"20px","font-size":"14px"}},wt={style:{"margin-top":"20px","font-size":"14px"}},ht=ve({__name:"Profile",setup(de){const{t:l}=fe(),H=sessionStorage.getItem("token"),q=b({}),c=b(!0),g=[E],_=b(sessionStorage.getItem("avatar"));me(()=>{g.forEach(N=>{N()})});async function E(){try{const N={headers:{Authorization:`Bearer ${H}`}},P=await X.get("/api/v1/userinfo",N);q.value=P.data.data,H&&P.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload())}catch{}}const d=N=>{_.value=URL.createObjectURL(N)},x=N=>{z.success(l("app.webui.uploadsucc")),sessionStorage.setItem("avatar","/download/file?id="+N.data),location.reload()},F=()=>{if(!q.value.email.match(/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)){z.error(l("app.webui.emailformat"));return}y()},$=()=>{if(!q.value.phone.match(/^[1][3,4,5,6,7,8,9][0-9]{9}$/)){z.error(l("app.webui.phoneformat"));return}y()},y=()=>{c.value=!1},T=async()=>{console.log(q.value);try{const N={headers:{Authorization:`Bearer ${H}`}},P={username:q.value.username,email:q.value.email,phone:q.value.phone},O=await X.post("/api/v1/updateuserinfo",P,N);O.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):O.data.code==1?z.success(l("app.webui.modifysucc")):z.error(l("app.webui.modifyerr"))}catch(N){console.error(N)}};return(N,P)=>{const O=Xe,G=Oe,k=we,w=he,le=be;return r(),M("div",null,[e(le,{style:{padding:"30px"},header:t(l)("app.webui.myprofile")},{default:a(()=>[n("div",bt,[e(G,{accept:".png,.jpg",action:"/api/v1/updateavatar","on-success":x,headers:{Authorization:`Bearer ${t(H)}`},"before-upload":d},{default:a(()=>[e(O,{size:"large",src:_.value},null,8,["src"])]),_:1},8,["headers"])]),n("div",_t,o(t(l)("app.webui.username")),1),e(k,{modelValue:q.value.username,"onUpdate:modelValue":P[0]||(P[0]=W=>q.value.username=W),size:"large",placeholder:q.value.username,style:{"margin-top":"10px"},onChange:y},null,8,["modelValue","placeholder"]),n("div",yt,o(t(l)("app.webui.email")),1),e(k,{modelValue:q.value.email,"onUpdate:modelValue":P[1]||(P[1]=W=>q.value.email=W),size:"large",placeholder:q.value.email,style:{"margin-top":"10px"},onChange:F},null,8,["modelValue","placeholder"]),n("div",wt,o(t(l)("app.webui.phone")),1),e(k,{modelValue:q.value.phone,"onUpdate:modelValue":P[2]||(P[2]=W=>q.value.phone=W),size:"large",placeholder:q.value.phone,style:{"margin-top":"10px"},onChange:$},null,8,["modelValue","placeholder"]),e(w,{type:"primary",style:{"margin-top":"20px"},disabled:c.value,onClick:T},{default:a(()=>[s(o(t(l)("app.webui.modify")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}}),gt={style:{"margin-top":"20px","font-size":"14px"}},Vt={style:{"margin-top":"20px","font-size":"14px"}},xt={style:{"margin-top":"20px","font-size":"14px"}},kt=ve({__name:"Modifypasswd",setup(de){const{t:l}=fe(),H=b(!0),q=sessionStorage.getItem("token"),c=b(""),g=b(""),_=b(""),E=()=>g.value.length<8?(z.error(l("app.webui.passwordlength")),!1):g.value.match(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,}$/)?!0:(z.error(l("app.webui.passwordcomplex")),!1),d=()=>{if(g.value!=_.value){z.error(l("app.webui.passwordnotmatch"));return}E()&&x()},x=()=>{H.value=!1};async function F(){console.log(c,g,_);try{const $={headers:{Authorization:`Bearer ${q}`}},y={oldpassword:c.value,newpassword:g.value},T=await X.post("/api/v1/updatepassword",y,$);T.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):T.data.code==1?z.success(l("app.webui.modifysucc")):T.data.code==3?z.error(l("app.webui.oldpassworderr")):z.error(l("app.webui.modifyerr"))}catch{z.error(l("app.webui.modifyfail"))}}return($,y)=>{const T=we,N=he,P=be;return r(),M("div",null,[e(P,{style:{padding:"30px"},header:t(l)("app.webui.alterpwd")},{default:a(()=>[n("div",gt,o(t(l)("app.webui.oldpassword")),1),e(T,{modelValue:c.value,"onUpdate:modelValue":y[0]||(y[0]=O=>c.value=O),size:"large",placeholder:c.value,style:{"margin-top":"10px"},type:"password","show-password":""},null,8,["modelValue","placeholder"]),n("div",Vt,o(t(l)("app.webui.newpassword")),1),e(T,{modelValue:g.value,"onUpdate:modelValue":y[1]||(y[1]=O=>g.value=O),size:"large",placeholder:g.value,style:{"margin-top":"10px"},type:"password","show-password":"",onChange:E},null,8,["modelValue","placeholder"]),n("div",xt,o(t(l)("app.webui.confirmpassword")),1),e(T,{modelValue:_.value,"onUpdate:modelValue":y[2]||(y[2]=O=>_.value=O),size:"large",placeholder:_.value,style:{"margin-top":"10px"},type:"password","show-password":"",onChange:d},null,8,["modelValue","placeholder"]),e(N,{type:"primary",disabled:H.value,style:{"margin-top":"20px"},onClick:F},{default:a(()=>[s(o(t(l)("app.webui.submit")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}}),$t={style:{cursor:"pointer","margin-left":"auto"}},Ct={style:{display:"flex","align-items":"center"}},zt={style:{display:"flex",margin:"auto",cursor:"pointer"}},St={key:0},Ut={key:1},qt={key:2},Et={key:3},Bt={key:4},It={key:5},Lt={key:6},Mt={key:7},At={key:8},Ht={key:9},jt=ve({__name:"Index",setup(de){const{t:l,locale:H}=fe(),q=b(!1),c=b(!1),g=G=>{H.value=G,localStorage.setItem("selectedLanguage",G),d.value="1"},_=sessionStorage.getItem("username"),E=sessionStorage.getItem("avatar"),d=b("1"),x=b(!1),F=sessionStorage.getItem("token");function $(){x.value=!x.value}function y(G){d.value=G}const T=dl();me(N);function N(){F||T.push("/login")}function P(G){G==1&&(d.value="",c.value=!1,q.value=!0),G==2&&(d.value="",q.value=!1,c.value=!0),G==3&&O()}async function O(){try{const G={headers:{Authorization:`Bearer ${F}`}},k=await X.get("/api/v1/logout",G);sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("avatar"),location.reload()}catch{}}return(G,k)=>{const w=Xe,le=_l,W=yl,ne=wl,se=hl,te=Ie,j=gl,v=Vl,V=xl,h=kl,i=rl;return r(),M("div",null,[e(i,{style:{width:"100%"}},{default:a(()=>[e(se,{style:{"background-color":"#393939",display:"flex","justify-content":"flex-end","align-items":"center",padding:"10px"}},{default:a(()=>[k[2]||(k[2]=n("div",{style:{display:"flex","justify-content":"center","align-items":"center",color:"#fff"}},[n("img",{src:$l,fit:"contain",style:{"margin-left":"1vw",height:"50px",width:"50px"}}),n("span",{style:{"margin-left":"1vw"}},"")],-1)),n("div",$t,[e(ne,{style:{color:"#fff"},trigger:"click",onCommand:P},{dropdown:a(()=>[e(W,null,{default:a(()=>[e(le,{command:"1"},{default:a(()=>[s(o(t(l)("app.webui.myprofile")),1)]),_:1}),e(le,{command:"2"},{default:a(()=>[s(o(t(l)("app.webui.alterpwd")),1)]),_:1}),e(le,{command:"3"},{default:a(()=>[s(o(t(l)("app.webui.logout")),1)]),_:1})]),_:1})]),default:a(()=>[n("span",Ct,[e(w,{style:{"margin-right":"10px"},src:t(E)},null,8,["src"]),s(" "+o(t(_)),1)])]),_:1})])]),_:1}),e(i,{style:{width:"100%"}},{default:a(()=>[e(V,{collapse:x.value,class:"el-menu-vertical-demo",onSelect:y},{default:a(()=>[e(j,{index:"1",style:{"margin-top":"2vh"}},{default:a(()=>[e(te,null,{default:a(()=>[e(t(pl))]),_:1}),n("span",null,o(t(l)("app.webui.dashboard")),1)]),_:1}),e(j,{index:"2"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(cl))]),_:1}),n("span",null,o(t(l)("app.webui.systemsetting")),1)]),_:1}),e(j,{index:"3"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(vl))]),_:1}),n("span",null,o(t(l)("app.webui.usermanager")),1)]),_:1}),e(v,{index:"4"},{title:a(()=>[e(te,null,{default:a(()=>k[3]||(k[3]=[n("svg",{t:"1728359731855",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1480",width:"200",height:"200"},[n("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"1481",fill:"#515151"}),n("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"1482",fill:"#515151"})],-1)])),_:1}),n("span",null,o(t(l)("app.webui.vulnmanager")),1)]),default:a(()=>[e(j,{index:"4-1"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(Ae))]),_:1}),n("span",null,o(t(l)("app.webui.vulntype")),1)]),_:1}),e(j,{index:"4-2"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(Ae))]),_:1}),n("span",null,o(t(l)("app.webui.allvuln")),1)]),_:1}),e(j,{index:"4-3"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(Ae))]),_:1}),n("span",null,o(t(l)("app.webui.unaudit")),1)]),_:1}),e(j,{index:"4-4"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(Ae))]),_:1}),n("span",null,o(t(l)("app.webui.audited")),1)]),_:1})]),_:1}),e(j,{index:"5"},{default:a(()=>[e(te,null,{default:a(()=>[e(t(fl))]),_:1}),n("span",null,o(t(l)("app.webui.scorerule")),1)]),_:1}),e(v,{index:"6"},{title:a(()=>[k[4]||(k[4]=n("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em","data-v-f414ea64":"",class:"el-icon"},[n("path",{fill:"currentColor",d:"m18.5 10l4.4 11h-2.155l-1.201-3h-4.09l-1.199 3h-2.154L16.5 10h2zM10 2v2h6v2h-1.968a18.222 18.222 0 0 1-3.62 6.301a14.864 14.864 0 0 0 2.336 1.707l-.751 1.878A17.015 17.015 0 0 1 9 13.725a16.676 16.676 0 0 1-6.201 3.548l-.536-1.929a14.7 14.7 0 0 0 5.327-3.042A18.078 18.078 0 0 1 4.767 8h2.24A16.032 16.032 0 0 0 9 10.877a16.165 16.165 0 0 0 2.91-4.876L2 6V4h6V2h2zm7.5 10.885L16.253 16h2.492L17.5 12.885z"})],-1)),n("span",null,o(t(l)("app.webui.language")),1)]),default:a(()=>[e(j,{index:"11-1",onClick:k[0]||(k[0]=p=>g("zh-CN"))},{default:a(()=>k[5]||(k[5]=[s("")])),_:1}),e(j,{index:"11-2",onClick:k[1]||(k[1]=p=>g("en-US"))},{default:a(()=>k[6]||(k[6]=[s("English")])),_:1})]),_:1}),n("div",zt,[x.value?(r(),C(te,{key:1,onClick:$,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(bl))]),_:1})):(r(),C(te,{key:0,onClick:$,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(ml))]),_:1}))])]),_:1},8,["collapse"]),e(h,null,{default:a(()=>[d.value==="1"?(r(),M("div",St,[e(Il)])):d.value==="2"?(r(),M("div",Ut,[e(Wa)])):d.value==="3"?(r(),M("div",qt,[e(Nl)])):d.value==="4-1"?(r(),M("div",Et,[e(mt)])):d.value==="4-2"?(r(),M("div",Bt,[e(ra)])):d.value==="4-3"?(r(),M("div",It,[e(Ua)])):d.value==="4-4"?(r(),M("div",Lt,[e(Qa)])):d.value==="5"?(r(),M("div",Mt,[e(it)])):q.value?(r(),M("div",At,[e(ht)])):c.value?(r(),M("div",Ht,[e(kt)])):re("",!0)]),_:1})]),_:1})]),_:1})])}}}),Tt=ke(jt,[["__scopeId","data-v-9461eefe"]]);export{Tt as default};
