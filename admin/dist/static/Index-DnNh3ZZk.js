import{d as ve,u as me,a as Je,r as w,o as fe,b as d,c as A,e as u,f as e,w as a,t as o,g as t,F as ae,E as We,h as _e,i as Ie,j as Ke,k as el,l as ll,m as $e,n,p as x,q as ce,s as we,v as Z,x as he,y as ge,z as ze,A as je,B as Se,C as Ue,D as Be,G as qe,H as Ee,I as Ae,J as De,K as Le,_ as Ve,L as al,M as se,N as Ce,O as tl,P as ol,Q as Ge,R as Te,S as Pe,T as Fe,U as Re,V as ul,W as nl,X as il,Y as sl,Z as dl,$ as He,a0 as pl,a1 as rl,a2 as cl,a3 as vl,a4 as ml,a5 as fl,a6 as bl,a7 as _l,a8 as yl,a9 as wl,aa as hl}from"./index-DfD0j7gc.js";import{a as J}from"./el-message-ZkJEpQUo.js";const gl="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='37.07'%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20198'%3e%3cpath%20fill='%2341B883'%20d='M204.8%200H256L128%20220.8L0%200h97.92L128%2051.2L157.44%200h47.36Z'%3e%3c/path%3e%3cpath%20fill='%2341B883'%20d='m0%200l128%20220.8L256%200h-51.2L128%20132.48L50.56%200H0Z'%3e%3c/path%3e%3cpath%20fill='%2335495E'%20d='M50.56%200L128%20133.12L204.8%200h-47.36L128%2051.2L97.92%200H50.56Z'%3e%3c/path%3e%3c/svg%3e",Vl={style:{display:"flex","justify-content":"center"}},xl={style:{display:"flex","justify-content":"center"}},kl={style:{display:"flex","justify-content":"center"}},Cl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},$l={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},zl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Sl={style:{display:"flex","font-size":"13px","margin-top":"6%",gap:"10px"}},Ul=ve({__name:"Dashboard",setup(de){const{t:l}=me(),P=Je(),L=w({}),f=w({}),V=[{color:"#20a53a",percentage:30},{color:"orange",percentage:60},{color:"red",percentage:100}],h=[k,_];let p=setInterval(_,3e3);fe(()=>{h.forEach(U=>{U()})});async function _(){const U=sessionStorage.getItem("token");try{const C={headers:{Authorization:`Bearer ${U}`}},T=await J.get("/api/v1/getsystemstatus",C);T.data.code!=1&&(clearInterval(p),sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),P.push("/login")),L.value=T.data.data}catch{}}async function k(){try{const U=await J.get("/api/v1/getvulnabs");f.value=U.data}catch{}}return(U,C)=>{const T=We,G=_e,D=Ie,q=Ke,N=el,c=ll;return d(),A(ae,null,[u("div",null,[e(G,{style:{"margin-top":"1%"},header:t(l)("app.webui.systemstatus"),"body-style":"display: flex; justify-content: space-around;"},{default:a(()=>[u("div",null,[u("span",Vl,o(t(l)("app.webui.cpuuse")),1),e(T,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:L.value.cpu,color:V},null,8,["percentage"])]),u("div",null,[u("span",xl,o(t(l)("app.webui.ramuse")),1),e(T,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:L.value.mem,color:V},null,8,["percentage"])]),u("div",null,[u("span",kl,o(t(l)("app.webui.diskuse")),1),e(T,{style:{"margin-top":"10%","font-weight":"bold"},type:"dashboard","stroke-width":"12",percentage:L.value.disk,color:V},null,8,["percentage"])])]),_:1},8,["header"]),e(G,{header:t(l)("app.webui.vulnstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(q,{justify:"start"},{default:a(()=>[e(G,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalvuln")),1),e(D,{size:"25"},{default:a(()=>C[0]||(C[0]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:f.value.total},null,8,["value"]),u("div",Cl,[u("span",null,o(t(l)("app.webui.weeklyadditions")),1),u("span",null,o(f.value.weeklyAdditionsVuln),1)])]),_:1})]),_:1}),e(G,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalpoc")),1),e(D,{size:"25"},{default:a(()=>C[1]||(C[1]=[u("svg",{t:"1727429978264",class:"icon",viewBox:"0 0 1161 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"20805",width:"200",height:"200"},[u("path",{d:"M258.205538 354.461538c10.436923 0 18.924308 8.467692 18.924308 18.944v624.836924c0 10.456615-8.467692 18.944-18.924308 18.944H177.289846a18.944 18.944 0 0 1-18.924308-18.944v-624.836924c0-10.476308 8.467692-18.944 18.924308-18.944h80.915692z m158.365539 120.497231c10.436923 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944h-80.915692a18.944 18.944 0 0 1-18.924308-18.944V493.883077c0-10.436923 8.467692-18.924308 18.924308-18.924308h80.915692z m-316.731077 0c10.456615 0 18.924308 8.467692 18.924308 18.924308v504.359385c0 10.456615-8.467692 18.944-18.924308 18.944H18.944A18.944 18.944 0 0 1 0 998.242462V493.883077c0-10.436923 8.467692-18.924308 18.944-18.924308H99.84z m139.421538-82.628923H196.214154v586.988308h43.047384V392.329846z m158.365539 120.477539h-43.027692V979.298462h43.027692V512.787692z m-316.731077 0H37.868308V979.298462h43.027692V512.787692zM1063.384615 0a98.461538 98.461538 0 0 1 98.461539 98.461538v748.307693a98.461538 98.461538 0 0 1-98.461539 98.461538H492.307692V433.230769a39.384615 39.384615 0 0 0-36.430769-39.286154L452.923077 393.846154h-98.461539v-59.076923a39.384615 39.384615 0 0 0-36.430769-39.286154L315.076923 295.384615h-98.461538V98.461538a98.461538 98.461538 0 0 1 98.461538-98.461538h748.307692z m-142.867692 520.664615c-44.898462 0-78.769231 14.572308-102.4 44.504616-21.267692 26.387692-31.507692 60.258462-31.507692 102.006154 0 42.535385 9.846154 76.406154 30.326154 101.612307 23.236923 29.144615 57.895385 44.110769 103.975384 44.11077 30.326154 0 56.32-8.664615 77.981539-25.993847 23.236923-18.510769 37.809231-44.110769 44.110769-76.8h-41.747692l-1.476923 5.395693c-5.710769 19.377231-15.064615 34.126769-28.061539 44.228923-13.390769 10.24-30.72 15.36-51.2 15.36-31.507692 0-54.744615-9.846154-69.710769-29.538462-14.178462-18.510769-21.267692-44.504615-21.267692-78.375384 0-32.689231 7.089231-58.683077 21.661538-77.587693 15.36-20.873846 38.203077-31.113846 68.529231-31.113846 20.48 0 37.021538 4.332308 50.412307 13.390769 13.390769 9.058462 22.449231 23.236923 27.175385 42.141539h41.747692l-0.984615-5.592616c-5.060923-25.796923-17.329231-46.710154-36.430769-62.148923-21.267692-17.329231-48.443077-25.6-81.132308-25.6z m-30.956308-413.538461c-42.929231 0-76.8 13.784615-101.218461 42.141538-23.630769 26.781538-35.052308 61.44-35.052308 104.369231 0 42.535385 11.421538 77.193846 35.052308 103.975385 24.418462 27.569231 58.289231 41.747692 101.218461 41.747692 42.535385 0 76.406154-13.784615 101.218462-41.353846 23.630769-26.781538 35.446154-61.44 35.446154-104.369231 0-43.323077-11.815385-78.375385-35.446154-104.763077-24.812308-27.963077-58.683077-41.747692-101.218462-41.747692z m-292.489846 5.513846H480.492308V393.846154h42.92923v-109.489231h72.861539l5.395692-0.059077c63.763692-1.516308 95.822769-30.247385 95.822769-86.193231 0-57.107692-33.476923-85.464615-100.430769-85.464615z m292.470154 32.295385c29.932308 0 53.169231 9.452308 69.316923 29.144615 15.753846 19.298462 24.024615 45.686154 24.024616 79.556923 0 33.476923-8.270769 59.864615-24.024616 78.769231-16.147692 19.298462-39.384615 29.144615-69.316923 29.144615s-53.169231-10.24-69.710769-29.932307c-15.753846-19.298462-23.630769-45.292308-23.630769-77.981539 0-33.083077 7.876923-59.076923 23.630769-78.375385 16.541538-20.48 39.778462-30.326154 69.710769-30.326153z m-296.014769 4.332307c20.873846 0 36.233846 3.938462 46.08 11.815385 9.846154 7.089231 14.966154 19.692308 14.966154 37.021538 0 17.329231-5.12 29.932308-14.572308 37.809231-9.846154 7.876923-25.206154 11.815385-46.473846 11.815385h-70.104616v-98.461539z","p-id":"20806",fill:"#ed5565"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:f.value.hasPoc},null,8,["value"]),u("div",$l,[u("span",null,o(t(l)("app.webui.weeklyadditionspoc")),1),u("span",null,o(f.value.weeklyAdditionsPoc),1)])]),_:1})]),_:1}),e(G,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalexp")),1),e(D,{size:"25"},{default:a(()=>C[2]||(C[2]=[u("svg",{t:"1727429727880",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13778",width:"200",height:"200"},[u("path",{d:"M676.408889 303.407407l-101.262222-175.976296c-132.437333-40.201481-114.801778 130.085926-203.207111 168.846222L303.407407 246.708148C347.477333 160.274963 387.337481 83.057778 429.283556 0h206.582518L758.518519 235.747556 676.408889 303.407407zM127.393185 493.037037l80.327111 61.477926c-28.899556 61.060741-55.48563 117.380741-82.223407 173.018074 29.430519 138.657185 149.238519 47.824593 215.836444 103.917037V910.222222H94.966519L0 735.156148 127.393185 493.037037zM1024 735.004444L925.999407 910.222222H682.666667v-79.568592c68.342519-48.279704 171.956148 24.045037 212.574814-97.583408l-83.133629-184.395852L895.089778 493.037037 1024 735.004444zM0 387.640889L101.793185 189.62963 303.407407 422.874074l-12.818963 32.237037L0 387.640889zM1024 358.362074L739.745185 417.185185 720.592593 392.836741 919.210667 189.62963 1024 358.362074zM417.185185 1024l80.402963-263.661037 26.699852-1.820444L606.814815 1024h-189.62963z",fill:"#1296db","p-id":"13779"}),u("path",{d:"M606.814815 455.111111h-189.62963v-75.851852h189.62963v75.851852zM682.666667 568.888889H341.333333v-75.851852h341.333334v75.851852zM796.444444 682.666667H227.555556v-75.851852h568.888888v75.851852z",fill:"#1296db","p-id":"13780"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:f.value.hasExp},null,8,["value"]),u("div",zl,[u("span",null,o(t(l)("app.webui.weeklyadditionsexp")),1),u("span",null,o(f.value.weeklyAdditionsExp),1)])]),_:1})]),_:1}),e(G,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totalproduct")),1),e(D,{size:"25"},{default:a(()=>C[3]||(C[3]=[u("svg",{t:"1727429889519",class:"icon",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17925",width:"200",height:"200"},[u("path",{d:"M302.32811 504.78l-146.944-88.063c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048zM459.00011 1020.878c5.888 1.792 12.544 1.28 18.688-2.304-5.632 3.072-12.288 4.096-18.688 2.304zM302.32811 504.78l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z m0 0l-146.944-88.064c-11.776-7.168-27.136-3.328-34.048 8.448-7.168 11.776-3.328 27.136 8.448 34.304l146.944 88.064c11.776 7.168 27.136 3.328 34.048-8.704 7.168-11.802 3.328-27.162-8.448-34.048z",fill:"#3CBF71","p-id":"17926"}),u("path",{d:"M477.68811 1018.547c-6.144 3.584-12.8 4.096-18.688 2.304 6.4 1.818 13.056 0.794 18.688-2.304z",fill:"#3CBF71","p-id":"17927"}),u("path",{d:"M490.64111 954.112V511.744L880.27311 290.56l39.885-24.166c7.987-5.197 9.498-11.802 10.547-16.538 1.024-9.728-3.584-19.968-13.568-25.088L476.81711 4.608c-7.168-3.584-15.36-3.584-22.528 0L13.97011 224.768C-2.41489 235.52 0.14511 259.328 0.14511 261.888v469.76c0 8.704 4.608 16.896 12.032 21.504 0 0 430.848 260.352 438.272 263.68 15.104 7.424 24.576 5.376 31.744 1.792l143.36-82.944a25.56 25.56 0 0 0 9.216-35.072c-6.912-12.288-22.784-16.384-34.816-9.472l-99.072 57.6v-0.256l-10.24 5.632m-50.176-442.368v441.088l-390.4-235.264v-427.52l390.4 221.696z m25.088-43.52L78.22511 248.576 465.55311 55.04l387.328 193.536-387.328 219.648z",fill:"#3CBF71","p-id":"17928"}),u("path",{d:"M812.94511 917.376l201.984-121.344c5.632-3.584 9.216-9.728 9.216-16.64V556.928c0-7.834-5.888-13.312-12.288-16.384l-5.12-2.56c-0.512-0.256-1.28-0.256-1.792-0.256h1.536L810.13011 439.68c-5.376-2.56-11.776-2.56-17.152 0l-196.096 98.048c-14.336 5.504-17.92 17.792-17.92 24.704v216.96c0 6.912 3.584 13.056 9.472 16.64 0 0 200.167 120.09 201.19 120.346 0 0.025 11.93 8.857 23.322 0.998z m-30.464-49.152l-165.12-99.584V589.696l165.12 93.44v185.088z m19.2-218.112L640.65711 558.72l161.024-80.384L962.45011 558.72l-160.768 91.392zM985.74511 768.64l-164.864 99.328V683.136l164.864-93.44V768.64z",fill:"#3CBF71","p-id":"17929"})],-1)])),_:1})]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:f.value.affectedProduct},null,8,["value"]),u("div",Sl,[u("span",null,o(t(l)("app.webui.weeklyadditionsproduct")),1),u("span",null,o(f.value.weeklyAdditionsProduct),1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])]),e(G,{header:t(l)("app.webui.userstatistics"),style:{"margin-top":"2%","margin-bottom":"2%"}},{default:a(()=>[e(q,{justify:"start"},{default:a(()=>[e(G,{shadow:"always",style:{width:"15%",height:"30%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totaladmin")),1)]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:L.value.admintotal},null,8,["value"])]),_:1})]),_:1}),e(G,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.totaluser")),1)]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:L.value.usertotal},null,8,["value"])]),_:1})]),_:1}),e(G,{shadow:"always",style:{width:"15%",height:"30%","margin-left":"3%"}},{header:a(()=>[e(q,{justify:"space-between",style:{"font-size":"16px"}},{default:a(()=>[u("span",null,o(t(l)("app.webui.onlineuser")),1)]),_:1})]),default:a(()=>[e(c,null,{default:a(()=>[e(N,{value:L.value.onlineuser},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["header"])],64)}}});function ie(de){const l=new Date(de),P=l.getFullYear(),L=(l.getMonth()+1).toString().padStart(2,"0"),f=l.getDate().toString().padStart(2,"0");return`${P}-${L}-${f}`}const ql={style:{"font-weight":"lighter","font-size":"17px"}},El={style:{display:"flex","justify-content":"space-around"}},Il={style:{display:"flex",width:"80%",gap:"1%"}},Bl={key:0},Ll={key:1},Ml={class:"status"},Hl={slot:"footer",class:"dialog-footer"},jl={slot:"footer",class:"dialog-footer"},Al=ve({__name:"Userlist",setup(de){const{t:l}=me(),P=w({}),L=w([{id:1,label:l("app.webui.admin")},{id:0,label:l("app.webui.user")}]),f=w(""),V=sessionStorage.getItem("token"),h=w(!1),p=w(!1),_=w({}),k=[O],U=w(1),C=w(15),T=w(0),G=w([]),D=w(!0),q=w(""),N=g=>{G.value=g,g.length>0?D.value=!1:D.value=!0},c=$e(()=>{const v=0+C.value;if(f.value.trim()!="")return P.value.data.filter(R=>R.username.toLowerCase().includes(f.value.toLowerCase())||R.email.toLowerCase().includes(f.value.toLowerCase())||R.phone.includes(f.value));try{return P.value.data.slice(0,v)}catch{return[]}});function H(g){C.value=g,U.value=1,O()}async function le(g){U.value=g,await O()}fe(()=>{k.forEach(g=>{g()})});async function O(){try{const g={headers:{Authorization:`Bearer ${V}`}},v=await J.get(`/api/v1/getusers?page=${U.value}&limit=${C.value}`,g);v.data.code!=1&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username")),P.value=v.data,T.value=v.data.total}catch{}}function W(){we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{const g={ids:G.value.map(v=>v.id)};try{const v={headers:{Authorization:`Bearer ${V}`}},R=await J.post("/api/v1/multideleteusers",g,v);R.data.code==1?(O(),Z.success(l("app.webui.deletecomplete"))):R.data.code==0?Z.error(l("app.webui.needlogin")):Z.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})}const te=(g,v)=>{console.log("xxx",v),_.value.id=v.id,_.value.role=v.role,_.value.username=v.username,_.value.password=v.password,_.value.email=v.email,_.value.phone=v.phone,_.value.status=v.status==1,p.value=!0},oe=(g,v)=>v.role===g,ne=(g,v)=>v.status===g,z=(g,v)=>{we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(async()=>{console.log(JSON.stringify({id:v.id}));try{const R={headers:{Authorization:`Bearer ${V}`}},j=await J.post("/api/v1/deluser",{userid:v.id},R);j.data.code==1?(O(),Z.success(l("app.webui.deletecomplete"))):j.data.code==0?Z.error(l("app.webui.needlogin")):Z.error(l("app.webui.deletefail"))}catch{}}).catch(()=>{})},s=()=>{_.value.id=null,_.value.role=null,_.value.username="",_.value.password="",_.value.email="",_.value.phone="",_.value.status=null,q.value=""};async function m(){if(_.value.role==null){Z.error(l("app.webui.roleisnull"));return}if(_.value.username==""){Z.error(l("app.webui.usernameempty"));return}if(_.value.password==""){Z.error(l("app.webui.passwordempty"));return}if(_.value.password!=q.value){Z.error(l("app.webui.passwordnotmatch"));return}try{const g={headers:{Authorization:`Bearer ${V}`}},v=await J.post("/api/v1/adduser",_.value,g);v.data.code==1?(O(),Z.success(l("app.webui.addsuccess")),h.value=!1,console.log(_.value)):v.data.code==0?Z.error(l("app.webui.needlogin")):Z.error(l("app.webui.usernamealreadyexist"))}catch{}}async function E(){if(_.value.password==""&&_.value.password!=q.value){Z.error(l("app.webui.passwordnotmatch"));return}_.value.status=_.value.status==!0?1:0;try{const g={headers:{Authorization:`Bearer ${V}`}},v=await J.post("/api/v1/updateuser",_.value,g);v.data.code==1?(O(),Z.success(l("app.webui.modifysucc"))):v.data.code==0?Z.error(l("app.webui.needlogin")):Z.error(l("app.webui.modifyfail"))}catch{}p.value=!1}return(g,v)=>{const R=he,j=ge,b=ze,X=je,M=Se,I=Ue,ee=_e,Q=Le,r=Be,i=qe,F=Ee,$=Ae,xe=De;return d(),A(ae,null,[u("div",null,[e(ee,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",ql,[u("div",El,[u("div",Il,[e(R,{modelValue:f.value,"onUpdate:modelValue":v[0]||(v[0]=B=>f.value=B),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(j,{type:"primary",onClick:v[1]||(v[1]=B=>h.value=!0)},{default:a(()=>[n(o(t(l)("app.webui.add")),1)]),_:1}),e(j,{disabled:D.value,type:"danger",onClick:W},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(M,{data:c.value,onSelectionChange:N},{default:a(()=>[e(b,{type:"selection",width:"55"}),e(b,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(b,{prop:"username",label:t(l)("app.webui.username")},null,8,["label"]),e(b,{filters:[{text:t(l)("app.webui.admin"),value:1},{text:t(l)("app.webui.user"),value:0}],"filter-method":oe,label:t(l)("app.webui.role")},{default:a(({row:B})=>[B.role!=0?(d(),A("span",Bl,o(t(l)("app.webui.admin")),1)):(d(),A("span",Ll,o(t(l)("app.webui.user")),1))]),_:1},8,["filters","label"]),e(b,{prop:"email",label:t(l)("app.webui.email")},null,8,["label"]),e(b,{prop:"phone",label:t(l)("app.webui.phone")},null,8,["label"]),e(b,{filters:[{text:t(l)("app.webui.enable"),value:1},{text:t(l)("app.webui.disable"),value:0}],"filter-method":ne,label:t(l)("app.webui.status")},{default:a(({row:B})=>[u("div",Ml,[B.status!=0?(d(),x(X,{key:0,type:"success",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.enable")),1)]),_:1})):(d(),x(X,{key:1,type:"info",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.disable")),1)]),_:1}))])]),_:1},8,["filters","label"]),e(b,{label:t(l)("app.webui.createtime"),sortable:""},{default:a(({row:B})=>[u("span",null,o(t(ie)(B.create_time)),1)]),_:1},8,["label"]),e(b,{label:t(l)("app.webui.operate")},{default:a(B=>[e(j,{size:"small",type:"primary",onClick:pe=>te(B.$index,B.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(j,{size:"small",type:"danger",onClick:pe=>z(B.$index,B.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(I,{"page-sizes":[15,25,50,100,200,300],"page-size":C.value,"onUpdate:pageSize":v[2]||(v[2]=B=>C.value=B),layout:"total, sizes, prev, pager, next, jumper",total:T.value,onSizeChange:H,onCurrentChange:le,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e($,{title:t(l)("app.webui.adduser"),modelValue:h.value,"onUpdate:modelValue":v[10]||(v[10]=B=>h.value=B),width:"30%",onClose:s},{default:a(()=>[e(F,{model:_.value,"label-width":"100px"},{default:a(()=>[e(i,{required:"",label:t(l)("app.webui.role")},{default:a(()=>[e(r,{modelValue:_.value.role,"onUpdate:modelValue":v[3]||(v[3]=B=>_.value.role=B),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(d(!0),A(ae,null,ce(L.value,B=>(d(),x(Q,{key:B.id,label:B.label,value:B.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(i,{required:"",label:t(l)("app.webui.username")},{default:a(()=>[e(R,{modelValue:_.value.username,"onUpdate:modelValue":v[4]||(v[4]=B=>_.value.username=B),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{required:"",label:t(l)("app.webui.password")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:_.value.password,"onUpdate:modelValue":v[5]||(v[5]=B=>_.value.password=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{required:"",label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:q.value,"onUpdate:modelValue":v[6]||(v[6]=B=>q.value=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.email")},{default:a(()=>[e(R,{modelValue:_.value.email,"onUpdate:modelValue":v[7]||(v[7]=B=>_.value.email=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.phone")},{default:a(()=>[e(R,{modelValue:_.value.phone,"onUpdate:modelValue":v[8]||(v[8]=B=>_.value.phone=B)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",Hl,[e(j,{onClick:v[9]||(v[9]=B=>h.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(j,{type:"primary",onClick:m},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e($,{title:t(l)("app.webui.edituser"),modelValue:p.value,"onUpdate:modelValue":v[19]||(v[19]=B=>p.value=B),width:"30%",onClose:s},{default:a(()=>[e(F,{model:_.value,"label-width":"100px"},{default:a(()=>[e(i,{label:t(l)("app.webui.role")},{default:a(()=>[e(r,{modelValue:_.value.role,"onUpdate:modelValue":v[11]||(v[11]=B=>_.value.role=B)},{default:a(()=>[(d(!0),A(ae,null,ce(L.value,B=>(d(),x(Q,{key:B.id,label:B.label,value:B.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.username")},{default:a(()=>[e(R,{modelValue:_.value.username,"onUpdate:modelValue":v[12]||(v[12]=B=>_.value.username=B),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.password")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:_.value.password,"onUpdate:modelValue":v[13]||(v[13]=B=>_.value.password=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.confirmpassword")},{default:a(()=>[e(R,{type:"password","show-password":"",modelValue:q.value,"onUpdate:modelValue":v[14]||(v[14]=B=>q.value=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.email")},{default:a(()=>[e(R,{modelValue:_.value.email,"onUpdate:modelValue":v[15]||(v[15]=B=>_.value.email=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.phone")},{default:a(()=>[e(R,{modelValue:_.value.phone,"onUpdate:modelValue":v[16]||(v[16]=B=>_.value.phone=B)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:t(l)("app.webui.status")},{default:a(()=>[e(xe,{modelValue:_.value.status,"onUpdate:modelValue":v[17]||(v[17]=B=>_.value.status=B),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",jl,[e(j,{onClick:v[18]||(v[18]=B=>p.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(j,{type:"primary",onClick:E},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),Dl=Ve(Al,[["__scopeId","data-v-e97b9f4a"]]),Tl={key:0},Pl={class:"el-upload__text"},Fl={class:"el-upload__tip"},Nl={key:1},Zl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Gl={style:{display:"flex","align-items":"center"}},Rl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Xl={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Ql={style:{"margin-top":"10px","padding-inline":"25px"}},Ol=["href"],Yl={key:0,style:{position:"relative"}},Jl={key:0,style:{position:"relative"}},Wl={key:2},Kl={style:{"font-weight":"lighter","font-size":"17px"}},ea={style:{display:"flex","justify-content":"space-around"}},la={style:{display:"flex",width:"80%",gap:"1%"}},aa={class:"status"},ta={key:0},oa={key:1},ua=ve({__name:"Vulnlist",setup(de){const{t:l}=me(),P=w("xray"),L=w("xray"),f=w([]),V=w("--"),h=w({}),p=w({}),_=w([]),k=w(""),U=[le,R],C=w(1),T=w(15),G=w(0),D=w(!0),q=w(!1),N=w(!1),c=w({vuln_name:"",vuln_type_id:1,cvss:.1,vuln_level:"",cve:"",nvd:"",edb:"",cnnvd:"",cnvd:"",affected_product:"",repair_suggestion:"",poc:"",exp:"",poc_type:P.value,exp_type:L.value,is_public:!1,description:"",fofa_query:"",zoom_eye_query:"",quake_query:"",hunter_query:"",google_query:"",shodan_query:"",censys_query:"",greynoise_query:"",attachment_id:"",affected_product_version:""}),H=()=>{if(c.value.cvss=Number(c.value.cvss),c.value.cvss>0&&c.value.cvss<4){c.value.vuln_level="Low",V.value=l("app.webui.low");return}else if(c.value.cvss>=4&&c.value.cvss<7){c.value.vuln_level="Medium",V.value=l("app.webui.medium");return}else if(c.value.cvss>=7&&c.value.cvss<9){c.value.vuln_level="High",V.value=l("app.webui.high");return}else if(c.value.cvss>=9&&c.value.cvss<=10){c.value.vuln_level="Critical",V.value=l("app.webui.critical");return}else Z.error(l("app.webui.cvsserror"))};async function le(){try{const r=await J.get("/api/v1/getvulntypes");f.value=r.data.data}catch{}}const O=r=>{D.value=r.id,r.length>0?D.value=!1:D.value=!0};function W(r,i){return r.is_public&&!i.is_public?-1:!r.is_public&&i.is_public?1:0}function te(r,i){const F=new Date(r.create_time),$=new Date(i.create_time);return F<$?-1:F>$?1:0}const oe=$e(()=>{const i=0+T.value;if(k.value.trim()!="")return h.value.data.filter(F=>F.id.toLowerCase().includes(k.value.toLowerCase())||F.vuln_name.toLowerCase().includes(k.value.toLowerCase()));try{return h.value.data.slice(0,i)}catch{return[]}});function ne(r){T.value=r,C.value=1,R()}async function z(r){C.value=r,await R()}fe(()=>{U.forEach(r=>{r()})});const s=(r,i,F,$)=>{(i.property==="id"||i.property==="vuln_name")&&($.target.style.cursor="pointer",$.target.style.color="#409EFF")},m=(r,i,F,$)=>{(i.property==="id"||i.property==="vuln_name")&&($.target.style.cursor="",$.target.style.color="")},E=()=>{q.value=!1,p.value={}};async function g(r){const i=sessionStorage.getItem("token");try{const F={headers:{Authorization:`Bearer ${i}`}},$=await J.get("/api/v1/getvulndtl?id="+r,F);i&&$.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),p.value=$.data}catch{}}const v=(r,i)=>{(i.no==1||i.no==2)&&(g(r.id),q.value=!0)};async function R(){try{const r=await J.get(`/api/v1/getvulnlist?page=${C.value}&limit=${T.value}`);h.value=r.data,G.value=r.data.total,_.value=r.data.data.reduce((i,F)=>(i.some($=>$.value===F.vuln_type)||i.push({text:F.vuln_type,value:F.vuln_type}),i),[])}catch{}}function j(){we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{Z({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const b=async(r,i)=>{console.log(i.id),await g(i.id),console.log(p.value),c.value=p.value.data,N.value=!0,console.log(c.value)},X=(r,i)=>{we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{Z({type:"success",message:l("app.webui.deletecomplete")}),console.log(r,i)}).catch(()=>{})};function M(){console.log(c.value)}const I=(r,i)=>i.vuln_type===r,ee=(r,i)=>i.level===r,Q=(r,i)=>r==="Poc"?i.poc!="":i.exp!="";return(r,i)=>{const F=he,$=qe,xe=Le,B=Be,pe=De,ue=tl,ye=ol,Me=Ie,S=Ge,be=ge,Xe=Ee,ke=_e,K=je,Y=Te,Ne=Pe,Ze=Fe,re=ze,Qe=Se,Oe=Ue;return N.value?(d(),A("div",Tl,[e(ke,{shadow:"always",header:t(l)("app.webui.editvuln")},{default:a(()=>[u("div",null,[e(Xe,{inline:"true",model:c.value,"label-width":"auto",size:"large"},{default:a(()=>[e($,{label:t(l)("app.webui.vulnname"),prop:"vuln_name",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(F,{modelValue:c.value.vuln_name,"onUpdate:modelValue":i[0]||(i[0]=y=>c.value.vuln_name=y)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e($,{label:t(l)("app.webui.vulntype"),style:{width:"45%"},required:""},{default:a(()=>[e(B,{modelValue:c.value.vuln_type_id,"onUpdate:modelValue":i[1]||(i[1]=y=>c.value.vuln_type_id=y),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(d(!0),A(ae,null,ce(f.value,y=>(d(),x(xe,{key:y.id,label:y.name,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.affectedproduct"),prop:"affected_product",style:{width:"45%"},rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(F,{modelValue:c.value.affected_product,"onUpdate:modelValue":i[2]||(i[2]=y=>c.value.affected_product=y)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e($,{label:t(l)("app.webui.productversion"),style:{width:"45%"},prop:"affected_product_version",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(F,{modelValue:c.value.affected_product_version,"onUpdate:modelValue":i[3]||(i[3]=y=>c.value.affected_product_version=y)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e($,{label:"CVSS",style:{width:"29%"},required:""},{default:a(()=>[e(F,{modelValue:c.value.cvss,"onUpdate:modelValue":i[4]||(i[4]=y=>c.value.cvss=y),type:"number",step:"0.1",onChange:H},null,8,["modelValue"])]),_:1}),e($,{label:t(l)("app.webui.vulnlevel"),style:{width:"29%"},required:""},{default:a(()=>[e(F,{modelValue:V.value,"onUpdate:modelValue":i[5]||(i[5]=y=>V.value=y),readonly:"",disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.ispublic"),style:{width:"29%"}},{default:a(()=>[e(pe,{modelValue:c.value.is_public,"onUpdate:modelValue":i[6]||(i[6]=y=>c.value.is_public=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.cveid"),style:{width:"29%"}},{default:a(()=>[e(F,{modelValue:c.value.cve,"onUpdate:modelValue":i[7]||(i[7]=y=>c.value.cve=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.nvdid"),style:{width:"29%"}},{default:a(()=>[e(F,{modelValue:c.value.nvd,"onUpdate:modelValue":i[8]||(i[8]=y=>c.value.nvd=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.edbid"),style:{width:"29%"}},{default:a(()=>[e(F,{modelValue:c.value.edbid,"onUpdate:modelValue":i[9]||(i[9]=y=>c.value.edbid=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.cnnvdid"),style:{width:"29%"}},{default:a(()=>[e(F,{modelValue:c.value.cnnvd,"onUpdate:modelValue":i[10]||(i[10]=y=>c.value.cnnvd=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.cnvdid"),style:{width:"29%"}},{default:a(()=>[e(F,{modelValue:c.value.cnvd,"onUpdate:modelValue":i[11]||(i[11]=y=>c.value.cnvd=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Fofa ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.fofa_query,"onUpdate:modelValue":i[12]||(i[12]=y=>c.value.fofa_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`ZoomEye ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.zoom_eye_query,"onUpdate:modelValue":i[13]||(i[13]=y=>c.value.zoom_eye_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Quake ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.quake_query,"onUpdate:modelValue":i[14]||(i[14]=y=>c.value.quake_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Hunter ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.hunter_query,"onUpdate:modelValue":i[15]||(i[15]=y=>c.value.hunter_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Google ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.google_query,"onUpdate:modelValue":i[16]||(i[16]=y=>c.value.google_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Shodan ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.shodan_query,"onUpdate:modelValue":i[17]||(i[17]=y=>c.value.shodan_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Censys ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.censys_query,"onUpdate:modelValue":i[18]||(i[18]=y=>c.value.censys_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:`Greynoise ${t(l)("app.webui.searchquery")}`,style:{width:"45%"}},{default:a(()=>[e(F,{modelValue:c.value.greynoise_query,"onUpdate:modelValue":i[19]||(i[19]=y=>c.value.greynoise_query=y)},null,8,["modelValue"])]),_:1},8,["label"]),e($,{label:t(l)("app.webui.vulndesc"),style:{width:"90%"},prop:"description",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(F,{modelValue:c.value.description,"onUpdate:modelValue":i[20]||(i[20]=y=>c.value.description=y),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e($,{label:t(l)("app.webui.vulnsuggest"),style:{width:"90%"},prop:"repair_suggestion",rules:[{required:!0,message:t(l)("app.webui.required")}]},{default:a(()=>[e(F,{modelValue:c.value.repair_suggestion,"onUpdate:modelValue":i[21]||(i[21]=y=>c.value.repair_suggestion=y),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1},8,["label","rules"]),e($,{label:"Poc",style:{width:"90%"},onChange:r.ShowPocInput},{default:a(()=>[e(ye,{modelValue:P.value,"onUpdate:modelValue":i[22]||(i[22]=y=>P.value=y),size:"large"},{default:a(()=>[e(ue,{label:"Xray",value:"xray"}),e(ue,{label:"Nuclei",value:"nuclei"}),e(ue,{label:"Goby",value:"goby"}),e(ue,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(F,{modelValue:c.value.poc,"onUpdate:modelValue":i[23]||(i[23]=y=>c.value.poc=y),type:"textarea",placeholder:r.pocplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e($,{label:"Exp",style:{width:"90%"},onChange:r.ShowExpInput},{default:a(()=>[e(ye,{modelValue:L.value,"onUpdate:modelValue":i[24]||(i[24]=y=>L.value=y),size:"large"},{default:a(()=>[e(ue,{label:"Xray",value:"xray"}),e(ue,{label:"Nuclei",value:"nuclei"}),e(ue,{label:"Goby",value:"goby"}),e(ue,{label:t(l)("app.webui.other"),value:"other"},null,8,["label"])]),_:1},8,["modelValue"]),e(F,{modelValue:c.value.exp,"onUpdate:modelValue":i[25]||(i[25]=y=>c.value.exp=y),type:"textarea",placeholder:r.expplaceholder,autosize:"",style:{"margin-top":"2%"}},null,8,["modelValue","placeholder"])]),_:1},8,["onChange"]),e($,{label:t(l)("app.webui.attachfile"),style:{width:"100%"}},{default:a(()=>[e(S,{class:"upload-demo",drag:"",accept:".zip,.doc,.docx,.pdf,.txt",action:"/api/v1/upload",headers:{Authorization:`Bearer ${r.token}`},"on-success":r.handleSuccess,"on-remove":r.handleRemove,style:{width:"90%"}},{tip:a(()=>[u("div",Fl,o(t(l)("app.webui.uploadnotice1")),1)]),default:a(()=>[e(Me,{class:"el-icon--upload"},{default:a(()=>[e(t(al))]),_:1}),u("div",Pl,[n(o(t(l)("app.webui.draguplaod"))+" ",1),u("em",null,o(t(l)("app.webui.clickupload")),1)])]),_:1},8,["headers","on-success","on-remove"])]),_:1},8,["label"]),e($,{style:{width:"100%"}},{default:a(()=>[e(be,{onClick:i[26]||(i[26]=y=>N.value=!1),size:"default"},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(be,{type:"primary",onClick:M,size:"default"},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["header"])])):q.value?(d(),A("div",Nl,[e(ke,{shadow:"always"},{header:a(()=>[u("div",Zl,[u("span",Gl,[e(Me,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>i[33]||(i[33]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+o(p.value.data.vuln_name),1)]),e(be,{type:"primary",onClick:E},{default:a(()=>[n(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[u("div",null,[e(Ne,{column:5},{default:a(()=>[e(Y,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(K,null,{default:a(()=>[n(o(p.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[n(o(p.value.data.vuln_type),1)]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[p.value.data.vuln_level==="Critical"?(d(),x(K,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):p.value.data.vuln_level==="High"?(d(),x(K,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):p.value.data.vuln_level==="Medium"?(d(),x(K,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(d(),x(K,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[n(o(t(ie)(p.value.data.create_time)),1)]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[n(o(p.value.data.submitter),1)]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(K,null,{default:a(()=>[n(o(p.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(K,null,{default:a(()=>[n(o(p.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(K,null,{default:a(()=>[n(o(p.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(K,null,{default:a(()=>[n(o(p.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(Y,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(K,null,{default:a(()=>[n(o(p.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(Y,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[n(o(p.value.data.affected_product),1)]),_:1},8,["label"]),e(Y,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[n(o(p.value.data.affected_product_version),1)]),_:1},8,["label"]),e(Y,{label:"CVSS:"},{default:a(()=>[n(o(p.value.data.cvss),1)]),_:1}),e(Y,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",Rl,o(p.value.data.description),1)]),_:1},8,["label"]),e(Y,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",Xl,o(p.value.data.repair_suggestion),1)]),_:1},8,["label"]),p.value.data.attachment_id?(d(),x(Y,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",Ql,[u("a",{href:`/download/file?id=${p.value.data.attachment_id}`},o(p.value.data.attachment_name),9,Ol)])]),_:1},8,["label"])):se("",!0)]),_:1})])]),_:1}),e(ke,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(Ne,{column:5},{default:a(()=>[e(Y,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.fofa_query),1)]),_:1},8,["label"]),e(Y,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(Y,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.quake_query),1)]),_:1},8,["label"]),e(Y,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.hunter_query),1)]),_:1},8,["label"]),e(Y,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.google_query),1)]),_:1},8,["label"]),e(Y,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.shodan_query),1)]),_:1},8,["label"]),e(Y,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.censys_query),1)]),_:1},8,["label"]),e(Y,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(p.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(ke,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[p.value.data.poc!=""?(d(),A("div",Yl,[e(be,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:i[27]||(i[27]=y=>r.copyToClipboard(p.value.data.poc))},null,8,["icon"]),e(F,{modelValue:p.value.data.poc,"onUpdate:modelValue":i[28]||(i[28]=y=>p.value.data.poc=y),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),x(Ze,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(ke,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[p.value.data.exp!=""?(d(),A("div",Jl,[e(be,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:i[29]||(i[29]=y=>r.copyToClipboard(p.value.data.exp))},null,8,["icon"]),e(F,{modelValue:p.value.data.exp,"onUpdate:modelValue":i[30]||(i[30]=y=>p.value.data.exp=y),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),x(Ze,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(d(),A("div",Wl,[e(ke,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",Kl,[u("div",ea,[u("div",la,[e(F,{modelValue:k.value,"onUpdate:modelValue":i[31]||(i[31]=y=>k.value=y),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),e(be,{disabled:D.value,type:"danger",onClick:j},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])]),e(Qe,{data:oe.value,onSelectionChange:O,onCellMouseEnter:s,onCellMouseLeave:m,onCellClick:v},{default:a(()=>[e(re,{type:"selection",width:"55"}),e(re,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(re,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(re,{prop:"vuln_type",filters:_.value,"filter-method":I,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(re,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":ee,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:y})=>[y.vuln_level==="Critical"?(d(),x(K,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):y.vuln_level==="High"?(d(),x(K,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):y.vuln_level==="Medium"?(d(),x(K,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(d(),x(K,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(re,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(re,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":Q,label:"Poc&Exp",width:"120"},{default:a(({row:y})=>[u("div",aa,[y.poc!=""&&y.poc!="0"?(d(),x(K,{key:0,type:"success",effect:"dark"},{default:a(()=>i[34]||(i[34]=[n("Poc")])),_:1})):(d(),x(K,{key:1,type:"info",effect:"dark"},{default:a(()=>i[35]||(i[35]=[n("Poc")])),_:1})),y.exp!=""&&y.exp!="0"?(d(),x(K,{key:2,type:"success",effect:"dark"},{default:a(()=>i[36]||(i[36]=[n("Exp")])),_:1})):(d(),x(K,{key:3,type:"info",effect:"dark"},{default:a(()=>i[37]||(i[37]=[n("Exp")])),_:1}))])]),_:1}),e(re,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":W,width:"110"},{default:a(({row:y})=>[y.is_public?(d(),A("span",ta,o(t(l)("app.webui.yes")),1)):(d(),A("span",oa,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(re,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":te},{default:a(({row:y})=>[u("span",null,o(t(ie)(y.create_time)),1)]),_:1},8,["label"]),e(re,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":te},{default:a(({row:y})=>[u("span",null,o(t(ie)(y.update_time)),1)]),_:1},8,["label"]),e(re,{label:t(l)("app.webui.operate"),width:"140"},{default:a(y=>[e(be,{size:"small",type:"primary",onClick:Ye=>b(y.$index,y.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(be,{size:"small",type:"danger",onClick:Ye=>X(y.$index,y.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(Oe,{"page-sizes":[15,25,50,100,200,300],"page-size":T.value,"onUpdate:pageSize":i[32]||(i[32]=y=>T.value=y),layout:"total, sizes, prev, pager, next, jumper",total:G.value,onSizeChange:ne,onCurrentChange:z,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),na=Ve(ua,[["__scopeId","data-v-47f7f80c"]]),ia={key:0},sa={style:{"font-weight":"lighter","font-size":"17px"}},da={style:{display:"flex","justify-content":"space-around"}},pa={style:{display:"flex",width:"80%",gap:"1%"}},ra={class:"status"},ca={key:0},va={key:1},ma={key:1},fa={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ba={style:{display:"flex","align-items":"center"}},_a={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ya={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},wa={style:{"margin-top":"10px","padding-inline":"25px"}},ha=["href"],ga={key:0,style:{position:"relative"}},Va={key:0,style:{position:"relative"}},xa={style:{"margin-top":"1%"}},ka=ve({__name:"Unaudited",setup(de){const{t:l}=me(),P=w(!1),L=sessionStorage.getItem("token"),f=w([]),V=w({}),h=w({}),p=w({id:null,audit:1,review:"",cvss:null,prid:0,erid:0,irid:0,orid:0}),_=w(""),k=[m,E],U=w(1),C=w(15),T=w(0),G=w([]),D=w([]),q=w([]),N=w([]),c=[{id:1,name:l("app.webui.pass")},{id:2,name:l("app.webui.unpassed")}],H={id:0,rule:""};function le(j,b){return j.is_public&&!b.is_public?-1:!j.is_public&&b.is_public?1:0}function O(j,b){const X=new Date(j.create_time),M=new Date(b.create_time);return X<M?-1:X>M?1:0}const W=$e(()=>{const b=0+C.value;if(console.log(V.value),_.value.trim()!="")return V.value.data.filter(X=>X.id.toLowerCase().includes(_.value.toLowerCase())||X.vuln_name.toLowerCase().includes(_.value.toLowerCase()));try{return V.value.data.slice(0,b)}catch{return[]}});function te(j){C.value=j,U.value=1,m()}async function oe(j){U.value=j,await m()}fe(()=>{k.forEach(j=>{j()})});const ne=()=>{P.value=!1,h.value={}},z=async(j,b)=>{console.log(j,b);try{const X={headers:{Authorization:`Bearer ${L}`}},M=await J.get("/api/v1/getvulndtl?id="+b.id,X);L&&M.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),h.value=M.data,p.value.id=b.id,p.value.cvss=M.data.data.cvss,P.value=!0}catch{}};async function s(){try{const j={headers:{Authorization:`Bearer ${L}`}};(await J.post("/api/v1/auditvuln",p.value,j)).data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):(Z.success(l("app.webui.audited")),h.value={},P.value=!1,m())}catch{}}async function m(){try{const j={headers:{Authorization:`Bearer ${L}`}},b=await J.get(`/api/v1/getunauditlist?page=${U.value}&limit=${C.value}`,j);V.value=b.data,T.value=b.data.total,f.value=b.data.data.reduce((X,M)=>(X.some(I=>I.value===M.vuln_type)||X.push({text:M.vuln_type,value:M.vuln_type}),X),[])}catch{}}async function E(){try{const j={headers:{Authorization:`Bearer ${L}`}},b=await J.get("/api/v1/getscorerules",j);b.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),G.value=b.data.data.pocrules,D.value=b.data.data.exprules,q.value=b.data.data.incidencerules,N.value=b.data.data.otherrules,G.value.push(H),D.value.push(H),q.value.push(H),N.value.push(H)}catch{}}const g=(j,b)=>b.vuln_type===j,v=(j,b)=>b.level===j,R=(j,b)=>j==="Poc"?b.poc!="":b.exp!="";return(j,b)=>{const X=he,M=ze,I=je,ee=ge,Q=Se,r=Ue,i=_e,F=Ie,$=Te,xe=Pe,B=Fe,pe=qe,ue=Le,ye=Be,Me=Ee;return P.value?(d(),A("div",ma,[e(i,{shadow:"always"},{header:a(()=>[u("div",fa,[u("span",ba,[e(F,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>b[18]||(b[18]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+o(h.value.data.vuln_name),1)])])]),default:a(()=>[u("div",null,[e(xe,{column:5},{default:a(()=>[e($,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(I,null,{default:a(()=>[n(o(h.value.data.id),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[n(o(h.value.data.vuln_type),1)]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[h.value.data.vuln_level==="Critical"?(d(),x(I,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):h.value.data.vuln_level==="High"?(d(),x(I,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):h.value.data.vuln_level==="Medium"?(d(),x(I,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(d(),x(I,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[n(o(t(ie)(h.value.data.create_time)),1)]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[n(o(h.value.data.submitter),1)]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(I,null,{default:a(()=>[n(o(h.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(I,null,{default:a(()=>[n(o(h.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(I,null,{default:a(()=>[n(o(h.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(I,null,{default:a(()=>[n(o(h.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e($,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(I,null,{default:a(()=>[n(o(h.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e($,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[n(o(h.value.data.affected_product),1)]),_:1},8,["label"]),e($,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[n(o(h.value.data.affected_product_version),1)]),_:1},8,["label"]),e($,{label:"CVSS:"},{default:a(()=>[n(o(h.value.data.cvss),1)]),_:1}),e($,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",_a,o(h.value.data.description),1)]),_:1},8,["label"]),e($,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",ya,o(h.value.data.repair_suggestion),1)]),_:1},8,["label"]),h.value.data.attachment_id?(d(),x($,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",wa,[u("a",{href:`/download/file?id=${h.value.data.attachment_id}`},o(h.value.data.attachment_name),9,ha)])]),_:1},8,["label"])):se("",!0)]),_:1})])]),_:1}),e(i,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(xe,{column:5},{default:a(()=>[e($,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.fofa_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e($,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.quake_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.hunter_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.google_query),1)]),_:1},8,["label"]),e($,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.shodan_query),1)]),_:1},8,["label"]),e($,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.censys_query),1)]),_:1},8,["label"]),e($,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(h.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),h.value.data.poc!=""?(d(),x(i,{key:0,style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[h.value.data.poc!=""?(d(),A("div",ga,[e(ee,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:b[2]||(b[2]=S=>j.copyToClipboard(h.value.data.poc))},null,8,["icon"]),e(X,{modelValue:h.value.data.poc,"onUpdate:modelValue":b[3]||(b[3]=S=>h.value.data.poc=S),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),x(B,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})):se("",!0),h.value.data.exp!=""?(d(),x(i,{key:1,style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[h.value.data.exp!=""?(d(),A("div",Va,[e(ee,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:b[4]||(b[4]=S=>j.copyToClipboard(h.value.data.exp))},null,8,["icon"]),e(X,{modelValue:h.value.data.exp,"onUpdate:modelValue":b[5]||(b[5]=S=>h.value.data.exp=S),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),x(B,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})):se("",!0),e(i,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.audit")},{default:a(()=>[e(Me,{model:p.value},{default:a(()=>[e(pe,{label:"CVSS:"},{default:a(()=>[e(X,{type:"numper",modelValue:p.value.cvss,"onUpdate:modelValue":b[6]||(b[6]=S=>p.value.cvss=S)},null,8,["modelValue"])]),_:1}),e(pe,{label:`${t(l)("app.webui.audit")}:`},{default:a(()=>[e(ye,{modelValue:p.value.audit,"onUpdate:modelValue":b[7]||(b[7]=S=>p.value.audit=S),placeholder:t(l)("app.webui.observability")},{default:a(()=>[(d(),A(ae,null,ce(c,S=>e(ue,{key:S.id,label:S.name,value:S.id},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),p.value.audit==2?(d(),x(pe,{key:0,label:t(l)("app.webui.reviewcomments")},{default:a(()=>[e(X,{type:"textarea",modelValue:p.value.review,"onUpdate:modelValue":b[8]||(b[8]=S=>p.value.review=S)},null,8,["modelValue"])]),_:1},8,["label"])):se("",!0),p.value.audit==1?(d(),x(pe,{key:1,label:`${t(l)("app.webui.pocscorerule")}:`},{default:a(()=>[e(ye,{modelValue:p.value.prid,"onUpdate:modelValue":b[9]||(b[9]=S=>p.value.prid=S),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(d(!0),A(ae,null,ce(G.value,S=>(d(),x(ue,{key:S.id,label:S.rule,value:S.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):se("",!0),p.value.audit==1?(d(),x(pe,{key:2,label:`${t(l)("app.webui.exprule")}:`},{default:a(()=>[e(ye,{modelValue:p.value.erid,"onUpdate:modelValue":b[10]||(b[10]=S=>p.value.erid=S),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(d(!0),A(ae,null,ce(D.value,S=>(d(),x(ue,{key:S.id,label:S.rule,value:S.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):se("",!0),p.value.audit==1?(d(),x(pe,{key:3,label:`${t(l)("app.webui.incidencerule")}:`},{default:a(()=>[e(ye,{modelValue:p.value.irid,"onUpdate:modelValue":b[11]||(b[11]=S=>p.value.irid=S),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(d(!0),A(ae,null,ce(q.value,S=>(d(),x(ue,{key:S.id,label:S.rule,value:S.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):se("",!0),p.value.audit==1?(d(),x(pe,{key:4,label:`${t(l)("app.webui.otherrule")}:`},{default:a(()=>[e(ye,{modelValue:p.value.orid,"onUpdate:modelValue":b[12]||(b[12]=S=>p.value.orid=S),placeholder:t(l)("app.webui.priority")},{default:a(()=>[(d(!0),A(ae,null,ce(N.value,S=>(d(),x(ue,{key:S.id,label:S.rule,value:S.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):se("",!0)]),_:1},8,["model"])]),_:1},8,["header"]),u("div",xa,[e(ee,{onClick:ne},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(ee,{type:"primary",onClick:s},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])])):(d(),A("div",ia,[e(i,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",sa,[u("div",da,[u("div",pa,[e(X,{modelValue:_.value,"onUpdate:modelValue":b[0]||(b[0]=S=>_.value=S),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),b[13]||(b[13]=u("span",null,null,-1))]),e(Q,{data:W.value},{default:a(()=>[e(M,{type:"selection",width:"55"}),e(M,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(M,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(M,{prop:"vuln_type",filters:f.value,"filter-method":g,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(M,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":v,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:S})=>[S.vuln_level==="Critical"?(d(),x(I,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):S.vuln_level==="High"?(d(),x(I,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):S.vuln_level==="Medium"?(d(),x(I,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(d(),x(I,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(M,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(M,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":R,label:t(l)("app.webui.status"),width:"120"},{default:a(({row:S})=>[u("div",ra,[S.poc!=""&&S.poc!="0"?(d(),x(I,{key:0,type:"success",effect:"dark"},{default:a(()=>b[14]||(b[14]=[n("Poc")])),_:1})):(d(),x(I,{key:1,type:"info",effect:"dark"},{default:a(()=>b[15]||(b[15]=[n("Poc")])),_:1})),S.exp!=""&&S.exp!="0"?(d(),x(I,{key:2,type:"success",effect:"dark"},{default:a(()=>b[16]||(b[16]=[n("Exp")])),_:1})):(d(),x(I,{key:3,type:"info",effect:"dark"},{default:a(()=>b[17]||(b[17]=[n("Exp")])),_:1}))])]),_:1},8,["label"]),e(M,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":le,width:"110"},{default:a(({row:S})=>[S.is_public?(d(),A("span",ca,o(t(l)("app.webui.yes")),1)):(d(),A("span",va,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(M,{label:t(l)("app.webui.createtime"),width:"135",sortable:"","sort-method":O},{default:a(({row:S})=>[u("span",null,o(t(ie)(S.create_time)),1)]),_:1},8,["label"]),e(M,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":O},{default:a(({row:S})=>[u("span",null,o(t(ie)(S.update_time)),1)]),_:1},8,["label"]),e(M,{label:t(l)("app.webui.operate"),width:"140"},{default:a(S=>[e(ee,{size:"small",type:"primary",onClick:be=>z(S.$index,S.row)},{default:a(()=>[n(o(t(l)("app.webui.audit")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(r,{"page-sizes":[15,25,50,100,200,300],"page-size":C.value,"onUpdate:pageSize":b[1]||(b[1]=S=>C.value=S),layout:"total, sizes, prev, pager, next, jumper",total:T.value,onSizeChange:te,onCurrentChange:oe,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Ca=Ve(ka,[["__scopeId","data-v-880d5968"]]),$a={key:0},za={style:{"font-weight":"lighter","font-size":"17px"}},Sa={style:{display:"flex","justify-content":"space-around"}},Ua={style:{display:"flex",width:"80%",gap:"1%"}},qa={class:"status"},Ea={key:0},Ia={key:1},Ba={key:1},La={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ma={style:{display:"flex","align-items":"center"}},Ha={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ja={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Aa={style:{"margin-top":"10px","padding-inline":"25px"}},Da=["href"],Ta={key:0,style:{position:"relative"}},Pa={key:0,style:{position:"relative"}},Fa=ve({__name:"Audited",setup(de){const{t:l}=me(),P=w(!1),L=sessionStorage.getItem("token"),f=w({}),V=w({}),h=w(""),p=w([]),_=[W],k=w(1),U=w(15),C=w(0);function T(z,s){return z.is_public&&!s.is_public?-1:!z.is_public&&s.is_public?1:0}function G(z,s){const m=new Date(z.create_time),E=new Date(s.create_time);return m<E?-1:m>E?1:0}const D=$e(()=>{const s=0+U.value;if(console.log(f.value),h.value.trim()!="")return f.value.data.filter(m=>m.id.toLowerCase().includes(h.value.toLowerCase())||m.vuln_name.toLowerCase().includes(h.value.toLowerCase()));try{return f.value.data.slice(0,s)}catch{return[]}});function q(z){U.value=z,k.value=1,W()}async function N(z){k.value=z,await W()}const c=(z,s,m,E)=>{(s.property==="id"||s.property==="vuln_name")&&(E.target.style.cursor="pointer",E.target.style.color="#409EFF")},H=(z,s,m,E)=>{(s.property==="id"||s.property==="vuln_name")&&(E.target.style.cursor="",E.target.style.color="")},le=()=>{P.value=!1,V.value={}},O=async(z,s)=>{if(s.no==0||s.no==1)try{const m={headers:{Authorization:`Bearer ${L}`}},E=await J.get("/api/v1/getvulndtl?id="+z.id,m);L&&E.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),V.value=E.data,P.value=!0}catch{}};fe(()=>{_.forEach(z=>{z()})});async function W(){try{const z={headers:{Authorization:`Bearer ${L}`}},s=await J.get(`/api/v1/getauditedlist?page=${k.value}&limit=${U.value}`,z);f.value=s.data,C.value=s.data.total,p.value=s.data.data.reduce((m,E)=>(m.some(g=>g.value===E.vuln_type)||m.push({text:E.vuln_type,value:E.vuln_type}),m),[])}catch{}}const te=(z,s)=>s.vuln_type===z,oe=(z,s)=>s.level===z,ne=(z,s)=>z==="Poc"?s.poc!="":s.exp!="";return(z,s)=>{const m=he,E=ze,g=je,v=Se,R=Ue,j=_e,b=Ie,X=ge,M=Te,I=Pe,ee=Fe;return P.value?(d(),A("div",Ba,[e(j,{shadow:"always"},{header:a(()=>[u("div",La,[u("span",Ma,[e(b,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>s[11]||(s[11]=[u("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+o(V.value.data.vuln_name),1)]),e(X,{type:"primary",onClick:le},{default:a(()=>[n(o(t(l)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[u("div",null,[e(I,{column:5},{default:a(()=>[e(M,{label:`${t(l)("app.webui.id")}:`},{default:a(()=>[e(g,null,{default:a(()=>[n(o(V.value.data.id),1)]),_:1})]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.type")}:`},{default:a(()=>[n(o(V.value.data.vuln_type),1)]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.level")}:`},{default:a(()=>[V.value.data.vuln_level==="Critical"?(d(),x(g,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):V.value.data.vuln_level==="High"?(d(),x(g,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):V.value.data.vuln_level==="Medium"?(d(),x(g,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(d(),x(g,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.createtime")}:`},{default:a(()=>[n(o(t(ie)(V.value.data.create_time)),1)]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.submitter")}:`},{default:a(()=>[n(o(V.value.data.submitter),1)]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.cveid")}:`},{default:a(()=>[e(g,null,{default:a(()=>[n(o(V.value.data.cve),1)]),_:1})]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.nvdid")}:`},{default:a(()=>[e(g,null,{default:a(()=>[n(o(V.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.edbid")}:`},{default:a(()=>[e(g,null,{default:a(()=>[n(o(V.value.data.edb),1)]),_:1})]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.cnnvdid")}:`},{default:a(()=>[e(g,null,{default:a(()=>[n(o(V.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),e(M,{label:`${t(l)("app.webui.cnvdid")}:`},{default:a(()=>[e(g,null,{default:a(()=>[n(o(V.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),e(M,{span:"2",label:`${t(l)("app.webui.affectedproduct")}:`},{default:a(()=>[n(o(V.value.data.affected_product),1)]),_:1},8,["label"]),e(M,{span:"2",label:`${t(l)("app.webui.productversion")}:`},{default:a(()=>[n(o(V.value.data.affected_product_version),1)]),_:1},8,["label"]),e(M,{label:"CVSS:"},{default:a(()=>[n(o(V.value.data.cvss),1)]),_:1}),e(M,{span:"5",label:`${t(l)("app.webui.vulndesc")}:`},{default:a(()=>[u("div",Ha,o(V.value.data.description),1)]),_:1},8,["label"]),e(M,{span:"5",label:`${t(l)("app.webui.vulnsuggest")}:`},{default:a(()=>[u("div",ja,o(V.value.data.repair_suggestion),1)]),_:1},8,["label"]),V.value.data.attachment_id?(d(),x(M,{key:0,span:"5",label:`${t(l)("app.webui.attachfile")}:`},{default:a(()=>[u("div",Aa,[u("a",{href:`/download/file?id=${V.value.data.attachment_id}`},o(V.value.data.attachment_name),9,Da)])]),_:1},8,["label"])):se("",!0)]),_:1})])]),_:1}),e(j,{style:{"margin-top":"20px"},shadow:"always",header:t(l)("app.webui.searchquery")},{default:a(()=>[u("div",null,[e(I,{column:5},{default:a(()=>[e(M,{span:"2",label:`Fofa ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.fofa_query),1)]),_:1},8,["label"]),e(M,{span:"2",label:`ZoomEye ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.zoom_eye_query),1)]),_:1},8,["label"]),e(M,{label:`Quake ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.quake_query),1)]),_:1},8,["label"]),e(M,{span:"2",label:`Hunter ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.hunter_query),1)]),_:1},8,["label"]),e(M,{span:"2",label:`Google ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.google_query),1)]),_:1},8,["label"]),e(M,{label:`Shodan ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.shodan_query),1)]),_:1},8,["label"]),e(M,{span:"2",label:`Censys ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.censys_query),1)]),_:1},8,["label"]),e(M,{label:`Greynoise ${t(l)("app.webui.searchquery")}:`},{default:a(()=>[n(o(V.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),e(j,{style:{"margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[V.value.data.poc!=""?(d(),A("div",Ta,[e(X,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:s[2]||(s[2]=Q=>z.copyToClipboard(V.value.data.poc))},null,8,["icon"]),e(m,{modelValue:V.value.data.poc,"onUpdate:modelValue":s[3]||(s[3]=Q=>V.value.data.poc=Q),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),x(ee,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1}),e(j,{style:{"margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[V.value.data.exp!=""?(d(),A("div",Pa,[e(X,{type:"primary",icon:t(Ce),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:s[4]||(s[4]=Q=>z.copyToClipboard(V.value.data.exp))},null,8,["icon"]),e(m,{modelValue:V.value.data.exp,"onUpdate:modelValue":s[5]||(s[5]=Q=>V.value.data.exp=Q),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),x(ee,{key:1,style:{height:"30vh"},description:t(l)("app.webui.empty")},null,8,["description"]))]),_:1})])):(d(),A("div",$a,[e(j,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",za,[u("div",Sa,[u("div",Ua,[e(m,{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=Q=>h.value=Q),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),s[6]||(s[6]=u("span",null,null,-1))]),e(v,{data:D.value,onSelectionChange:z.handleSelectionChange,onCellMouseEnter:c,onCellMouseLeave:H,onCellClick:O},{default:a(()=>[e(E,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"180"},null,8,["label"]),e(E,{prop:"vuln_name",label:t(l)("app.webui.name")},null,8,["label"]),e(E,{prop:"vuln_type",filters:p.value,"filter-method":te,label:t(l)("app.webui.type"),width:"180"},null,8,["filters","label"]),e(E,{prop:"vuln_level",filters:[{text:t(l)("app.webui.critical"),value:"Critical"},{text:t(l)("app.webui.high"),value:"High"},{text:t(l)("app.webui.medium"),value:"Medium"},{text:t(l)("app.webui.low"),value:"Low"}],"filter-method":oe,label:t(l)("app.webui.level"),width:"85"},{default:a(({row:Q})=>[Q.vuln_level==="Critical"?(d(),x(g,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(o(t(l)("app.webui.critical")),1)]),_:1})):Q.vuln_level==="High"?(d(),x(g,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(o(t(l)("app.webui.high")),1)]),_:1})):Q.vuln_level==="Medium"?(d(),x(g,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(o(t(l)("app.webui.medium")),1)]),_:1})):(d(),x(g,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(o(t(l)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),e(E,{prop:"cvss",label:"CVSS",sortable:"",width:"85"}),e(E,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":ne,label:"Poc&Exp",width:"120"},{default:a(({row:Q})=>[u("div",qa,[Q.poc!=""&&Q.poc!="0"?(d(),x(g,{key:0,type:"success",effect:"dark"},{default:a(()=>s[7]||(s[7]=[n("Poc")])),_:1})):(d(),x(g,{key:1,type:"info",effect:"dark"},{default:a(()=>s[8]||(s[8]=[n("Poc")])),_:1})),Q.exp!=""&&Q.exp!="0"?(d(),x(g,{key:2,type:"success",effect:"dark"},{default:a(()=>s[9]||(s[9]=[n("Exp")])),_:1})):(d(),x(g,{key:3,type:"info",effect:"dark"},{default:a(()=>s[10]||(s[10]=[n("Exp")])),_:1}))])]),_:1}),e(E,{label:t(l)("app.webui.ispublic"),sortable:"","sort-method":T,width:"110"},{default:a(({row:Q})=>[Q.is_public?(d(),A("span",Ea,o(t(l)("app.webui.yes")),1)):(d(),A("span",Ia,o(t(l)("app.webui.no")),1))]),_:1},8,["label"]),e(E,{label:t(l)("app.webui.status"),sortable:"","sort-method":T,width:"110"},{default:a(({row:Q})=>[Q.status==1?(d(),x(g,{key:0,type:"success"},{default:a(()=>[n(o(t(l)("app.webui.passed")),1)]),_:1})):(d(),x(g,{key:1,type:"danger"},{default:a(()=>[n(o(t(l)("app.webui.unpassed")),1)]),_:1}))]),_:1},8,["label"]),e(E,{prop:"review_comments",label:t(l)("app.webui.reviewcomments")},null,8,["label"]),e(E,{label:t(l)("app.webui.updatetime"),width:"135",sortable:"","sort-method":G},{default:a(({row:Q})=>[u("span",null,o(t(ie)(Q.update_time)),1)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])]),e(R,{"page-sizes":[15,25,50,100,200,300],"page-size":U.value,"onUpdate:pageSize":s[1]||(s[1]=Q=>U.value=Q),layout:"total, sizes, prev, pager, next, jumper",total:C.value,onSizeChange:q,onCurrentChange:N,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]))}}}),Na=Ve(Fa,[["__scopeId","data-v-1a7b571d"]]),Za={style:{"margin-top":"1%"}},Ga=ve({__name:"System",setup(de){const{t:l}=me(),P=w(!0),L=sessionStorage.getItem("token"),f=w({emailconf:{email_host:"",email_port:0,email_user:"",email_password:"",email_sender:""},jwtconf:{jwt_secret:"",jwt_expires:0},noticeconf:{type:0,secret:"",webhook:""},sysconf:{user_register:!1,user_display:"",max_attempts:0,lockout_duration:0}}),V=w([{key:0,value:l("el.select.placeholder")},{key:1,value:l("app.webui.dingtalk")},{key:2,value:l("app.webui.wxwork")}]);fe(h);async function h(){try{const _={headers:{Authorization:`Bearer ${L}`}},k=await J.get("/api/v1/getsysconfig",_);k.data.code==1?f.value=k.data.data:(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"))}catch{}}async function p(){console.log(f.value);try{const _={headers:{Authorization:`Bearer ${L}`}};f.value.emailconf.email_port=Number(f.value.emailconf.email_port),f.value.jwtconf.jwt_expires=Number(f.value.jwtconf.jwt_expires),f.value.noticeconf.type=Number(f.value.noticeconf.type),f.value.sysconf.max_attempts=Number(f.value.sysconf.max_attempts),f.value.sysconf.lockout_duration=Number(f.value.sysconf.lockout_duration),(await J.post("/api/v1/updatesysconfig",f.value,_)).data.code==1?(h(),Z({type:"success",message:l("app.webui.savesuccess")}),P.value=!0):Z({type:"error",message:l("app.webui.savefail")})}catch{}}return(_,k)=>{const U=De,C=qe,T=he,G=Ee,D=_e,q=Le,N=Be,c=ge;return d(),A(ae,null,[e(D,{header:t(l)("app.webui.regandlogincnfg")},{default:a(()=>[e(G,{disabled:P.value,modelValue:f.value.sysconf,"onUpdate:modelValue":k[9]||(k[9]=H=>f.value.sysconf=H),"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(C,{label:t(l)("app.webui.userregister")},{default:a(()=>[e(U,{modelValue:f.value.sysconf.user_register,"onUpdate:modelValue":k[0]||(k[0]=H=>f.value.sysconf.user_register=H),style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.userdisplay")},{default:a(()=>[e(T,{modelValue:f.value.sysconf.user_display,"onUpdate:modelValue":k[1]||(k[1]=H=>f.value.sysconf.user_display=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.maxattempts"),required:""},{default:a(()=>[e(T,{type:"number",modelValue:f.value.sysconf.max_attempts,"onUpdate:modelValue":k[2]||(k[2]=H=>f.value.sysconf.max_attempts=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.lockoutduration"),required:""},{default:a(()=>[e(T,{type:"number",modelValue:f.value.sysconf.lockout_duration,"onUpdate:modelValue":k[3]||(k[3]=H=>f.value.sysconf.lockout_duration=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailserver")},{default:a(()=>[e(T,{modelValue:f.value.emailconf.email_host,"onUpdate:modelValue":k[4]||(k[4]=H=>f.value.emailconf.email_host=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailport")},{default:a(()=>[e(T,{type:"number",modelValue:f.value.emailconf.email_port,"onUpdate:modelValue":k[5]||(k[5]=H=>f.value.emailconf.email_port=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailuser")},{default:a(()=>[e(T,{modelValue:f.value.emailconf.email_user,"onUpdate:modelValue":k[6]||(k[6]=H=>f.value.emailconf.email_user=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailpasswd")},{default:a(()=>[e(T,{type:"password","show-password":"",modelValue:f.value.emailconf.email_password,"onUpdate:modelValue":k[7]||(k[7]=H=>f.value.emailconf.email_password=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.emailsender")},{default:a(()=>[e(T,{modelValue:f.value.emailconf.email_sender,"onUpdate:modelValue":k[8]||(k[8]=H=>f.value.emailconf.email_sender=H)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])]),_:1},8,["header"]),e(D,{header:t(l)("app.webui.jwtconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(G,{disabled:P.value,model:f.value.jwtconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(C,{label:t(l)("app.webui.jwtkey"),required:""},{default:a(()=>[e(T,{modelValue:f.value.jwtconf.jwt_secret,"onUpdate:modelValue":k[10]||(k[10]=H=>f.value.jwtconf.jwt_secret=H)},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{label:t(l)("app.webui.jwtvalidity"),required:""},{default:a(()=>[e(T,{type:"number",modelValue:f.value.jwtconf.jwt_expires,"onUpdate:modelValue":k[11]||(k[11]=H=>f.value.jwtconf.jwt_expires=H)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["disabled","model"])]),_:1},8,["header"]),e(D,{header:t(l)("app.webui.noticeconfig"),style:{"margin-top":"2%"}},{default:a(()=>[e(G,{disabled:P.value,model:f.value.noticeconf,"label-width":"auto",style:{"margin-left":"2%","max-width":"900px"}},{default:a(()=>[e(C,{label:t(l)("app.webui.noticetype")},{default:a(()=>[e(N,{modelValue:f.value.noticeconf.type,"onUpdate:modelValue":k[12]||(k[12]=H=>f.value.noticeconf.type=H)},{default:a(()=>[(d(!0),A(ae,null,ce(V.value,H=>(d(),x(q,{key:H.key,label:H.value,value:H.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(C,{label:"Webhook"},{default:a(()=>[e(T,{modelValue:f.value.noticeconf.webhook,"onUpdate:modelValue":k[13]||(k[13]=H=>f.value.noticeconf.webhook=H)},null,8,["modelValue"])]),_:1}),f.value.noticeconf.type==1?(d(),x(C,{key:0,label:"Secret"},{default:a(()=>[e(T,{type:"password","show-password":"",modelValue:f.value.noticeconf.secret,"onUpdate:modelValue":k[14]||(k[14]=H=>f.value.noticeconf.secret=H)},null,8,["modelValue"])]),_:1})):se("",!0)]),_:1},8,["disabled","model"])]),_:1},8,["header"]),u("div",Za,[P.value?(d(),x(c,{key:0,type:"primary",onClick:k[15]||(k[15]=H=>P.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:1})):(d(),x(c,{key:1,type:"primary",onClick:p},{default:a(()=>[n(o(t(l)("app.webui.save")),1)]),_:1}))])],64)}}}),Ra={style:{"font-weight":"lighter","font-size":"17px"}},Xa={style:{display:"flex","justify-content":"space-around"}},Qa={style:{display:"flex",width:"80%",gap:"1%"}},Oa={key:0},Ya={key:1},Ja={key:2},Wa={key:3},Ka={slot:"footer",class:"dialog-footer"},et={slot:"footer",class:"dialog-footer"},lt=ve({__name:"ScoreRule",setup(de){const{t:l}=me(),P=w({data:[{id:1,type:1,rule:"XrayNucleiGobyPoc",score:20,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:2,type:1,rule:"XrayNucleiGobyPoc",score:10,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:3,type:1,rule:"PayloadPoc",score:5,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:4,type:2,rule:"XrayNucleiGobyExp",score:30,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:5,type:2,rule:"XrayNucleiGobyExp",score:15,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:6,type:2,rule:"XrayNucleiGobyExp",score:5,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"},{id:7,type:3,rule:" 5000",score:30,coefficient:1,create_time:"2024-10-23T16:20:32.31+08:00",update_time:"0001-01-01T00:00:00Z"}]});w({});const L=w(""),f=[],V=w(1),h=w(15),p=w(0),_=w(!1),k=w(!1),U=w({}),C=w([{id:1,type:l("app.webui.pocscorerule")},{id:2,type:l("app.webui.exprule")},{id:3,type:l("app.webui.incidencerule")},{id:4,type:l("app.webui.otherrule")}]),T=w(!0),G=s=>{T.value=s.id,s.length>0?T.value=!1:T.value=!0},D=(s,m)=>{U.value.id=m.id,U.value.type=m.type,U.value.rule=m.rule,U.value.score=m.score,U.value.coefficient=m.coefficient,k.value=!0};function q(s,m){const E=new Date(s.create_time),g=new Date(m.create_time);return E<g?-1:E>g?1:0}const N=$e(()=>{const m=0+h.value;if(console.log(P.value),L.value.trim()!="")return P.value.data.filter(E=>E.name.toLowerCase().includes(L.value.toLowerCase()));try{return P.value.data.slice(0,m)}catch{return[]}});function c(s){h.value=s,V.value=1,le()}async function H(s){V.value=s,await le()}fe(()=>{f.forEach(s=>{s()})});async function le(){try{const s=await J.get(`/api/v1/getvulnlist?page=${V.value}&limit=${h.value}`);P.value=s.data,p.value=s.data.total,typefilter.value=s.data.data.reduce((m,E)=>(m.some(g=>g.value===E.vuln_type)||m.push({text:E.vuln_type,value:E.vuln_type}),m),[])}catch{}}function O(){we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{Z({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const W=(s,m)=>{we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{Z({type:"success",message:l("app.webui.deletecomplete")}),console.log(s,m)}).catch(()=>{})},te=(s,m)=>m.type===s,oe=()=>{U.value={id:null,type:1,rule:"",score:null,coefficient:1}},ne=()=>{console.log(U.value),_.value=!1},z=()=>{console.log(U.value),k.value=!1};return(s,m)=>{const E=he,g=ge,v=ze,R=Se,j=Ue,b=_e,X=Le,M=Be,I=qe,ee=Ee,Q=Ae;return d(),A(ae,null,[u("div",null,[e(b,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",Ra,[u("div",Xa,[u("div",Qa,[e(E,{modelValue:L.value,"onUpdate:modelValue":m[0]||(m[0]=r=>L.value=r),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(g,{type:"primary",onClick:m[1]||(m[1]=r=>_.value=!0)},{default:a(()=>[n(o(t(l)("app.webui.add")),1)]),_:1}),e(g,{disabled:T.value,type:"danger",onClick:O},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(R,{data:N.value,onSelectionChange:G},{default:a(()=>[e(v,{type:"selection",width:"55"}),e(v,{prop:"id",label:t(l)("app.webui.id"),sortable:"",width:"80"},null,8,["label"]),e(v,{label:t(l)("app.webui.type"),filters:[{text:t(l)("app.webui.pocscorerule"),value:1},{text:t(l)("app.webui.exprule"),value:2},{text:t(l)("app.webui.incidencerule"),value:3},{text:t(l)("app.webui.otherrule"),value:4}],"filter-method":te,width:"140"},{default:a(({row:r})=>[r.type==1?(d(),A("span",Oa,o(t(l)("app.webui.pocscorerule")),1)):r.type==2?(d(),A("span",Ya,o(t(l)("app.webui.exprule")),1)):r.type==3?(d(),A("span",Ja,o(t(l)("app.webui.incidencerule")),1)):(d(),A("span",Wa,o(t(l)("app.webui.otherrule")),1))]),_:1},8,["label","filters"]),e(v,{prop:"rule",label:t(l)("app.webui.scorerule")},null,8,["label"]),e(v,{prop:"score",label:t(l)("app.webui.score"),width:"120"},null,8,["label"]),e(v,{prop:"coefficient",label:t(l)("app.webui.coefficient"),width:"120"},null,8,["label"]),e(v,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":q,width:"140"},{default:a(({row:r})=>[u("span",null,o(t(ie)(r.create_time)),1)]),_:1},8,["label"]),e(v,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":q,width:"140"},{default:a(({row:r})=>[u("span",null,o(t(ie)(r.update_time)),1)]),_:1},8,["label"]),e(v,{label:t(l)("app.webui.operate"),width:"140"},{default:a(r=>[e(g,{size:"small",type:"primary",onClick:i=>D(r.$index,r.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(g,{size:"small",type:"danger",onClick:i=>W(r.$index,r.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(j,{"page-sizes":[15,25,50,100,200,300],"page-size":h.value,"onUpdate:pageSize":m[2]||(m[2]=r=>h.value=r),layout:"total, sizes, prev, pager, next, jumper",total:p.value,onSizeChange:c,onCurrentChange:H,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(Q,{title:t(l)("app.webui.addscore"),modelValue:_.value,"onUpdate:modelValue":m[8]||(m[8]=r=>_.value=r),width:"30%",onClose:oe},{default:a(()=>[e(ee,{model:U.value,"label-width":"100px"},{default:a(()=>[e(I,{label:t(l)("app.webui.type")},{default:a(()=>[e(M,{modelValue:U.value.type,"onUpdate:modelValue":m[3]||(m[3]=r=>U.value.type=r),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(d(!0),A(ae,null,ce(C.value,r=>(d(),x(X,{key:r.id,label:r.type,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(I,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(E,{modelValue:U.value.rule,"onUpdate:modelValue":m[4]||(m[4]=r=>U.value.rule=r),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(I,{label:t(l)("app.webui.score")},{default:a(()=>[e(E,{modelValue:U.value.score,"onUpdate:modelValue":m[5]||(m[5]=r=>U.value.score=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(I,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(E,{modelValue:U.value.coefficient,"onUpdate:modelValue":m[6]||(m[6]=r=>U.value.coefficient=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",Ka,[e(g,{onClick:m[7]||(m[7]=r=>_.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(g,{type:"primary",onClick:ne},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(Q,{title:t(l)("app.webui.editscore"),modelValue:k.value,"onUpdate:modelValue":m[14]||(m[14]=r=>k.value=r),width:"30%",onClose:oe},{default:a(()=>[e(ee,{model:U.value,"label-width":"100px"},{default:a(()=>[e(I,{label:t(l)("app.webui.type")},{default:a(()=>[e(M,{modelValue:U.value.type,"onUpdate:modelValue":m[9]||(m[9]=r=>U.value.type=r),placeholder:t(l)("el.select.placeholder")},{default:a(()=>[(d(!0),A(ae,null,ce(C.value,r=>(d(),x(X,{key:r.id,label:r.type,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(I,{label:t(l)("app.webui.scorerule")},{default:a(()=>[e(E,{modelValue:U.value.rule,"onUpdate:modelValue":m[10]||(m[10]=r=>U.value.rule=r),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(I,{label:t(l)("app.webui.score")},{default:a(()=>[e(E,{modelValue:U.value.score,"onUpdate:modelValue":m[11]||(m[11]=r=>U.value.score=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),e(I,{label:t(l)("app.webui.coefficient")},{default:a(()=>[e(E,{modelValue:U.value.coefficient,"onUpdate:modelValue":m[12]||(m[12]=r=>U.value.coefficient=r),type:"number",step:"0.1",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",et,[e(g,{onClick:m[13]||(m[13]=r=>k.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(g,{type:"primary",onClick:z},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),at=Ve(lt,[["__scopeId","data-v-8d0af99d"]]),tt={style:{"font-weight":"lighter","font-size":"17px"}},ot={style:{display:"flex","justify-content":"space-around"}},ut={style:{display:"flex",width:"80%",gap:"1%"}},nt={slot:"footer",class:"dialog-footer"},it={slot:"footer",class:"dialog-footer"},st=ve({__name:"VulnType",setup(de){const{t:l}=me(),P=w({}),L=w(""),f=w(sessionStorage.getItem("token")),V=[O],h=w(1),p=w(15),_=w(0),k=w(!1),U=w(!1),C=w({}),T=w(!0),G=z=>{T.value=z.id,z.length>0?T.value=!1:T.value=!0},D=(z,s)=>{C.value.id=s.id,C.value.name=s.name,U.value=!0},q=()=>{C.value.id=null,C.value.name=""};function N(z,s){const m=new Date(z.create_time),E=new Date(s.create_time);return m<E?-1:m>E?1:0}const c=$e(()=>{const s=0+p.value;if(console.log(P.value),L.value.trim()!="")return P.value.data.filter(m=>m.name.toLowerCase().includes(L.value.toLowerCase()));try{return P.value.data.slice(0,s)}catch{return[]}});function H(z){p.value=z,h.value=1,O()}async function le(z){h.value=z,await O()}fe(()=>{V.forEach(z=>{z()})});async function O(){console.log(P.value);try{const z=await J.get(`/api/v1/getvulntype?page=${h.value}&limit=${p.value}`);P.value=z.data,_.value=z.data.total,console.log(P.value)}catch{}}function W(){we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{Z({type:"success",message:l("app.webui.deletecomplete")})}).catch(()=>{})}const te=(z,s)=>{we.confirm(l("app.webui.deletenotice"),l("app.webui.confirmdelete"),{confirmButtonText:l("app.webui.confirm"),cancelButtonText:l("app.webui.cancel"),type:"warning"}).then(()=>{Z({type:"success",message:l("app.webui.deletecomplete")}),console.log(z,s)}).catch(()=>{})};async function oe(){console.log(C.value);try{const z={headers:{Authorization:"Bearer "+f.value}},s=await J.post("/api/v1/addvulntype",C.value,z);if(console.log(s),s.data.code==1){Z({type:"success",message:l("app.webui.addsuccess")}),O(),k.value=!1;return}else if(s.data.code==2){Z({type:"error",message:l("app.webui.invalidinput")});return}else if(s.data.code==3){Z({type:"error",message:l("app.webui.addfail")});return}}catch{}}const ne=()=>{console.log(C.value);try{const z={headers:{Authorization:"Bearer "+f.value}},s=J.post("/api/v1/updatevulntype",C.value,z);if(console.log(s),s.data.code==1){Z({type:"success",message:l("app.webui.modifysucc")}),O(),U.value=!1;return}else if(s.data.code==2){Z({type:"error",message:l("app.webui.invalidinput")});return}else if(s.data.code==3){Z({type:"error",message:l("app.webui.modifyfail")});return}}catch{}};return(z,s)=>{const m=he,E=ge,g=ze,v=Se,R=Ue,j=_e,b=qe,X=Ee,M=Ae;return d(),A(ae,null,[u("div",null,[e(j,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{default:a(()=>[u("div",tt,[u("div",ot,[u("div",ut,[e(m,{modelValue:L.value,"onUpdate:modelValue":s[0]||(s[0]=I=>L.value=I),placeholder:t(l)("app.webui.search"),clearable:"",style:{width:"30%"}},null,8,["modelValue","placeholder"])]),u("div",null,[e(E,{type:"primary",onClick:s[1]||(s[1]=I=>k.value=!0)},{default:a(()=>[n(o(t(l)("app.webui.add")),1)]),_:1}),e(E,{disabled:T.value,type:"danger",onClick:W},{default:a(()=>[n(o(t(l)("app.webui.multidelete")),1)]),_:1},8,["disabled"])])]),e(v,{data:c.value,onSelectionChange:G},{default:a(()=>[e(g,{type:"selection",width:"55"}),e(g,{prop:"id",label:t(l)("app.webui.id"),sortable:""},null,8,["label"]),e(g,{prop:"name",label:t(l)("app.webui.name")},null,8,["label"]),e(g,{label:t(l)("app.webui.createtime"),sortable:"","sort-method":N},{default:a(({row:I})=>[u("span",null,o(t(ie)(I.create_time)),1)]),_:1},8,["label"]),e(g,{label:t(l)("app.webui.updatetime"),sortable:"","sort-method":N},{default:a(({row:I})=>[u("span",null,o(t(ie)(I.update_time)),1)]),_:1},8,["label"]),e(g,{label:t(l)("app.webui.operate")},{default:a(I=>[e(E,{size:"small",type:"primary",onClick:ee=>D(I.$index,I.row)},{default:a(()=>[n(o(t(l)("app.webui.edit")),1)]),_:2},1032,["onClick"]),e(E,{size:"small",type:"danger",onClick:ee=>te(I.$index,I.row)},{default:a(()=>[n(o(t(l)("app.webui.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),e(R,{"page-sizes":[15,25,50,100,200,300],"page-size":p.value,"onUpdate:pageSize":s[2]||(s[2]=I=>p.value=I),layout:"total, sizes, prev, pager, next, jumper",total:_.value,onSizeChange:H,onCurrentChange:le,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"},"hide-on-single-page":""},null,8,["page-size","total"])]),_:1})]),e(M,{title:t(l)("app.webui.addvulntype"),modelValue:k.value,"onUpdate:modelValue":s[5]||(s[5]=I=>k.value=I),width:"30%",onClose:q},{default:a(()=>[e(X,{model:C.value,"label-width":"100px"},{default:a(()=>[e(b,{label:t(l)("app.webui.name")},{default:a(()=>[e(m,{modelValue:C.value.name,"onUpdate:modelValue":s[3]||(s[3]=I=>C.value.name=I),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",nt,[e(E,{onClick:s[4]||(s[4]=I=>k.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(E,{type:"primary",onClick:oe},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"]),e(M,{title:t(l)("app.webui.editvulntype"),modelValue:U.value,"onUpdate:modelValue":s[9]||(s[9]=I=>U.value=I),width:"30%",onClose:q},{default:a(()=>[e(X,{model:C.value,"label-width":"100px"},{default:a(()=>[e(b,{label:t(l)("app.webui.id")},{default:a(()=>[e(m,{modelValue:C.value.id,"onUpdate:modelValue":s[6]||(s[6]=I=>C.value.id=I),autocomplete:"off",disabled:"true"},null,8,["modelValue"])]),_:1},8,["label"]),e(b,{label:t(l)("app.webui.name")},{default:a(()=>[e(m,{modelValue:C.value.name,"onUpdate:modelValue":s[7]||(s[7]=I=>C.value.name=I),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),u("span",it,[e(E,{onClick:s[8]||(s[8]=I=>U.value=!1)},{default:a(()=>[n(o(t(l)("app.webui.cancel")),1)]),_:1}),e(E,{type:"primary",onClick:ne},{default:a(()=>[n(o(t(l)("app.webui.confirm")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),dt=Ve(st,[["__scopeId","data-v-f13eabdc"]]),pt={style:{display:"flex"}},rt={style:{"margin-top":"20px","font-size":"14px"}},ct={style:{"margin-top":"20px","font-size":"14px"}},vt={style:{"margin-top":"20px","font-size":"14px"}},mt=ve({__name:"Profile",setup(de){const{t:l}=me(),P=sessionStorage.getItem("token"),L=w({}),f=w(!0),V=[p],h=w(sessionStorage.getItem("avatar"));fe(()=>{V.forEach(D=>{D()})});async function p(){try{const D={headers:{Authorization:`Bearer ${P}`}},q=await J.get("/api/v1/userinfo",D);L.value=q.data.data,P&&q.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload())}catch{}}const _=D=>{h.value=URL.createObjectURL(D)},k=D=>{Z.success(l("app.webui.uploadsucc")),sessionStorage.setItem("avatar","/download/file?id="+D.data),location.reload()},U=()=>{if(!L.value.email.match(/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)){Z.error(l("app.webui.emailformat"));return}T()},C=()=>{if(!L.value.phone.match(/^[1][3,4,5,6,7,8,9][0-9]{9}$/)){Z.error(l("app.webui.phoneformat"));return}T()},T=()=>{f.value=!1},G=async()=>{console.log(L.value);try{const D={headers:{Authorization:`Bearer ${P}`}},q={username:L.value.username,email:L.value.email,phone:L.value.phone},N=await J.post("/api/v1/updateuserinfo",q,D);N.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):N.data.code==1?Z.success(l("app.webui.modifysucc")):Z.error(l("app.webui.modifyerr"))}catch(D){console.error(D)}};return(D,q)=>{const N=Re,c=Ge,H=he,le=ge,O=_e;return d(),A("div",null,[e(O,{style:{padding:"30px"},header:t(l)("app.webui.myprofile")},{default:a(()=>[u("div",pt,[e(c,{accept:".png,.jpg",action:"/api/v1/updateavatar","on-success":k,headers:{Authorization:`Bearer ${t(P)}`},"before-upload":_},{default:a(()=>[e(N,{size:"large",src:h.value},null,8,["src"])]),_:1},8,["headers"])]),u("div",rt,o(t(l)("app.webui.username")),1),e(H,{modelValue:L.value.username,"onUpdate:modelValue":q[0]||(q[0]=W=>L.value.username=W),size:"large",placeholder:L.value.username,style:{"margin-top":"10px"},onChange:T},null,8,["modelValue","placeholder"]),u("div",ct,o(t(l)("app.webui.email")),1),e(H,{modelValue:L.value.email,"onUpdate:modelValue":q[1]||(q[1]=W=>L.value.email=W),size:"large",placeholder:L.value.email,style:{"margin-top":"10px"},onChange:U},null,8,["modelValue","placeholder"]),u("div",vt,o(t(l)("app.webui.phone")),1),e(H,{modelValue:L.value.phone,"onUpdate:modelValue":q[2]||(q[2]=W=>L.value.phone=W),size:"large",placeholder:L.value.phone,style:{"margin-top":"10px"},onChange:C},null,8,["modelValue","placeholder"]),e(le,{type:"primary",style:{"margin-top":"20px"},disabled:f.value,onClick:G},{default:a(()=>[n(o(t(l)("app.webui.modify")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}}),ft={style:{"margin-top":"50%"}},bt={style:{display:"flex",margin:"auto",cursor:"pointer"}},_t={style:{width:"100%"}},yt={style:{cursor:"pointer","margin-left":"auto"}},wt={style:{display:"flex","align-items":"center"}},ht={key:0},gt={key:1},Vt={key:2},xt={key:3},kt={key:4},Ct={key:5},$t={key:6},zt={key:7},St={key:8},Ut=ve({__name:"Index",setup(de){const{t:l,locale:P}=me(),L=w(!1),f=D=>{P.value=D,localStorage.setItem("selectedLanguage",D),p.value="1"},V=sessionStorage.getItem("username"),h=sessionStorage.getItem("avatar"),p=w("1"),_=w(!1);function k(){_.value=!_.value}function U(D){p.value=D}const C=ul();fe(T);function T(){sessionStorage.getItem("token")||C.push("/login")}function G(D){D==1&&(p.value="",L.value=!0),D==2&&(sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("avatar"),location.reload())}return(D,q)=>{const N=Ie,c=vl,H=ml,le=fl,O=Re,W=bl,te=_l,oe=yl,ne=wl,z=hl,s=nl;return d(),A("div",null,[e(s,null,{default:a(()=>[e(le,{collapse:_.value,class:"el-menu-vertical-demo",onSelect:U},{default:a(()=>[q[6]||(q[6]=u("div",{style:{display:"flex",margin:"auto",height:"50px",width:"50px"}},[u("img",{src:gl,fit:"contain"})],-1)),u("div",ft,[e(c,{index:"1"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(il))]),_:1}),u("span",null,o(t(l)("app.webui.dashboard")),1)]),_:1}),e(c,{index:"2"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(sl))]),_:1}),u("span",null,o(t(l)("app.webui.systemsetting")),1)]),_:1}),e(c,{index:"3"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(dl))]),_:1}),u("span",null,o(t(l)("app.webui.usermanager")),1)]),_:1}),e(H,{index:"4"},{title:a(()=>[e(N,null,{default:a(()=>q[2]||(q[2]=[u("svg",{t:"1728359731855",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1480",width:"200",height:"200"},[u("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"1481",fill:"#515151"}),u("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"1482",fill:"#515151"})],-1)])),_:1}),u("span",null,o(t(l)("app.webui.vulnmanager")),1)]),default:a(()=>[e(c,{index:"4-1"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.vulntype")),1)]),_:1}),e(c,{index:"4-2"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.allvuln")),1)]),_:1}),e(c,{index:"4-3"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.unaudit")),1)]),_:1}),e(c,{index:"4-4"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(He))]),_:1}),u("span",null,o(t(l)("app.webui.audited")),1)]),_:1})]),_:1}),e(c,{index:"5"},{default:a(()=>[e(N,null,{default:a(()=>[e(t(pl))]),_:1}),u("span",null,o(t(l)("app.webui.scorerule")),1)]),_:1}),e(H,{index:"6"},{title:a(()=>[q[3]||(q[3]=u("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em","data-v-f414ea64":"",class:"el-icon"},[u("path",{fill:"currentColor",d:"m18.5 10l4.4 11h-2.155l-1.201-3h-4.09l-1.199 3h-2.154L16.5 10h2zM10 2v2h6v2h-1.968a18.222 18.222 0 0 1-3.62 6.301a14.864 14.864 0 0 0 2.336 1.707l-.751 1.878A17.015 17.015 0 0 1 9 13.725a16.676 16.676 0 0 1-6.201 3.548l-.536-1.929a14.7 14.7 0 0 0 5.327-3.042A18.078 18.078 0 0 1 4.767 8h2.24A16.032 16.032 0 0 0 9 10.877a16.165 16.165 0 0 0 2.91-4.876L2 6V4h6V2h2zm7.5 10.885L16.253 16h2.492L17.5 12.885z"})],-1)),u("span",null,o(t(l)("app.webui.language")),1)]),default:a(()=>[e(c,{index:"11-1",onClick:q[0]||(q[0]=m=>f("zh-CN"))},{default:a(()=>q[4]||(q[4]=[n("")])),_:1}),e(c,{index:"11-2",onClick:q[1]||(q[1]=m=>f("en-US"))},{default:a(()=>q[5]||(q[5]=[n("English")])),_:1})]),_:1}),u("div",bt,[_.value?(d(),x(N,{key:1,onClick:k,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(cl))]),_:1})):(d(),x(N,{key:0,onClick:k,style:{"margin-left":"auto"},size:"25",color:"#008B8B"},{default:a(()=>[e(t(rl))]),_:1}))])])]),_:1},8,["collapse"]),u("div",_t,[e(ne,{style:{"background-color":"#393939",display:"flex","justify-content":"flex-end","align-items":"center",padding:"10px"}},{default:a(()=>[u("div",yt,[e(oe,{style:{color:"#fff"},trigger:"click",onCommand:G},{dropdown:a(()=>[e(te,null,{default:a(()=>[e(W,{command:"1"},{default:a(()=>[n(o(t(l)("app.webui.myprofile")),1)]),_:1}),e(W,{command:"2"},{default:a(()=>[n(o(t(l)("app.webui.logout")),1)]),_:1})]),_:1})]),default:a(()=>[u("span",wt,[e(O,{style:{"margin-right":"10px"},src:t(h)},null,8,["src"]),n(" "+o(t(V)),1)])]),_:1})])]),_:1}),e(z,null,{default:a(()=>[p.value==="1"?(d(),A("div",ht,[e(Ul)])):p.value==="2"?(d(),A("div",gt,[e(Ga)])):p.value==="3"?(d(),A("div",Vt,[e(Dl)])):p.value==="4-1"?(d(),A("div",xt,[e(dt)])):p.value==="4-2"?(d(),A("div",kt,[e(na)])):p.value==="4-3"?(d(),A("div",Ct,[e(Ca)])):p.value==="4-4"?(d(),A("div",$t,[e(Na)])):p.value==="5"?(d(),A("div",zt,[e(at)])):L.value?(d(),A("div",St,[e(mt)])):se("",!0)]),_:1})])]),_:1})])}}}),It=Ve(Ut,[["__scopeId","data-v-91fe8c71"]]);export{It as default};
