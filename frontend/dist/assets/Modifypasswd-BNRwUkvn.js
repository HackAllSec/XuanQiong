import{d as k,u as z,r as u,o as B,c as C,b as d,w as h,h as i,f as E,g as I,e as m,t as c,j as S,B as t,D as N,F as M}from"./index-CD0ViaIB.js";import{a as P}from"./api-BG6rU4tp.js";import{c as U}from"./utils-B2hno9cZ.js";/* empty css                   */const A={style:{width:"70%",height:"90vh",margin:"auto"}},D={style:{"margin-top":"20px","font-weight":"lighter","font-size":"14px"}},F={style:{"margin-top":"20px","font-weight":"lighter","font-size":"14px"}},$={style:{"margin-top":"20px","font-weight":"lighter","font-size":"14px"}},G=k({__name:"Modifypasswd",setup(j){const{t:e}=z(),w=u(!0),g=sessionStorage.getItem("token"),r=u(""),o=u(""),n=u(""),v=[U];B(()=>{v.forEach(l=>{l()})});const f=()=>o.value.length<8?(t.error(e("app.webui.passwordlength")),!1):o.value.match(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,}$/)?!0:(t.error(e("app.webui.passwordcomplex")),!1),y=()=>{if(o.value!=n.value){t.error(e("app.webui.passwordnotmatch"));return}f()&&_()},_=()=>{w.value=!1};async function b(){console.log(r,o,n);try{const l={headers:{Authorization:`Bearer ${g}`}},a={oldpassword:r.value,newpassword:o.value},s=await P.post("/api/v1/updatepassword",a,l);s.data.code==0?(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()):s.data.code==1?t.success(e("app.webui.modifysucc")):s.data.code==3?t.error(e("app.webui.oldpassworderr")):t.error(e("app.webui.modifyerr"))}catch{t.error(e("app.webui.modifyfail"))}}return(l,a)=>{const s=N,x=M,V=E;return I(),C("div",A,[d(V,{style:{padding:"30px","font-weight":"bold","font-size":"20px"},header:i(e)("app.webui.modifypassword")},{default:h(()=>[m("div",D,c(i(e)("app.webui.oldpassword")),1),d(s,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=p=>r.value=p),size:"large",placeholder:r.value,style:{"margin-top":"10px"},type:"password","show-password":""},null,8,["modelValue","placeholder"]),m("div",F,c(i(e)("app.webui.newpassword")),1),d(s,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=p=>o.value=p),size:"large",placeholder:o.value,style:{"margin-top":"10px"},type:"password","show-password":"",onChange:f},null,8,["modelValue","placeholder"]),m("div",$,c(i(e)("app.webui.confirmpassword")),1),d(s,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=p=>n.value=p),size:"large",placeholder:n.value,style:{"margin-top":"10px"},type:"password","show-password":"",onChange:y},null,8,["modelValue","placeholder"]),d(x,{type:"primary",disabled:w.value,style:{"margin-top":"20px"},onClick:b},{default:h(()=>[S(c(i(e)("app.webui.submit")),1)]),_:1},8,["disabled"])]),_:1},8,["header"])])}}});export{G as default};
