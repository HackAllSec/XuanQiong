import{d as Z,u as G,x as K,r as h,X as Q,o as W,c as x,b as l,w as a,h as e,f as Y,g as c,e as v,i as _,j as s,t as i,J as y,B as ee,T as te,p as ae,q as le,s as ie,Z as ne,l as oe,F as se,$ as ue,a0 as re,_ as de}from"./index-CD0ViaIB.js";/* empty css                      *//* empty css               *//* empty css                  *//* empty css                        */import{a as M}from"./api-BG6rU4tp.js";/* empty css                 */import{c as pe,f as H}from"./utils-B2hno9cZ.js";/* empty css                   */const ce={key:0,style:{width:"70%",height:"90vh",margin:"auto"}},ve={style:{"font-weight":"lighter","font-size":"17px"}},fe={key:1,style:{width:"70%","min-height":"90vh",margin:"auto"}},_e={style:{"font-weight":"lighter","font-size":"17px"}},be={class:"status"},me={key:2,style:{width:"70%","min-height":"90vh",margin:"auto"}},he={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ge={style:{"font-size":"20px","font-weight":"bold",display:"flex","align-items":"center"}},ye={style:{"font-weight":"lighter","font-size":"17px"}},we={style:{"margin-top":"10px","padding-inline":"25px"}},ke={style:{"margin-top":"10px","padding-inline":"25px"}},Ce={style:{"margin-top":"10px","padding-inline":"25px"}},xe=["href"],ze={style:{"margin-top":"10px","padding-inline":"25px",color:"red"}},Ee=Z({__name:"Myvulns",setup($e){const{t}=G(),V=K(),z=sessionStorage.getItem("token"),w=h({}),o=h({}),E=h([]),B=[pe,C],k=h(1),g=h(15),$=h(0),S=u=>{try{return Object.keys(u).length===0}catch{return!0}},F=Q(()=>{const n=0+g.value;try{return w.value.data.slice(0,n)}catch{return[]}});function D(u){g.value=u,k.value=1,C()}async function L(u){k.value=u,await C()}W(()=>{B.forEach(u=>{u()})});async function C(){try{const u={headers:{Authorization:`Bearer ${z}`}},n=await M.get(`/api/v1/uservulnlist?page=${k.value}&limit=${g.value}`,u);z&&n.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),w.value=n.data,$.value=n.data.total,E.value=n.data.data.reduce((m,p)=>(m.some(f=>f.value===p.vuln_type)||m.push({text:p.vuln_type,value:p.vuln_type}),m),[])}catch{}}const N=(u,n,m,p)=>{(n.property==="id"||n.property==="vuln_name")&&(p.target.style.cursor="pointer",p.target.style.color="#409EFF")},T=(u,n,m,p)=>{(n.property==="id"||n.property==="vuln_name")&&(p.target.style.cursor="",p.target.style.color="")},j=async(u,n)=>{if(n.no==0||n.no==1){const m=sessionStorage.getItem("token");try{const p={headers:{Authorization:`Bearer ${m}`}},f=await M.get("/api/v1/getvulndtl?id="+u.id,p);if(m&&f.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),f.data.data.id==""){ee.error(t("app.webui.notpublic"));return}o.value=f.data}catch{}}},P=(u,n)=>n.vuln_type===u,q=(u,n)=>n.level===u,A=(u,n)=>u==="Poc"?n.poc!="":n.exp!="";function J(){localStorage.setItem("form",JSON.stringify(o.value.data)),V.push({path:"/submit",query:{id:o.value.data.id}})}return(u,n)=>{const m=te,p=Y,f=ae,r=le,O=ie,R=ne,U=oe,I=se,d=ue,X=re;return S(w.value.data)?(c(),x("div",ce,[l(p,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always",header:e(t)("app.webui.mysubmitvuln")},{default:a(()=>[v("div",ve,[l(m,{description:e(t)("app.webui.empty")},null,8,["description"])])]),_:1},8,["header"])])):S(o.value.data)?(c(),x("div",fe,[l(p,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always",header:e(t)("app.webui.mysubmitvuln")},{default:a(()=>[v("div",_e,[l(O,{data:F.value,onCellMouseEnter:N,onCellMouseLeave:T,onCellClick:j},{default:a(()=>[l(f,{prop:"id",label:e(t)("app.webui.id"),width:"180",sortable:""},null,8,["label"]),l(f,{prop:"vuln_name",label:e(t)("app.webui.name")},null,8,["label"]),l(f,{prop:"vuln_type",filters:E.value,"filter-method":P,label:e(t)("app.webui.type"),width:"180"},null,8,["filters","label"]),l(f,{prop:"vuln_level",filters:[{text:e(t)("app.webui.critical"),value:"Critical"},{text:e(t)("app.webui.high"),value:"High"},{text:e(t)("app.webui.medium"),value:"Medium"},{text:e(t)("app.webui.low"),value:"Low"}],"filter-method":q,label:e(t)("app.webui.level"),width:"80"},{default:a(({row:b})=>[b.vuln_level==="Critical"?(c(),_(r,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[s(i(e(t)("app.webui.critical")),1)]),_:1})):b.vuln_level==="High"?(c(),_(r,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[s(i(e(t)("app.webui.high")),1)]),_:1})):b.vuln_level==="Medium"?(c(),_(r,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[s(i(e(t)("app.webui.medium")),1)]),_:1})):(c(),_(r,{key:3,type:"primary",effect:"dark"},{default:a(()=>[s(i(e(t)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),l(f,{prop:"cvss",label:"CVSS",width:"80"}),l(f,{filters:[{text:e(t)("app.webui.auditing"),value:0},{text:e(t)("app.webui.passed"),value:1},{text:e(t)("app.webui.unpassed"),value:2}],"filter-method":A,label:e(t)("app.webui.status"),width:"80"},{default:a(({row:b})=>[v("div",be,[b.status==0?(c(),_(r,{key:0,type:"primary",effect:"dark"},{default:a(()=>[s(i(e(t)("app.webui.auditing")),1)]),_:1})):y("",!0),b.status==1?(c(),_(r,{key:1,type:"success",effect:"dark"},{default:a(()=>[s(i(e(t)("app.webui.passed")),1)]),_:1})):y("",!0),b.status==2?(c(),_(r,{key:2,type:"info",effect:"dark"},{default:a(()=>[s(i(e(t)("app.webui.unpassed")),1)]),_:1})):y("",!0)])]),_:1},8,["filters","label"]),l(f,{label:e(t)("app.webui.createtime"),width:"120",sortable:""},{default:a(({row:b})=>[v("span",null,i(e(H)(b.create_time)),1)]),_:1},8,["label"])]),_:1},8,["data"])]),l(R,{"page-sizes":[15,25,50,100,200,300],"page-size":g.value,"onUpdate:pageSize":n[0]||(n[0]=b=>g.value=b),background:u.background,layout:"total, sizes, prev, pager, next, jumper",total:$.value,onSizeChange:D,onCurrentChange:L,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"}},null,8,["page-size","background","total"])]),_:1},8,["header"])])):(c(),x("div",me,[l(p,{style:{"font-size":"20px","font-weight":"bold"},shadow:"always"},{header:a(()=>[v("div",he,[v("span",ge,[l(U,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>n[2]||(n[2]=[v("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[v("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),v("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),s(" "+i(o.value.data.vuln_name),1)]),v("div",null,[o.value.data.status!=1?(c(),_(I,{key:0,type:"success",onClick:J},{default:a(()=>[s(i(e(t)("app.webui.edit")),1)]),_:1})):y("",!0),l(I,{type:"primary",onClick:n[1]||(n[1]=b=>o.value="")},{default:a(()=>[s(i(e(t)("el.pageHeader.title")),1)]),_:1})])])]),default:a(()=>[v("div",ye,[l(X,{column:5},{default:a(()=>[l(d,{label:`${e(t)("app.webui.id")}:`},{default:a(()=>[l(r,null,{default:a(()=>[s(i(o.value.data.id),1)]),_:1})]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.type")}:`},{default:a(()=>[s(i(o.value.data.vuln_type),1)]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.level")}:`},{default:a(()=>[o.value.data.vuln_level==="Critical"?(c(),_(r,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[s(i(e(t)("app.webui.critical")),1)]),_:1})):o.value.data.vuln_level==="High"?(c(),_(r,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[s(i(e(t)("app.webui.high")),1)]),_:1})):o.value.data.vuln_level==="Medium"?(c(),_(r,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[s(i(e(t)("app.webui.medium")),1)]),_:1})):(c(),_(r,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[s(i(e(t)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.createtime")}:`},{default:a(()=>[s(i(e(H)(o.value.data.create_time)),1)]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.submitter")}:`},{default:a(()=>[s(i(o.value.data.submitter),1)]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.cveid")}:`},{default:a(()=>[l(r,null,{default:a(()=>[s(i(o.value.data.cve),1)]),_:1})]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.nvdid")}:`},{default:a(()=>[l(r,null,{default:a(()=>[s(i(o.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.edbid")}:`},{default:a(()=>[l(r,null,{default:a(()=>[s(i(o.value.data.edb),1)]),_:1})]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.cnnvdid")}:`},{default:a(()=>[l(r,null,{default:a(()=>[s(i(o.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),l(d,{label:`${e(t)("app.webui.cnvdid")}:`},{default:a(()=>[l(r,null,{default:a(()=>[s(i(o.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),l(d,{span:"2",label:`${e(t)("app.webui.affectedproduct")}:`},{default:a(()=>[s(i(o.value.data.affected_product),1)]),_:1},8,["label"]),l(d,{span:"2",label:`${e(t)("app.webui.productversion")}:`},{default:a(()=>[s(i(o.value.data.affected_product_version),1)]),_:1},8,["label"]),l(d,{label:"CVSS:"},{default:a(()=>[s(i(o.value.data.cvss),1)]),_:1}),l(d,{span:"5",label:`${e(t)("app.webui.vulndesc")}:`},{default:a(()=>[v("div",we,i(o.value.data.description),1)]),_:1},8,["label"]),l(d,{span:"5",label:`${e(t)("app.webui.vulnsuggest")}:`},{default:a(()=>[v("div",ke,i(o.value.data.repair_suggestion),1)]),_:1},8,["label"]),o.value.data.attachment_id?(c(),_(d,{key:0,span:"5",label:`${e(t)("app.webui.attachfile")}:`},{default:a(()=>[v("div",Ce,[v("a",{href:`/download/file?id=${o.value.data.attachment_id}`},i(o.value.data.attachment_name),9,xe)])]),_:1},8,["label"])):y("",!0),l(d,{span:"5",label:`${e(t)("app.webui.reviewcomments")}:`},{default:a(()=>[v("div",ze,i(o.value.data.review_comments),1)]),_:1},8,["label"])]),_:1})])]),_:1})]))}}}),Ne=de(Ee,[["__scopeId","data-v-4093841b"]]);export{Ne as default};
