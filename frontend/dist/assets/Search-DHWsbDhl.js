import{d as ie,u as ne,r as w,W as pe,c as C,b as l,i as o,B as se,w as t,I as re,C as h,f as D,F as de,G as ce,g as ve,X as fe,h as f,Y as ye,k as p,t as i,e as b,j as m,K as F,Z as A,q as be,s as me,v as _e,$ as we,m as he,a0 as ge,a1 as xe,U as ke,L as Ce,a2 as Ve,R as ze,_ as Ee}from"./index-JDjDOS_H.js";/* empty css                   *//* empty css                        *//* empty css                 *//* empty css                      *//* empty css                *//* empty css               *//* empty css                  *//* empty css                 */import{f as L}from"./utils-DPxaPrc8.js";/* empty css                   */const $e={key:0,style:{display:"flex","justify-content":"center","margin-top":"20vh",width:"100%","min-height":"90vh"}},Se={key:1,style:{width:"70%","min-height":"90vh",margin:"auto"}},qe={style:{display:"flex","justify-content":"space-between","align-items":"center"}},He={style:{"font-size":"20px","font-weight":"bold",display:"flex","align-items":"center"}},Ue={style:{"font-weight":"lighter","font-size":"17px"}},Ie={class:"status"},De={key:2,style:{width:"70%","min-height":"90vh",margin:"auto"}},Fe={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Me={style:{"font-size":"20px","font-weight":"bold",display:"flex","align-items":"center"}},Be={style:{"font-weight":"lighter","font-size":"17px"}},Pe={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},je={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},Te={style:{"margin-top":"10px","padding-inline":"25px"}},Ae=["href"],Le={style:{"font-weight":"lighter","font-size":"17px"}},Ne={key:0,style:{"font-weight":"lighter","font-size":"14px",position:"relative"}},Ge={key:0,style:{"font-weight":"lighter","font-size":"14px",position:"relative"}},Ke={slot:"footer",class:"dialog-footer"},Ze=ie({__name:"Search",setup(Oe){const{t:a}=ne(),V=w({}),u=w({}),q=w([]),$=w(1),g=w(15),H=w(0),U=w(!0),S=w(""),d=w({}),I=w(0),x=w(!1),M=s=>{try{return Object.keys(s).length===0}catch{return!0}};function N(s,e){const r=new Date(s.create_time),c=new Date(e.create_time);return r<c?-1:r>c?1:0}const G=pe(()=>{const e=0+g.value;try{return V.value.data.slice(0,e)}catch{return[]}});function K(s){g.value=s,$.value=1,z()}async function Z(s){$.value=s,await z()}function O(){I.value=1,x.value=!0}function Q(){V.value="",I.value=0}async function z(){if(I.value==1){if(!d.value.vuln_name&&!d.value.vuln_type&&!d.value.vulndesc&&!d.value.affected_product&&!d.value.poc&&!d.value.exp){h.error(a("app.webui.nokeyword1"));return}try{d.value.page=$.value,d.value.limit=g.value;const s=await D.post("/api/v1/advsearch",d.value);if(s.data.total==0){h.error(a("app.webui.noresult2"));return}V.value=s.data,H.value=s.data.total,q.value=s.data.data.reduce((e,r)=>(e.some(c=>c.value===r.vuln_type)||e.push({text:r.vuln_type,value:r.vuln_type}),e),[])}catch{}x.value=!1}else{if(S.value==""){h.error(a("app.webui.nokeyword"));return}try{const s=await D.get(`/api/v1/search?keyword=${S.value}&page=${$.value}&limit=${g.value}`);if(s.data.total==0){h.error(a("app.webui.noresult"));return}V.value=s.data,H.value=s.data.total,q.value=s.data.data.reduce((e,r)=>(e.some(c=>c.value===r.vuln_type)||e.push({text:r.vuln_type,value:r.vuln_type}),e),[])}catch{}}}const B=s=>{if(s)if(navigator.clipboard)try{navigator.clipboard.writeText(s),h.success(a("app.webui.copysuccess"))}catch{h.error(a("app.webui.copyfail"))}else{const e=document.createElement("textarea");e.value=s,e.style.position="fixed",e.style.opacity="0",e.style.left="0",e.style.top="0",e.style.height="0",e.style.width="0",e.style.overflow="hidden",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")?h.success(a("app.webui.copysuccess")):h.error(a("app.webui.copyfail"))}catch{h.error(a("app.webui.copyfail"))}}else h.error(a("app.webui.copyfail"))},R=(s,e,r,c)=>{(e.property==="id"||e.property==="vuln_name")&&(c.target.style.cursor="pointer",c.target.style.color="#409EFF")},W=(s,e,r,c)=>{(e.property==="id"||e.property==="vuln_name")&&(c.target.style.cursor="",c.target.style.color="")},X=async(s,e)=>{if(e.no==0||e.no==1){const r=sessionStorage.getItem("token");try{const c={headers:{Authorization:`Bearer ${r}`}},_=await D.get("/api/v1/getvulndtl?id="+s.id,c);if(r&&_.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),_.data.data.id==""){h.error(a("app.webui.notpublic"));return}u.value=_.data,r||(u.value.data.poc=a("app.webui.needlogin"),u.value.data.exp=a("app.webui.needlogin"),U.value=!1)}catch{}}},Y=(s,e)=>e.vuln_type===s,J=(s,e)=>e.level===s,ee=(s,e)=>s==="Poc"?e.poc!="":e.exp!="";return(s,e)=>{const r=de,c=ce,_=be,y=me,ae=_e,le=we,E=ve,te=he,v=ge,P=xe,j=ke,k=Ce,T=Ve,oe=ze,ue=fe;return f(),C(re,null,[M(V.value.data)?(f(),C("div",$e,[l(r,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=n=>S.value=n),size:"large",style:{width:"40%",height:"10%","margin-right":"1vw"},placeholder:o(a)("app.webui.search"),"prefix-icon":o(ye),onKeyup:se(z,["enter","native"]),clearable:""},null,8,["modelValue","placeholder","prefix-icon"]),l(c,{type:"primary",size:"large",onClick:z},{default:t(()=>[p(i(o(a)("app.webui.search")),1)]),_:1}),l(c,{size:"large",onClick:O},{default:t(()=>[p(i(o(a)("app.webui.advsearch")),1)]),_:1})])):M(u.value.data)?(f(),C("div",Se,[l(E,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always"},{header:t(()=>[b("div",qe,[b("span",He,i(o(a)("app.webui.searchresult")),1),l(c,{type:"primary",onClick:Q},{default:t(()=>[p(i(o(a)("el.pageHeader.title")),1)]),_:1})])]),default:t(()=>[b("div",Ue,[l(ae,{data:G.value,onCellMouseEnter:R,onCellMouseLeave:W,onCellClick:X},{default:t(()=>[l(_,{prop:"id",label:o(a)("app.webui.id"),width:"180",sortable:""},null,8,["label"]),l(_,{prop:"vuln_name",label:o(a)("app.webui.name")},null,8,["label"]),l(_,{prop:"vuln_type",filters:q.value,"filter-method":Y,label:o(a)("app.webui.type"),width:"180"},null,8,["filters","label"]),l(_,{prop:"vuln_level",filters:[{text:o(a)("app.webui.critical"),value:"Critical"},{text:o(a)("app.webui.high"),value:"High"},{text:o(a)("app.webui.medium"),value:"Medium"},{text:o(a)("app.webui.low"),value:"Low"}],"filter-method":J,label:o(a)("app.webui.level"),width:"80"},{default:t(({row:n})=>[n.vuln_level==="Critical"?(f(),m(y,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:t(()=>[p(i(o(a)("app.webui.critical")),1)]),_:1})):n.vuln_level==="High"?(f(),m(y,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:t(()=>[p(i(o(a)("app.webui.high")),1)]),_:1})):n.vuln_level==="Medium"?(f(),m(y,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:t(()=>[p(i(o(a)("app.webui.medium")),1)]),_:1})):(f(),m(y,{key:3,type:"primary",effect:"dark"},{default:t(()=>[p(i(o(a)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),l(_,{prop:"cvss",label:"CVSS",width:"80"}),l(_,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":ee,label:o(a)("app.webui.status"),width:"120"},{default:t(({row:n})=>[b("div",Ie,[n.poc!=""&&n.poc!="0"?(f(),m(y,{key:0,type:"success",effect:"dark"},{default:t(()=>e[17]||(e[17]=[p("Poc")])),_:1})):(f(),m(y,{key:1,type:"info",effect:"dark"},{default:t(()=>e[18]||(e[18]=[p("Poc")])),_:1})),n.exp!=""&&n.exp!="0"?(f(),m(y,{key:2,type:"success",effect:"dark"},{default:t(()=>e[19]||(e[19]=[p("Exp")])),_:1})):(f(),m(y,{key:3,type:"info",effect:"dark"},{default:t(()=>e[20]||(e[20]=[p("Exp")])),_:1}))])]),_:1},8,["label"]),l(_,{label:o(a)("app.webui.createtime"),width:"120",sortable:"","sort-method":N},{default:t(({row:n})=>[b("span",null,i(o(L)(n.create_time)),1)]),_:1},8,["label"])]),_:1},8,["data"])]),l(le,{"page-sizes":[15,25,50,100,200,300],"page-size":g.value,"onUpdate:pageSize":e[1]||(e[1]=n=>g.value=n),background:s.background,layout:"total, sizes, prev, pager, next, jumper",total:H.value,onSizeChange:K,onCurrentChange:Z,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"}},null,8,["page-size","background","total"])]),_:1})])):(f(),C("div",De,[l(E,{style:{"font-size":"20px","font-weight":"bold"},shadow:"always"},{header:t(()=>[b("div",Fe,[b("span",Me,[l(te,{size:"25",style:{"margin-right":"10px"}},{default:t(()=>e[21]||(e[21]=[b("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[b("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),b("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),p(" "+i(u.value.data.vuln_name),1)]),l(c,{type:"primary",onClick:e[2]||(e[2]=n=>u.value="")},{default:t(()=>[p(i(o(a)("el.pageHeader.title")),1)]),_:1})])]),default:t(()=>[b("div",Be,[l(P,{column:5},{default:t(()=>[l(v,{label:`${o(a)("app.webui.id")}:`},{default:t(()=>[l(y,null,{default:t(()=>[p(i(u.value.data.id),1)]),_:1})]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.type")}:`},{default:t(()=>[p(i(u.value.data.vuln_type),1)]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.level")}:`},{default:t(()=>[u.value.data.vuln_level==="Critical"?(f(),m(y,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:t(()=>[p(i(o(a)("app.webui.critical")),1)]),_:1})):u.value.data.vuln_level==="High"?(f(),m(y,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:t(()=>[p(i(o(a)("app.webui.high")),1)]),_:1})):u.value.data.vuln_level==="Medium"?(f(),m(y,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:t(()=>[p(i(o(a)("app.webui.medium")),1)]),_:1})):(f(),m(y,{key:3,type:"primary",effect:"dark",size:"small"},{default:t(()=>[p(i(o(a)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.createtime")}:`},{default:t(()=>[p(i(o(L)(u.value.data.create_time)),1)]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.submitter")}:`},{default:t(()=>[p(i(u.value.data.submitter),1)]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.cveid")}:`},{default:t(()=>[l(y,null,{default:t(()=>[p(i(u.value.data.cve),1)]),_:1})]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.nvdid")}:`},{default:t(()=>[l(y,null,{default:t(()=>[p(i(u.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.edbid")}:`},{default:t(()=>[l(y,null,{default:t(()=>[p(i(u.value.data.edb),1)]),_:1})]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.cnnvdid")}:`},{default:t(()=>[l(y,null,{default:t(()=>[p(i(u.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),l(v,{label:`${o(a)("app.webui.cnvdid")}:`},{default:t(()=>[l(y,null,{default:t(()=>[p(i(u.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),l(v,{span:"2",label:`${o(a)("app.webui.affectedproduct")}:`},{default:t(()=>[p(i(u.value.data.affected_product),1)]),_:1},8,["label"]),l(v,{span:"2",label:`${o(a)("app.webui.productversion")}:`},{default:t(()=>[p(i(u.value.data.affected_product_version),1)]),_:1},8,["label"]),l(v,{label:"CVSS:"},{default:t(()=>[p(i(u.value.data.cvss),1)]),_:1}),l(v,{span:"5",label:`${o(a)("app.webui.vulndesc")}:`},{default:t(()=>[b("div",Pe,i(u.value.data.description),1)]),_:1},8,["label"]),l(v,{span:"5",label:`${o(a)("app.webui.vulnsuggest")}:`},{default:t(()=>[b("div",je,i(u.value.data.repair_suggestion),1)]),_:1},8,["label"]),u.value.data.attachment_id?(f(),m(v,{key:0,span:"5",label:`${o(a)("app.webui.attachfile")}:`},{default:t(()=>[b("div",Te,[b("a",{href:`/download/file?id=${u.value.data.attachment_id}`},i(u.value.data.attachment_name),9,Ae)])]),_:1},8,["label"])):F("",!0)]),_:1})])]),_:1}),l(E,{style:{"font-size":"20px","font-weight":"bold","margin-top":"20px"},shadow:"always",header:o(a)("app.webui.searchquery")},{default:t(()=>[b("div",Le,[l(P,{column:5},{default:t(()=>[l(v,{span:"2",label:`Fofa ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.fofa_query),1)]),_:1},8,["label"]),l(v,{span:"2",label:`ZoomEye ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.zoom_eye_query),1)]),_:1},8,["label"]),l(v,{label:`Quake ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.quake_query),1)]),_:1},8,["label"]),l(v,{span:"2",label:`Hunter ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.hunter_query),1)]),_:1},8,["label"]),l(v,{span:"2",label:`Google ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.google_query),1)]),_:1},8,["label"]),l(v,{label:`Shodan ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.shodan_query),1)]),_:1},8,["label"]),l(v,{span:"2",label:`Censys ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.censys_query),1)]),_:1},8,["label"]),l(v,{label:`Greynoise ${o(a)("app.webui.searchquery")}:`},{default:t(()=>[p(i(u.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),l(E,{style:{"font-size":"20px","font-weight":"bold","margin-top":"20px"},shadow:"always",header:"Poc"},{default:t(()=>[u.value.data.poc!=""?(f(),C("div",Ne,[U.value?(f(),m(c,{key:0,type:"primary",icon:o(A),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:e[3]||(e[3]=n=>B(u.value.data.poc))},null,8,["icon"])):F("",!0),l(r,{modelValue:u.value.data.poc,"onUpdate:modelValue":e[4]||(e[4]=n=>u.value.data.poc=n),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(f(),m(j,{key:1,style:{height:"30vh"},description:o(a)("app.webui.empty")},null,8,["description"]))]),_:1}),l(E,{style:{"font-size":"20px","font-weight":"bold","margin-top":"20px"},shadow:"always",header:"Exp"},{default:t(()=>[u.value.data.exp!=""?(f(),C("div",Ge,[U.value?(f(),m(c,{key:0,type:"primary",icon:o(A),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:e[5]||(e[5]=n=>B(u.value.data.exp))},null,8,["icon"])):F("",!0),l(r,{modelValue:u.value.data.exp,"onUpdate:modelValue":e[6]||(e[6]=n=>u.value.data.exp=n),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(f(),m(j,{key:1,style:{height:"30vh"},description:o(a)("app.webui.empty")},null,8,["description"]))]),_:1})])),l(ue,{title:o(a)("app.webui.advsearch"),modelValue:x.value,"onUpdate:modelValue":e[15]||(e[15]=n=>x.value=n),width:"30%",onClose:e[16]||(e[16]=n=>x.value=!1)},{default:t(()=>[l(oe,{model:d.value,"label-width":"100px"},{default:t(()=>[l(k,{label:o(a)("app.webui.vulnname")},{default:t(()=>[l(r,{modelValue:d.value.vuln_name,"onUpdate:modelValue":e[7]||(e[7]=n=>d.value.vuln_name=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{label:o(a)("app.webui.vulndesc")},{default:t(()=>[l(r,{modelValue:d.value.description,"onUpdate:modelValue":e[8]||(e[8]=n=>d.value.description=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{label:o(a)("app.webui.vulntype")},{default:t(()=>[l(r,{modelValue:d.value.vuln_type,"onUpdate:modelValue":e[9]||(e[9]=n=>d.value.vuln_type=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{label:o(a)("app.webui.vulnlevel")},{default:t(()=>[l(r,{modelValue:d.value.vuln_level,"onUpdate:modelValue":e[10]||(e[10]=n=>d.value.vuln_level=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{label:o(a)("app.webui.affectedproduct")},{default:t(()=>[l(r,{modelValue:d.value.affected_product,"onUpdate:modelValue":e[11]||(e[11]=n=>d.value.affected_product=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(k,null,{default:t(()=>[l(T,{modelValue:d.value.poc,"onUpdate:modelValue":e[12]||(e[12]=n=>d.value.poc=n),label:"Poc",size:"large"},null,8,["modelValue"]),l(T,{modelValue:d.value.exp,"onUpdate:modelValue":e[13]||(e[13]=n=>d.value.exp=n),label:"Exp",size:"large"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),b("span",Ke,[l(c,{onClick:e[14]||(e[14]=n=>x.value=!1)},{default:t(()=>[p(i(o(a)("el.pageHeader.title")),1)]),_:1}),l(c,{type:"primary",onClick:z},{default:t(()=>[p(i(o(a)("app.webui.submit")),1)]),_:1})])]),_:1},8,["title","modelValue"])],64)}}}),ua=Ee(Ze,[["__scopeId","data-v-f21bb1af"]]);export{ua as default};
