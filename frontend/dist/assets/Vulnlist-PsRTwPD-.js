import{d as R,u as X,r as _,W as Y,o as ee,c as w,b as o,i as l,w as a,f as I,U as te,g as ae,h as d,e as b,j as y,k as n,t as s,K as E,Z as F,C as h,q as le,s as oe,v as ie,$ as ne,m as se,G as ue,a0 as pe,a1 as re,F as de,_ as ce}from"./index-JDjDOS_H.js";/* empty css                 *//* empty css                      *//* empty css                *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                 */import{f as B}from"./utils-DPxaPrc8.js";/* empty css                   */const fe={key:0,style:{"min-height":"90vh"}},ve={key:1,style:{width:"70%","min-height":"90vh",margin:"auto"}},ye={style:{"font-weight":"lighter","font-size":"17px"}},be={class:"status"},_e={key:2,style:{width:"70%","min-height":"90vh",margin:"auto"}},he={style:{display:"flex","justify-content":"space-between","align-items":"center"}},me={style:{"font-size":"20px","font-weight":"bold",display:"flex","align-items":"center"}},ge={style:{"font-weight":"lighter","font-size":"17px"}},we={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},xe={style:{"margin-top":"10px","padding-inline":"25px","white-space":"pre-wrap"}},ke={style:{"margin-top":"10px","padding-inline":"25px"}},Ce=["href"],ze={style:{"font-weight":"lighter","font-size":"17px"}},$e={key:0,style:{"font-weight":"lighter","font-size":"14px",position:"relative"}},Ee={key:0,style:{"font-weight":"lighter","font-size":"14px",position:"relative"}},qe=R({__name:"Vulnlist",setup(Ve){const{t}=X(),x=_({}),i=_({}),q=_([]),P=[z],k=_(1),m=_(15),V=_(0),C=_(!0),S=u=>{try{return Object.keys(u).length===0}catch{return!0}};function T(u,e){const f=new Date(u.create_time),c=new Date(e.create_time);return f<c?-1:f>c?1:0}const j=Y(()=>{const e=0+m.value;try{return x.value.data.slice(0,e)}catch{return[]}});function L(u){m.value=u,k.value=1,z()}async function N(u){k.value=u,await z()}ee(()=>{P.forEach(u=>{u()})});async function z(){try{const u=await I.get(`/api/v1/getvulnlist?page=${k.value}&limit=${m.value}`);x.value=u.data,V.value=u.data.total,q.value=u.data.data.reduce((e,f)=>(e.some(c=>c.value===f.vuln_type)||e.push({text:f.vuln_type,value:f.vuln_type}),e),[])}catch{}}const M=u=>{if(u)if(navigator.clipboard)try{navigator.clipboard.writeText(u),h.success(t("app.webui.copysuccess"))}catch{h.error(t("app.webui.copyfail"))}else{const e=document.createElement("textarea");e.value=u,e.style.position="fixed",e.style.opacity="0",e.style.left="0",e.style.top="0",e.style.height="0",e.style.width="0",e.style.overflow="hidden",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")?h.success(t("app.webui.copysuccess")):h.error(t("app.webui.copyfail"))}catch{h.error(t("app.webui.copyfail"))}}else h.error(t("app.webui.copyfail"))},U=(u,e,f,c)=>{(e.property==="id"||e.property==="vuln_name")&&(c.target.style.cursor="pointer",c.target.style.color="#409EFF")},A=(u,e,f,c)=>{(e.property==="id"||e.property==="vuln_name")&&(c.target.style.cursor="",c.target.style.color="")},G=async(u,e)=>{if(e.no==0||e.no==1){const f=sessionStorage.getItem("token");try{const c={headers:{Authorization:`Bearer ${f}`}},r=await I.get("/api/v1/getvulndtl?id="+u.id,c);if(f&&r.data.code==0&&(sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("avatar"),location.reload()),r.data.data.id==""){h.error(t("app.webui.notpublic"));return}i.value=r.data,f||(i.value.data.poc=t("app.webui.needlogin"),i.value.data.exp=t("app.webui.needlogin"),C.value=!1)}catch{}}},Z=(u,e)=>e.vuln_type===u,K=(u,e)=>e.level===u,O=(u,e)=>u==="Poc"?e.poc!="":e.exp!="";return(u,e)=>{const f=te,c=le,r=oe,Q=ie,W=ne,g=ae,J=se,$=ue,p=pe,H=re,D=de;return S(x.value.data)?(d(),w("div",fe,[o(f,{description:l(t)("app.webui.empty")},null,8,["description"])])):S(i.value.data)?(d(),w("div",ve,[o(g,{style:{height:"100%","font-size":"20px","font-weight":"bold"},shadow:"always",header:l(t)("app.webui.vulnlist")},{default:a(()=>[b("div",ye,[o(Q,{data:j.value,onCellMouseEnter:U,onCellMouseLeave:A,onCellClick:G},{default:a(()=>[o(c,{prop:"id",label:l(t)("app.webui.id"),width:"180",sortable:""},null,8,["label"]),o(c,{prop:"vuln_name",label:l(t)("app.webui.name")},null,8,["label"]),o(c,{prop:"vuln_type",filters:q.value,"filter-method":Z,label:l(t)("app.webui.type"),width:"180"},null,8,["filters","label"]),o(c,{prop:"vuln_level",filters:[{text:l(t)("app.webui.critical"),value:"Critical"},{text:l(t)("app.webui.high"),value:"High"},{text:l(t)("app.webui.medium"),value:"Medium"},{text:l(t)("app.webui.low"),value:"Low"}],"filter-method":K,label:l(t)("app.webui.level"),width:"80"},{default:a(({row:v})=>[v.vuln_level==="Critical"?(d(),y(r,{key:0,type:"danger",effect:"dark",color:"#CD0000"},{default:a(()=>[n(s(l(t)("app.webui.critical")),1)]),_:1})):v.vuln_level==="High"?(d(),y(r,{key:1,type:"danger",effect:"dark",color:"#EE2C2C"},{default:a(()=>[n(s(l(t)("app.webui.high")),1)]),_:1})):v.vuln_level==="Medium"?(d(),y(r,{key:2,type:"warning",effect:"dark",color:"#FF6600"},{default:a(()=>[n(s(l(t)("app.webui.medium")),1)]),_:1})):(d(),y(r,{key:3,type:"primary",effect:"dark"},{default:a(()=>[n(s(l(t)("app.webui.low")),1)]),_:1}))]),_:1},8,["filters","label"]),o(c,{prop:"cvss",label:"CVSS",width:"80"}),o(c,{filters:[{text:"Poc",value:"Poc"},{text:"Exp",value:"Exp"}],"filter-method":O,label:l(t)("app.webui.status"),width:"120"},{default:a(({row:v})=>[b("div",be,[v.poc!=""&&v.poc!="0"?(d(),y(r,{key:0,type:"success",effect:"dark"},{default:a(()=>e[6]||(e[6]=[n("Poc")])),_:1})):(d(),y(r,{key:1,type:"info",effect:"dark"},{default:a(()=>e[7]||(e[7]=[n("Poc")])),_:1})),v.exp!=""&&v.exp!="0"?(d(),y(r,{key:2,type:"success",effect:"dark"},{default:a(()=>e[8]||(e[8]=[n("Exp")])),_:1})):(d(),y(r,{key:3,type:"info",effect:"dark"},{default:a(()=>e[9]||(e[9]=[n("Exp")])),_:1}))])]),_:1},8,["label"]),o(c,{label:l(t)("app.webui.createtime"),width:"120",sortable:"","sort-method":T},{default:a(({row:v})=>[b("span",null,s(l(B)(v.create_time)),1)]),_:1},8,["label"])]),_:1},8,["data"])]),o(W,{"page-sizes":[15,25,50,100,200,300],"page-size":m.value,"onUpdate:pageSize":e[0]||(e[0]=v=>m.value=v),background:u.background,layout:"total, sizes, prev, pager, next, jumper",total:V.value,onSizeChange:L,onCurrentChange:N,style:{bottom:"auto","margin-top":"2%","margin-left":"60%"}},null,8,["page-size","background","total"])]),_:1},8,["header"])])):(d(),w("div",_e,[o(g,{style:{"font-size":"20px","font-weight":"bold"},shadow:"always"},{header:a(()=>[b("div",he,[b("span",me,[o(J,{size:"25",style:{"margin-right":"10px"}},{default:a(()=>e[10]||(e[10]=[b("svg",{t:"1727430038190",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21943",width:"200",height:"200"},[b("path",{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 34.8-28.2 63-63 63H232c-34.8 0-63-28.2-63-63 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5 0.2 13 0.7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7 6 17.2 13.6 33.6 22.7 49 24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2c41.5-24.3 76.2-59 100.5-100.5 9.1-15.5 16.7-31.9 22.7-49C812.1 793.1 836 831.8 836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7 0.4-6.4 0.7-12.8 0.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3-20.1 11.8-42 20-64.9 24.3V484c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v396.5c-22.9-4.3-44.8-12.5-64.9-24.3-30.3-17.7-55.6-43-73.3-73.3C317.7 752 308 716.8 308 680V412h408v268z","p-id":"21944",fill:"#d81e06"}),b("path",{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1-17.2-31.5-42.5-56.8-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9-31.5 17.2-56.8 42.5-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z","p-id":"21945",fill:"#d81e06"})],-1)])),_:1}),n(" "+s(i.value.data.vuln_name),1)]),o($,{type:"primary",onClick:e[1]||(e[1]=v=>i.value="")},{default:a(()=>[n(s(l(t)("el.pageHeader.title")),1)]),_:1})])]),default:a(()=>[b("div",ge,[o(H,{column:5},{default:a(()=>[o(p,{label:`${l(t)("app.webui.id")}:`},{default:a(()=>[o(r,null,{default:a(()=>[n(s(i.value.data.id),1)]),_:1})]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.type")}:`},{default:a(()=>[n(s(i.value.data.vuln_type),1)]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.level")}:`},{default:a(()=>[i.value.data.vuln_level==="Critical"?(d(),y(r,{key:0,type:"danger",color:"#CD0000",effect:"dark",size:"small"},{default:a(()=>[n(s(l(t)("app.webui.critical")),1)]),_:1})):i.value.data.vuln_level==="High"?(d(),y(r,{key:1,type:"danger",color:"#EE2C2C",effect:"dark",size:"small"},{default:a(()=>[n(s(l(t)("app.webui.high")),1)]),_:1})):i.value.data.vuln_level==="Medium"?(d(),y(r,{key:2,type:"warning",color:"#FF6600",effect:"dark",size:"small"},{default:a(()=>[n(s(l(t)("app.webui.medium")),1)]),_:1})):(d(),y(r,{key:3,type:"primary",effect:"dark",size:"small"},{default:a(()=>[n(s(l(t)("app.webui.low")),1)]),_:1}))]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.createtime")}:`},{default:a(()=>[n(s(l(B)(i.value.data.create_time)),1)]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.submitter")}:`},{default:a(()=>[n(s(i.value.data.submitter),1)]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.cveid")}:`},{default:a(()=>[o(r,null,{default:a(()=>[n(s(i.value.data.cve),1)]),_:1})]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.nvdid")}:`},{default:a(()=>[o(r,null,{default:a(()=>[n(s(i.value.data.nvd),1)]),_:1})]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.edbid")}:`},{default:a(()=>[o(r,null,{default:a(()=>[n(s(i.value.data.edb),1)]),_:1})]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.cnnvdid")}:`},{default:a(()=>[o(r,null,{default:a(()=>[n(s(i.value.data.cnnvd),1)]),_:1})]),_:1},8,["label"]),o(p,{label:`${l(t)("app.webui.cnvdid")}:`},{default:a(()=>[o(r,null,{default:a(()=>[n(s(i.value.data.cnvd),1)]),_:1})]),_:1},8,["label"]),o(p,{span:"2",label:`${l(t)("app.webui.affectedproduct")}:`},{default:a(()=>[n(s(i.value.data.affected_product),1)]),_:1},8,["label"]),o(p,{span:"2",label:`${l(t)("app.webui.productversion")}:`},{default:a(()=>[n(s(i.value.data.affected_product_version),1)]),_:1},8,["label"]),o(p,{label:"CVSS:"},{default:a(()=>[n(s(i.value.data.cvss),1)]),_:1}),o(p,{span:"5",label:`${l(t)("app.webui.vulndesc")}:`},{default:a(()=>[b("div",we,s(i.value.data.description),1)]),_:1},8,["label"]),o(p,{span:"5",label:`${l(t)("app.webui.vulnsuggest")}:`},{default:a(()=>[b("div",xe,s(i.value.data.repair_suggestion),1)]),_:1},8,["label"]),i.value.data.attachment_id?(d(),y(p,{key:0,span:"5",label:`${l(t)("app.webui.attachfile")}:`},{default:a(()=>[b("div",ke,[b("a",{href:`/download/file?id=${i.value.data.attachment_id}`},s(i.value.data.attachment_name),9,Ce)])]),_:1},8,["label"])):E("",!0)]),_:1})])]),_:1}),o(g,{style:{"font-size":"20px","font-weight":"bold","margin-top":"20px"},shadow:"always",header:l(t)("app.webui.searchquery")},{default:a(()=>[b("div",ze,[o(H,{column:5},{default:a(()=>[o(p,{span:"2",label:`Fofa ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.fofa_query),1)]),_:1},8,["label"]),o(p,{span:"2",label:`ZoomEye ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.zoom_eye_query),1)]),_:1},8,["label"]),o(p,{label:`Quake ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.quake_query),1)]),_:1},8,["label"]),o(p,{span:"2",label:`Hunter ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.hunter_query),1)]),_:1},8,["label"]),o(p,{span:"2",label:`Google ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.google_query),1)]),_:1},8,["label"]),o(p,{label:`Shodan ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.shodan_query),1)]),_:1},8,["label"]),o(p,{span:"2",label:`Censys ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.censys_query),1)]),_:1},8,["label"]),o(p,{label:`Greynoise ${l(t)("app.webui.searchquery")}:`},{default:a(()=>[n(s(i.value.data.greynoise_query),1)]),_:1},8,["label"])]),_:1})])]),_:1},8,["header"]),o(g,{style:{"font-size":"20px","font-weight":"bold","margin-top":"20px"},shadow:"always",header:"Poc"},{default:a(()=>[i.value.data.poc!=""?(d(),w("div",$e,[C.value?(d(),y($,{key:0,type:"primary",icon:l(F),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:e[2]||(e[2]=v=>M(i.value.data.poc))},null,8,["icon"])):E("",!0),o(D,{modelValue:i.value.data.poc,"onUpdate:modelValue":e[3]||(e[3]=v=>i.value.data.poc=v),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),y(f,{key:1,style:{height:"30vh"},description:l(t)("app.webui.empty")},null,8,["description"]))]),_:1}),o(g,{style:{"font-size":"20px","font-weight":"bold","margin-top":"20px"},shadow:"always",header:"Exp"},{default:a(()=>[i.value.data.exp!=""?(d(),w("div",Ee,[C.value?(d(),y($,{key:0,type:"primary",icon:l(F),circle:"",style:{position:"absolute",right:"10px",top:"10px","z-index":"1000"},onClick:e[4]||(e[4]=v=>M(i.value.data.exp))},null,8,["icon"])):E("",!0),o(D,{modelValue:i.value.data.exp,"onUpdate:modelValue":e[5]||(e[5]=v=>i.value.data.exp=v),type:"textarea",autosize:"",readonly:"","input-style":"background-color: #515151; color: #fff;"},null,8,["modelValue"])])):(d(),y(f,{key:1,style:{height:"30vh"},description:l(t)("app.webui.empty")},null,8,["description"]))]),_:1})]))}}}),Le=ce(qe,[["__scopeId","data-v-b44b4e2f"]]);export{Le as default};
